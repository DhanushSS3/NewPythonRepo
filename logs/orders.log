2025-07-22 03:19:55,994 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:19:56,916 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:19:56,916 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:19:56,916 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:19:56,917 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:19:56,956 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:19:56,956 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:19:57,716 - INFO - orders - Starting update_user_static_orders for user 4, user_type demo
2025-07-22 03:19:57,716 - INFO - orders - Using order model: DemoUserOrder
2025-07-22 03:19:57,721 - INFO - orders - Fetched 0 open orders for user 4
2025-07-22 03:19:57,723 - INFO - orders - Fetched 0 pending orders for user 4
2025-07-22 03:19:57,724 - INFO - orders - Updated static orders cache for user 4 with 0 open orders and 0 pending orders
2025-07-22 03:19:57,730 - INFO - orders - User 4: Updated balance/margin cache after static orders update - balance=100000.00000000, margin=0.0
2025-07-22 03:19:58,760 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:19:58,760 - INFO - orders - Using order model: UserOrder
2025-07-22 03:19:58,762 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:19:58,764 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:19:58,765 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:19:58,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:19:58,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:19:58,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:19:58,770 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:19:58,773 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:19:59,447 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:19:59,447 - INFO - orders - Using order model: UserOrder
2025-07-22 03:19:59,452 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:19:59,456 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:19:59,460 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:19:59,467 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:19:59,477 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:20:01,923 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:20:03,632 - ERROR - orders - Error recording rejected order: name 'RejectedOrder' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\orders.py", line 5331, in service_provider_rejected_order
    select(RejectedOrder)
           ^^^^^^^^^^^^^
NameError: name 'RejectedOrder' is not defined
2025-07-22 03:20:06,916 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:20:10,689 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:19,916 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:22,216 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:32,347 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:20:32,347 - INFO - orders - Using order model: UserOrder
2025-07-22 03:20:32,350 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:20:32,352 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:20:32,353 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:20:32,356 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:20:32,359 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:20:32,993 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:20:32,993 - INFO - orders - Using order model: UserOrder
2025-07-22 03:20:32,995 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:20:32,997 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:20:32,998 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:20:33,001 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:20:33,008 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:20:34,438 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:36,755 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:57,719 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:21:05,937 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:21:05,937 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:05,940 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:21:05,944 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:21:05,945 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:21:05,950 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:21:05,950 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:21:05,950 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:21:05,950 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:21:05,955 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:21:06,745 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:21:06,745 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:06,747 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:21:06,751 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:21:06,757 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:21:06,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:21:06,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:21:06,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:21:06,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:21:06,770 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:21:06,778 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:21:54,047 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:21:55,186 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:21:55,187 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:21:55,187 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:21:55,187 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:21:55,223 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:21:55,223 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:21:57,418 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:21:57,418 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:57,420 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:21:57,421 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:21:57,423 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:21:57,426 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:21:57,427 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:21:57,431 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:21:58,096 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:21:58,096 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:58,099 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:21:58,104 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:21:58,107 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:21:58,111 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:21:58,121 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:22:00,186 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:22:02,106 - INFO - orders - Order rejection recorded: order_id=1031-001, rejected_id=1182-007, reason=Under Maintenance
2025-07-22 03:22:05,187 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:22:14,126 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:16,471 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:30,292 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:32,369 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:22:32,369 - INFO - orders - Using order model: UserOrder
2025-07-22 03:22:32,372 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:22:32,375 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:22:32,376 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:22:32,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:22:32,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:22:32,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:22:32,381 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:22:32,385 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:22:33,092 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:22:33,092 - INFO - orders - Using order model: UserOrder
2025-07-22 03:22:33,098 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:22:33,101 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:22:33,104 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:22:33,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:22:33,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:22:33,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:22:33,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:22:33,110 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:22:33,114 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:22:44,321 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:46,558 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:06,157 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:23:06,158 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:06,162 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:23:06,167 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:23:06,169 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:23:06,175 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:23:06,181 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:23:07,172 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:23:07,172 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:07,175 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:23:07,180 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:23:07,184 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:23:07,190 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:23:07,191 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:23:07,193 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:23:07,193 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:23:07,194 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:23:07,202 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:23:10,529 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:12,974 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:17,597 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:22,218 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:24,559 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:26,796 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:29,164 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:31,503 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:41,094 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:23:41,094 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:41,100 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:23:41,103 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:23:41,106 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:23:41,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:23:41,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:23:41,110 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:23:41,114 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:23:41,880 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:23:41,880 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:41,884 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:23:41,886 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:23:41,888 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:23:41,891 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:23:41,895 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:23:52,195 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:28:33,448 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:28:34,749 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:28:34,749 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:28:34,749 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:28:34,749 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:28:34,845 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:28:34,845 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:28:35,625 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 03:28:35,625 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 03:28:35,625 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 03:28:35,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 03:28:35,626 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 03:28:35,806 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 03:28:36,891 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:28:36,891 - INFO - orders - Using order model: UserOrder
2025-07-22 03:28:36,893 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:28:36,895 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:28:36,896 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:28:36,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:28:36,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:28:36,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:28:36,900 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:28:36,904 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:28:37,822 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:28:37,822 - INFO - orders - Using order model: UserOrder
2025-07-22 03:28:37,826 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:28:37,830 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:28:37,832 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:28:37,836 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:28:37,836 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:28:37,837 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:28:37,837 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:28:37,837 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:28:37,841 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:28:39,749 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:28:44,762 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:28:49,070 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:28:58,393 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:29:11,003 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:29:11,003 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:11,006 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:29:11,010 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:29:11,012 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:29:11,015 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:29:11,016 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:29:11,023 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:29:11,926 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:29:11,926 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:11,930 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:29:11,936 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:29:11,938 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:29:11,943 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:29:11,951 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:29:37,589 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:29:44,670 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:29:45,206 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:29:45,206 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:45,207 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:29:45,209 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:29:45,209 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:29:45,211 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:29:45,213 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:29:46,021 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:29:46,022 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:46,025 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:29:46,032 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:29:46,036 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:29:46,043 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:29:46,047 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:30:07,654 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:10,121 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:19,876 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:30:19,877 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:19,883 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:30:19,886 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:30:19,889 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:30:19,895 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:30:19,896 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:30:19,900 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:30:20,753 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:30:20,755 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:20,758 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:30:20,760 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:30:20,762 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:30:20,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:30:20,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:30:20,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:30:20,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:30:20,769 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:30:20,774 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:30:26,476 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:32,640 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:30:32,649 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:30:37,612 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:30:37,617 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:30:40,561 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:49,782 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:51,012 - INFO - orders - Fetching rejected orders for user: 25
2025-07-22 03:30:51,015 - INFO - orders - Found 1 rejected orders for user 25
2025-07-22 03:30:51,934 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:30:51,935 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:30:51,935 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:30:51,935 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:30:51,935 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:30:54,580 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:30:54,581 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:54,588 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:30:54,593 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:30:54,595 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:30:54,600 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:30:54,602 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:30:54,602 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:30:54,602 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:30:54,607 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:30:55,351 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:30:55,351 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:55,353 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:30:55,357 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:30:55,359 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:30:55,363 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:30:55,368 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:31:03,802 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:06,111 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:08,822 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:20,086 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:24,693 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:26,920 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:28,627 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:31:28,628 - INFO - orders - Using order model: UserOrder
2025-07-22 03:31:28,632 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:31:28,636 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:31:28,639 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:31:28,645 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:31:28,647 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:31:28,647 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:31:28,655 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:31:29,482 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:31:29,482 - INFO - orders - Using order model: UserOrder
2025-07-22 03:31:29,486 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:31:29,490 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:31:29,492 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:31:29,496 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:31:29,501 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:40:10,976 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:40:12,272 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:40:12,272 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:40:12,272 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:40:12,272 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:40:12,307 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:40:12,308 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:40:13,206 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 03:40:13,207 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 03:40:13,207 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 03:40:13,207 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 03:40:13,207 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:40:13,247 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:40:13,321 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 03:40:13,330 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 03:40:14,373 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:40:14,373 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:14,375 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:40:14,377 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:40:14,379 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:40:14,382 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:40:14,382 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:40:14,382 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:40:14,383 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:40:14,386 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:40:15,082 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:40:15,082 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:15,087 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:40:15,091 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:40:15,094 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:40:15,099 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:40:15,100 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:40:15,100 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:40:15,100 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:40:15,100 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:40:15,108 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:40:17,272 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:40:19,367 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:21,637 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:22,278 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:40:26,326 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:26,568 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:40:26,599 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:40:35,601 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:48,235 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:40:48,235 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:48,238 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:40:48,240 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:40:48,241 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:40:48,244 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:40:48,245 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:40:48,250 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:40:49,047 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:40:49,047 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:49,052 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:40:49,056 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:40:49,057 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:40:49,062 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:40:49,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:40:49,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:40:49,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:40:49,063 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:40:49,068 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:40:50,393 - INFO - orders - Pending order placement request received - User ID: 30, Symbol: BTCUSD, Type: BUY_LIMIT, Quantity: 10
2025-07-22 03:40:50,534 - INFO - orders - Calculated contract_value for pending order: 10.00000000 (contract_size: 1.00000000 * quantity: 10)
2025-07-22 03:40:50,541 - INFO - orders - [DEBUG] User data from cache: {'id': 30, 'email': 'dhanush777ss@gmail.com', 'account_number': '5B0HV', 'group_name': 'Royal+', 'leverage': Decimal('100.00'), 'wallet_balance': Decimal('10000.00000000'), 'margin': Decimal('0E-8'), 'user_type': 'live', 'first_name': None, 'last_name': None, 'country': 'India', 'phone_number': Decimal('1777')}
2025-07-22 03:40:50,541 - INFO - orders - [DEBUG] Group name: Royal+
2025-07-22 03:40:50,545 - INFO - orders - User 30 is_barclays_live_user: True (user_type: live, sending_orders_normalized: barclays)
2025-07-22 03:40:50,549 - INFO - orders - [SYMBOL_INFO] Retrieved external symbol info for BTCUSD: contract_size=1.00000000, profit_currency=USD, digit=2.00000
2025-07-22 03:40:50,972 - INFO - orders - [MARGIN_CALC] Market data for BTCUSD: {'b': '118746.1000000000', 'o': '118736.1000000000'}
2025-07-22 03:40:50,973 - WARNING - orders - [MARGIN_CALC] Missing ask price for BTCUSD, using bid price with spread: bid=118746.1000000000, ask=118757.97461000000000
2025-07-22 03:40:50,973 - INFO - orders - [MARGIN_CALC] Using prices for BTCUSD: bid=118746.1000000000, ask=118757.97461000000000
2025-07-22 03:40:50,973 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: BTCUSD, Type: BUY_LIMIT, Qty: 10, Price: 118757.97461000000000, Margin: 237515.95, Commission: 5937.90
2025-07-22 03:40:50,974 - INFO - orders - Calculated initial margin: 237515.95, commission: 5937.90 for pending order 1194-001
2025-07-22 03:40:51,035 - INFO - orders - [DEBUG][pending_order] Prepared order_data_for_internal_processing: {'order_id': '1194-001', 'order_company_name': 'BTCUSD', 'order_type': 'BUY_LIMIT', 'order_quantity': Decimal('10'), 'order_price': Decimal('100'), 'user_type': 'live', 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '1195-005', 'takeprofit_id': '1196-006', 'order_user_id': 30, 'order_status': 'PENDING_PROCESSING', 'contract_value': Decimal('10.00000000'), 'margin': Decimal('237515.95'), 'commission': Decimal('5937.90'), 'open_time': None}
2025-07-22 03:40:51,035 - INFO - orders - [BARCLAYS] Setting initial order_status to PENDING_PROCESSING for Barclays user. Will be updated to PENDING after service provider confirmation.
2025-07-22 03:40:51,035 - INFO - orders - Placing PENDING order: BUY_LIMIT for user 30 at price 100
2025-07-22 03:40:51,036 - INFO - orders - [ENTER-CRUD] create_order called with: {'order_id': '1194-001', 'order_status': 'PENDING_PROCESSING', 'order_user_id': 30, 'order_company_name': 'BTCUSD', 'order_type': 'BUY_LIMIT', 'order_price': Decimal('100'), 'order_quantity': Decimal('10'), 'contract_value': Decimal('10.00000000'), 'margin': Decimal('237515.95'), 'commission': Decimal('5937.90'), 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '1195-005', 'takeprofit_id': '1196-006', 'close_id': None}
2025-07-22 03:40:51,126 - INFO - orders - Order 1194-001 verified in database on attempt 1 before adding to Redis.
2025-07-22 03:40:51,130 - INFO - orders - Skipping Redis storage for Barclays user pending order 1194-001
2025-07-22 03:40:51,168 - INFO - orders - [PERF] TOTAL place_order: 0.7783s
2025-07-22 03:40:51,271 - INFO - orders - Background balance/margin cache updated for user 30: balance=10000.00000000, margin=0.0
2025-07-22 03:40:51,292 - INFO - orders - [BARCLAYS] barclays_push called for user 30, is_barclays_live_user=True
2025-07-22 03:40:53,792 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:40:53,810 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:40:56,387 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:08,093 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:10,554 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:24,140 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:41:24,140 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:24,143 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:41:24,146 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:41:24,148 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:41:24,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:41:24,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:41:24,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:41:24,154 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:41:24,159 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:41:25,091 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:41:25,091 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:25,096 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:41:25,099 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:41:25,101 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:41:25,108 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:41:25,113 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:41:26,847 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:45,133 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:54,116 - INFO - orders - Service provider update request received: {"order_id":"1194-001","order_status":"PENDING","status":"PENDING"}
2025-07-22 03:41:54,136 - INFO - orders - Original order status: PENDING_PROCESSING
2025-07-22 03:41:54,137 - INFO - orders - Update fields: {'order_id': '1194-001', 'order_status': 'PENDING', 'status': 'PENDING'}
2025-07-22 03:41:54,137 - INFO - orders - Processing regular update for order 1194-001
2025-07-22 03:41:54,176 - ERROR - orders - Error updating user data cache after service provider update: get_user_by_id() missing 1 required positional argument: 'user_type'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\orders.py", line 4837, in service_provider_order_update
    db_user = await get_user_by_id(db, user_id)
                    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
TypeError: get_user_by_id() missing 1 required positional argument: 'user_type'
2025-07-22 03:41:54,183 - INFO - orders - Starting update_user_static_orders for user 30, user_type live
2025-07-22 03:41:54,183 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:54,187 - INFO - orders - Fetched 0 open orders for user 30
2025-07-22 03:41:54,191 - INFO - orders - Fetched 1 pending orders for user 30
2025-07-22 03:41:54,194 - INFO - orders - Updated static orders cache for user 30 with 0 open orders and 1 pending orders
2025-07-22 03:41:54,207 - INFO - orders - User 30: Updated balance/margin cache after static orders update - balance=10000.00000000, margin=0.0
2025-07-22 03:41:54,615 - INFO - orders - Starting update_user_static_orders for user 30, user_type live
2025-07-22 03:41:54,615 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:54,630 - INFO - orders - Fetched 0 open orders for user 30
2025-07-22 03:41:54,634 - INFO - orders - Fetched 0 pending orders for user 30
2025-07-22 03:41:54,636 - INFO - orders - Updated static orders cache for user 30 with 0 open orders and 0 pending orders
2025-07-22 03:41:54,643 - INFO - orders - User 30: Updated balance/margin cache after static orders update - balance=10000.00000000, margin=0.0
2025-07-22 03:41:57,253 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:41:57,258 - INFO - orders - Found 1 rejected orders for user 30
2025-07-22 03:41:58,566 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:41:58,567 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:58,571 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:41:58,576 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:41:58,580 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:41:58,588 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:41:58,597 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:41:59,276 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:41:59,276 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:59,281 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:41:59,287 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:41:59,289 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:41:59,294 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:41:59,294 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:41:59,295 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:41:59,295 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:41:59,295 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:41:59,299 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:42:01,501 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:42:08,388 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:42:24,637 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:42:32,881 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:42:32,881 - INFO - orders - Using order model: UserOrder
2025-07-22 03:42:32,886 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:42:32,890 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:42:32,893 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:42:32,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:42:32,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:42:32,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:42:32,901 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:42:32,902 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:42:32,902 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:42:32,902 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:42:32,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:42:32,906 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:42:32,916 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:42:33,995 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:42:33,995 - INFO - orders - Using order model: UserOrder
2025-07-22 03:42:34,000 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:42:34,005 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:42:34,007 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:42:34,010 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:42:34,011 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:42:34,011 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:42:34,011 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:42:34,011 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:42:34,014 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
