2025-07-21 23:12:11,335 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-21 23:12:12,593 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-21 23:12:12,594 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-21 23:12:12,594 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-21 23:12:12,594 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-21 23:12:12,640 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-21 23:12:12,641 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-21 23:12:13,450 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-21 23:12:13,451 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-21 23:12:13,451 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-21 23:12:13,451 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-21 23:12:13,451 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-21 23:12:13,519 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-21 23:12:13,520 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-21 23:12:13,520 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-21 23:12:13,520 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-21 23:12:13,520 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-21 23:12:13,520 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-21 23:12:13,520 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-21 23:12:13,520 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-21 23:12:13,520 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-21 23:12:13,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-21 23:12:13,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-21 23:12:13,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-21 23:12:13,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-21 23:12:13,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-21 23:12:13,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-21 23:12:13,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-21 23:12:13,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-21 23:12:13,626 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-21 23:12:15,469 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-21 23:12:15,469 - INFO - orders - Using order model: UserOrder
2025-07-21 23:12:15,472 - INFO - orders - Fetched 1 open orders for user 25
2025-07-21 23:12:15,475 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-21 23:12:15,477 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-21 23:12:15,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-21 23:12:15,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-21 23:12:15,482 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-21 23:12:15,482 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-21 23:12:15,482 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-21 23:12:15,488 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-21 23:12:17,939 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-21 23:12:20,277 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:12:22,595 - INFO - orders - Starting the users with orders cache updater task.
2025-07-21 23:12:22,606 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:15:00,214 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-21 23:15:01,447 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-21 23:15:01,447 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-21 23:15:01,447 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-21 23:15:01,447 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-21 23:15:01,501 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-21 23:15:01,501 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-21 23:15:04,111 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-21 23:15:04,112 - INFO - orders - Using order model: UserOrder
2025-07-21 23:15:04,114 - INFO - orders - Fetched 1 open orders for user 25
2025-07-21 23:15:04,115 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-21 23:15:04,117 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-21 23:15:04,120 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-21 23:15:04,121 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-21 23:15:04,121 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-21 23:15:04,121 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-21 23:15:04,121 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-21 23:15:04,124 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-21 23:15:06,447 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-21 23:15:07,357 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:15:11,457 - INFO - orders - Starting the users with orders cache updater task.
2025-07-21 23:15:12,201 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:15:14,533 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:15:16,894 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:16:43,492 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-21 23:16:44,560 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-21 23:16:44,560 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-21 23:16:44,561 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-21 23:16:44,561 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-21 23:16:44,598 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-21 23:16:44,598 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-21 23:16:48,195 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-21 23:16:48,195 - INFO - orders - Using order model: UserOrder
2025-07-21 23:16:48,199 - INFO - orders - Fetched 1 open orders for user 25
2025-07-21 23:16:48,204 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-21 23:16:48,207 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-21 23:16:48,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-21 23:16:48,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-21 23:16:48,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-21 23:16:48,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-21 23:16:48,212 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-21 23:16:48,223 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-21 23:16:49,561 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-21 23:16:54,092 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:16:54,572 - INFO - orders - Starting the users with orders cache updater task.
2025-07-21 23:17:10,199 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:17:19,421 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:17:22,094 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-21 23:17:22,094 - INFO - orders - Using order model: UserOrder
2025-07-21 23:17:22,096 - INFO - orders - Fetched 1 open orders for user 25
2025-07-21 23:17:22,099 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-21 23:17:22,101 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-21 23:17:22,105 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-21 23:17:22,105 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-21 23:17:22,105 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-21 23:17:22,106 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-21 23:17:22,106 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-21 23:17:22,115 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-21 23:17:32,540 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-21 23:17:33,492 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-21 23:17:33,492 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-21 23:17:33,492 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-21 23:17:33,492 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-21 23:17:33,523 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-21 23:17:33,523 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-21 23:17:34,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-21 23:17:34,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-21 23:17:34,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-21 23:17:34,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-21 23:17:34,249 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-21 23:17:34,296 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-21 23:17:34,296 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-21 23:17:34,296 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-21 23:17:34,296 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-21 23:17:34,296 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-21 23:17:34,296 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-21 23:17:34,296 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-21 23:17:34,296 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-21 23:17:34,296 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-21 23:17:34,384 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-21 23:17:34,384 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-21 23:17:34,384 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-21 23:17:34,384 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-21 23:17:34,384 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-21 23:17:34,384 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-21 23:17:34,384 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-21 23:17:34,384 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-21 23:17:34,384 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-21 23:17:36,295 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-21 23:17:36,295 - INFO - orders - Using order model: UserOrder
2025-07-21 23:17:36,299 - INFO - orders - Fetched 1 open orders for user 25
2025-07-21 23:17:36,302 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-21 23:17:36,304 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-21 23:17:36,309 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-21 23:17:36,310 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-21 23:17:36,310 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-21 23:17:36,310 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-21 23:17:36,310 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-21 23:17:36,316 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-21 23:17:38,753 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-21 23:17:40,670 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:17:43,019 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-21 23:17:43,502 - INFO - orders - Starting the users with orders cache updater task.
2025-07-21 23:17:45,133 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
