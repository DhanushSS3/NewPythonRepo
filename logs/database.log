2025-07-15 23:42:15,164 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 382, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 435, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-15 23:42:15,172 - INFO - database - Session rolled back due to error
2025-07-15 23:42:15,179 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 382, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 435, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-15 23:42:15,185 - INFO - database - Session rolled back due to error
2025-07-16 00:10:02,110 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 00:12:02,108 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 00:14:02,110 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 00:16:02,116 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 00:18:02,111 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 00:20:02,108 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 00:21:30,902 - ERROR - database - Error in database session: get_user_by_id() missing 1 required positional argument: 'user_type'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 557, in delete_user_by_id
    db_user = await crud_user.get_user_by_id(db, user_id=user_id)
                    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: get_user_by_id() missing 1 required positional argument: 'user_type'
2025-07-16 00:21:30,910 - INFO - database - Session rolled back due to error
2025-07-16 00:24:00,913 - ERROR - database - Error in database session: get_user_by_id() missing 1 required positional argument: 'user_type'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 490, in update_user_by_id
    db_user = await crud_user.get_user_by_id(db, user_id=user_id)
                    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: get_user_by_id() missing 1 required positional argument: 'user_type'
2025-07-16 00:24:00,925 - INFO - database - Session rolled back due to error
2025-07-16 00:24:30,528 - ERROR - database - Error in database session: 400: Email already exists for this user type.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 503, in update_user_by_id
    raise HTTPException(status_code=400, detail="Email already exists for this user type.")
fastapi.exceptions.HTTPException: 400: Email already exists for this user type.
2025-07-16 00:24:30,531 - INFO - database - Session rolled back due to error
2025-07-16 00:24:59,000 - ERROR - database - Error in database session: 400: Phone number already exists for this user type.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 507, in update_user_by_id
    raise HTTPException(status_code=400, detail="Phone number already exists for this user type.")
fastapi.exceptions.HTTPException: 400: Phone number already exists for this user type.
2025-07-16 00:24:59,004 - INFO - database - Session rolled back due to error
2025-07-16 00:26:16,895 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 9, 'checked_out': 1, 'overflow': 0}
2025-07-16 01:32:34,511 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 8, 'checked_out': 1, 'overflow': -1}
2025-07-16 01:34:34,505 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 8, 'checked_out': 1, 'overflow': -1}
2025-07-16 01:36:34,502 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 8, 'checked_out': 1, 'overflow': -1}
2025-07-16 01:38:34,505 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 8, 'checked_out': 1, 'overflow': -1}
2025-07-16 01:40:34,502 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 01:42:34,508 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 8, 'checked_out': 1, 'overflow': -1}
2025-07-16 01:44:34,506 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 8, 'checked_out': 1, 'overflow': -1}
2025-07-16 01:49:19,593 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 382, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 435, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-16 01:49:19,605 - INFO - database - Session rolled back due to error
2025-07-16 01:49:19,615 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 382, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 435, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-16 01:49:19,618 - INFO - database - Session rolled back due to error
2025-07-16 01:50:34,504 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 8, 'checked_out': 1, 'overflow': -1}
2025-07-16 01:52:34,514 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 8, 'checked_out': 1, 'overflow': -1}
2025-07-16 02:11:26,611 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 9, 'checked_out': 1, 'overflow': 0}
2025-07-16 02:13:26,603 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 9, 'checked_out': 1, 'overflow': 0}
2025-07-16 02:15:26,596 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 9, 'checked_out': 1, 'overflow': 0}
2025-07-16 02:17:26,608 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 9, 'checked_out': 1, 'overflow': 0}
2025-07-16 02:19:26,597 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 8, 'checked_out': 2, 'overflow': 0}
2025-07-16 02:52:24,992 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 02:54:24,986 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 02:56:24,984 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 02:58:24,993 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 03:00:24,982 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 03:02:24,989 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 03:04:24,989 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 03:06:24,991 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 03:08:24,981 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-16 03:36:36,852 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 9, 'checked_out': 1, 'overflow': 0}
2025-07-16 03:38:36,851 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 9, 'checked_out': 1, 'overflow': 0}
2025-07-16 03:42:08,778 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 9, 'checked_out': 1, 'overflow': 0}
2025-07-16 04:27:18,426 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 288, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 337, in get_current_user
    raise credentials_exception
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-16 04:27:18,438 - INFO - database - Session rolled back due to error
2025-07-16 04:27:22,104 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 04:27:22,104 - INFO - database - Session rolled back due to error
2025-07-16 04:27:22,106 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 04:27:22,107 - INFO - database - Session rolled back due to error
2025-07-16 05:06:40,602 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-16 05:08:40,606 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-16 05:10:40,615 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-16 05:12:40,609 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 5, 'checked_out': 2, 'overflow': -3}
2025-07-16 05:14:40,607 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 5, 'checked_out': 2, 'overflow': -3}
2025-07-16 05:16:40,606 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 5, 'checked_out': 2, 'overflow': -3}
2025-07-16 05:18:40,606 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 2, 'overflow': -2}
2025-07-16 05:20:40,606 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 2, 'overflow': -2}
2025-07-16 05:22:40,611 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 2, 'overflow': -2}
2025-07-16 05:24:40,606 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 2, 'overflow': -2}
2025-07-16 05:26:40,614 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 2, 'overflow': -2}
2025-07-16 05:28:40,618 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 2, 'overflow': -2}
2025-07-16 05:33:03,460 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 05:33:10,800 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 05:33:10,805 - INFO - database - Session rolled back due to error
2025-07-16 05:33:10,807 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 05:33:10,808 - INFO - database - Session rolled back due to error
2025-07-16 05:35:03,459 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 05:37:03,455 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 05:38:17,514 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 05:38:17,516 - INFO - database - Session rolled back due to error
2025-07-16 05:38:17,518 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 05:38:17,520 - INFO - database - Session rolled back due to error
2025-07-16 05:39:03,451 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 05:39:17,471 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 05:39:17,473 - INFO - database - Session rolled back due to error
2025-07-16 05:39:17,474 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 05:39:17,475 - INFO - database - Session rolled back due to error
2025-07-16 05:40:50,058 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 05:40:50,064 - INFO - database - Session rolled back due to error
2025-07-16 05:40:50,079 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 05:40:50,080 - INFO - database - Session rolled back due to error
2025-07-16 05:40:51,677 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 288, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 337, in get_current_user
    raise credentials_exception
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-16 05:40:51,687 - INFO - database - Session rolled back due to error
2025-07-16 05:41:32,751 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 2, 'checked_out': 0, 'overflow': -8}
2025-07-16 05:44:37,612 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 5, 'checked_out': 2, 'overflow': -3}
2025-07-16 05:45:22,512 - ERROR - database - Error in database session: 404: No withdraw or deposit wallet records found for this user.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\wallets.py", line 51, in get_my_wallets
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 404: No withdraw or deposit wallet records found for this user.
2025-07-16 05:45:22,522 - INFO - database - Session rolled back due to error
2025-07-16 05:46:37,606 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 2, 'overflow': -2}
2025-07-16 21:21:52,893 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 21:26:22,539 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-16 21:29:06,161 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 0, 'checked_out': 0, 'overflow': -10}
2025-07-16 21:33:09,233 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 5, 'checked_out': 1, 'overflow': -4}
2025-07-16 21:50:19,170 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 5, 'checked_out': 1, 'overflow': -4}
2025-07-16 21:52:19,161 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 5, 'checked_out': 1, 'overflow': -4}
2025-07-16 21:54:19,172 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 21:56:19,171 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 21:58:19,162 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 22:00:19,159 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 22:52:34,058 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 5, 'checked_out': 1, 'overflow': -4}
2025-07-16 22:54:34,059 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-16 22:56:34,063 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 22:58:34,060 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 23:00:34,052 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 2, 'overflow': -2}
2025-07-16 23:02:34,061 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 23:04:34,057 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 23:06:34,067 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 23:08:34,058 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-16 23:14:55,424 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 23:14:55,437 - INFO - database - Session rolled back due to error
2025-07-16 23:14:55,453 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 382, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 435, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-16 23:14:55,458 - INFO - database - Session rolled back due to error
2025-07-16 23:14:55,484 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 382, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 435, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-16 23:14:55,496 - INFO - database - Session rolled back due to error
2025-07-16 23:14:55,503 - ERROR - database - Error in database session: 500: An error occurred while refreshing token.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 312, in refresh_access_token
     raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Invalid or expired refresh token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 362, in refresh_access_token
    raise HTTPException(
    ...<2 lines>...
    )
fastapi.exceptions.HTTPException: 500: An error occurred while refreshing token.
2025-07-16 23:14:55,510 - INFO - database - Session rolled back due to error
2025-07-16 23:15:49,445 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-16 23:17:49,435 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-16 23:19:49,433 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-16 23:21:08,149 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 181, in _load
    header_segment, claims_segment = signing_input.split(b".", 1)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 74, in verify
    header, payload, signing_input, signature = _load(token)
                                                ~~~~~^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 184, in _load
    raise JWSError("Not enough segments")
jose.exceptions.JWSError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 460, in get_user_from_service_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 468, in get_user_from_service_token
    raise credentials_exception
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-16 23:21:08,162 - INFO - database - Session rolled back due to error
2025-07-16 23:22:28,578 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 5, 'checked_out': 0, 'overflow': -5}
2025-07-16 23:25:27,205 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-16 23:49:21,922 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 0, 'checked_out': 7, 'overflow': -3}
2025-07-17 02:23:40,832 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:23:40,844 - INFO - database - Session rolled back due to error
2025-07-17 02:23:48,815 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:23:48,817 - INFO - database - Session rolled back due to error
2025-07-17 02:23:56,807 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:23:56,809 - INFO - database - Session rolled back due to error
2025-07-17 02:24:04,824 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:24:04,826 - INFO - database - Session rolled back due to error
2025-07-17 02:24:12,814 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:24:12,817 - INFO - database - Session rolled back due to error
2025-07-17 02:24:20,817 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:24:20,819 - INFO - database - Session rolled back due to error
2025-07-17 02:24:28,929 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:24:28,933 - INFO - database - Session rolled back due to error
2025-07-17 02:24:36,805 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:24:36,810 - INFO - database - Session rolled back due to error
2025-07-17 02:24:44,810 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:24:44,814 - INFO - database - Session rolled back due to error
2025-07-17 02:24:52,812 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:24:52,815 - INFO - database - Session rolled back due to error
2025-07-17 02:25:00,804 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:25:00,807 - INFO - database - Session rolled back due to error
2025-07-17 02:25:08,934 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:25:08,937 - INFO - database - Session rolled back due to error
2025-07-17 02:25:16,803 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:25:16,806 - INFO - database - Session rolled back due to error
2025-07-17 02:25:24,844 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:25:24,847 - INFO - database - Session rolled back due to error
2025-07-17 02:25:32,819 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:25:32,822 - INFO - database - Session rolled back due to error
2025-07-17 02:25:32,933 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 0, 'checked_out': 0, 'overflow': -10}
2025-07-17 02:25:40,827 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:25:40,829 - INFO - database - Session rolled back due to error
2025-07-17 02:25:48,834 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:25:48,845 - INFO - database - Session rolled back due to error
2025-07-17 02:25:56,874 - ERROR - database - Error in database session: 503: Redis unavailable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 898, in websocket_endpoint
    redis_client = await get_redis_client()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\dependencies\redis_client.py", line 19, in get_redis_client
    raise HTTPException(status_code=status.HTTP_503_SERVICE_UNAVAILABLE, detail="Redis unavailable")
fastapi.exceptions.HTTPException: 503: Redis unavailable
2025-07-17 02:25:56,876 - INFO - database - Session rolled back due to error
2025-07-17 02:35:40,280 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-17 02:37:40,283 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-17 02:39:40,286 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-17 02:41:40,280 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-17 02:43:40,279 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-17 02:45:40,280 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 1, 'overflow': -2}
2025-07-17 03:04:51,133 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-17 03:08:15,248 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-17 03:13:53,112 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-17 03:16:57,137 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 0, 'overflow': -3}
2025-07-17 03:39:26,029 - ERROR - database - Error in database session: 500: Error in service_provider_order_execution: 400: Invalid status transition from OPEN to OPEN
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\orders.py", line 3910, in service_provider_order_execution
    raise HTTPException(status_code=400, detail=error_msg)
fastapi.exceptions.HTTPException: 400: Invalid status transition from OPEN to OPEN

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\orders.py", line 3915, in service_provider_order_execution
    raise HTTPException(status_code=500, detail=error_msg)
fastapi.exceptions.HTTPException: 500: Error in service_provider_order_execution: 400: Invalid status transition from OPEN to OPEN
2025-07-17 03:39:26,035 - INFO - database - Session rolled back due to error
2025-07-17 03:39:54,435 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 2, 'overflow': -1}
2025-07-17 04:08:43,881 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 444, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 497, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-17 04:08:43,903 - INFO - database - Session rolled back due to error
2025-07-17 04:08:43,932 - ERROR - database - Error in database session: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 94, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 444, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 99, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 497, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-07-17 04:08:43,938 - INFO - database - Session rolled back due to error
2025-07-17 04:10:39,197 - ERROR - database - Error in database session: 401: Incorrect password
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 70, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 246, in login_with_user_type
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Incorrect password
2025-07-17 04:10:39,206 - INFO - database - Session rolled back due to error
2025-07-17 04:11:41,756 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-17 04:21:14,743 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-17 04:23:14,736 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-17 04:25:14,744 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 0, 'overflow': -3}
2025-07-17 04:27:14,731 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-17 04:30:45,909 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-17 04:32:45,906 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-17 04:34:45,904 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-17 04:36:45,914 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 1, 'overflow': -3}
2025-07-17 04:43:40,600 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-17 04:45:40,604 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 0, 'overflow': -3}
2025-07-17 04:49:08,111 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 7, 'checked_out': 0, 'overflow': -3}
2025-07-17 04:55:56,588 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-17 05:00:15,928 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
2025-07-17 05:02:15,932 - INFO - database - Connection pool status: {'pool_size': 10, 'checked_in': 6, 'checked_out': 0, 'overflow': -4}
