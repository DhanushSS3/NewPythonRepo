2025-07-22 03:19:55,994 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:19:56,916 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:19:56,916 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:19:56,916 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:19:56,917 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:19:56,956 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:19:56,956 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:19:57,716 - INFO - orders - Starting update_user_static_orders for user 4, user_type demo
2025-07-22 03:19:57,716 - INFO - orders - Using order model: DemoUserOrder
2025-07-22 03:19:57,721 - INFO - orders - Fetched 0 open orders for user 4
2025-07-22 03:19:57,723 - INFO - orders - Fetched 0 pending orders for user 4
2025-07-22 03:19:57,724 - INFO - orders - Updated static orders cache for user 4 with 0 open orders and 0 pending orders
2025-07-22 03:19:57,730 - INFO - orders - User 4: Updated balance/margin cache after static orders update - balance=100000.00000000, margin=0.0
2025-07-22 03:19:58,760 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:19:58,760 - INFO - orders - Using order model: UserOrder
2025-07-22 03:19:58,762 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:19:58,764 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:19:58,765 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:19:58,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:19:58,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:19:58,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:19:58,770 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:19:58,773 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:19:59,447 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:19:59,447 - INFO - orders - Using order model: UserOrder
2025-07-22 03:19:59,452 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:19:59,456 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:19:59,460 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:19:59,467 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:19:59,477 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:20:01,923 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:20:03,632 - ERROR - orders - Error recording rejected order: name 'RejectedOrder' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\orders.py", line 5331, in service_provider_rejected_order
    select(RejectedOrder)
           ^^^^^^^^^^^^^
NameError: name 'RejectedOrder' is not defined
2025-07-22 03:20:06,916 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:20:10,689 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:19,916 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:22,216 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:32,347 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:20:32,347 - INFO - orders - Using order model: UserOrder
2025-07-22 03:20:32,350 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:20:32,352 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:20:32,353 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:20:32,356 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:20:32,359 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:20:32,993 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:20:32,993 - INFO - orders - Using order model: UserOrder
2025-07-22 03:20:32,995 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:20:32,997 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:20:32,998 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:20:33,001 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:20:33,008 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:20:34,438 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:36,755 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:57,719 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:21:05,937 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:21:05,937 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:05,940 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:21:05,944 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:21:05,945 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:21:05,950 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:21:05,950 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:21:05,950 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:21:05,950 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:21:05,955 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:21:06,745 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:21:06,745 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:06,747 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:21:06,751 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:21:06,757 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:21:06,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:21:06,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:21:06,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:21:06,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:21:06,770 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:21:06,778 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:21:54,047 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:21:55,186 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:21:55,187 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:21:55,187 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:21:55,187 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:21:55,223 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:21:55,223 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:21:57,418 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:21:57,418 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:57,420 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:21:57,421 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:21:57,423 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:21:57,426 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:21:57,427 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:21:57,431 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:21:58,096 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:21:58,096 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:58,099 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:21:58,104 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:21:58,107 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:21:58,111 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:21:58,121 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:22:00,186 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:22:02,106 - INFO - orders - Order rejection recorded: order_id=1031-001, rejected_id=1182-007, reason=Under Maintenance
2025-07-22 03:22:05,187 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:22:14,126 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:16,471 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:30,292 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:32,369 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:22:32,369 - INFO - orders - Using order model: UserOrder
2025-07-22 03:22:32,372 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:22:32,375 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:22:32,376 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:22:32,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:22:32,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:22:32,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:22:32,381 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:22:32,385 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:22:33,092 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:22:33,092 - INFO - orders - Using order model: UserOrder
2025-07-22 03:22:33,098 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:22:33,101 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:22:33,104 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:22:33,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:22:33,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:22:33,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:22:33,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:22:33,110 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:22:33,114 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:22:44,321 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:46,558 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:06,157 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:23:06,158 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:06,162 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:23:06,167 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:23:06,169 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:23:06,175 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:23:06,181 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:23:07,172 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:23:07,172 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:07,175 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:23:07,180 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:23:07,184 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:23:07,190 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:23:07,191 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:23:07,193 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:23:07,193 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:23:07,194 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:23:07,202 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:23:10,529 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:12,974 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:17,597 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:22,218 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:24,559 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:26,796 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:29,164 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:31,503 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:41,094 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:23:41,094 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:41,100 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:23:41,103 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:23:41,106 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:23:41,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:23:41,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:23:41,110 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:23:41,114 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:23:41,880 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:23:41,880 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:41,884 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:23:41,886 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:23:41,888 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:23:41,891 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:23:41,895 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:23:52,195 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:28:33,448 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:28:34,749 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:28:34,749 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:28:34,749 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:28:34,749 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:28:34,845 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:28:34,845 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:28:35,625 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 03:28:35,625 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 03:28:35,625 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 03:28:35,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 03:28:35,626 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 03:28:35,806 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 03:28:36,891 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:28:36,891 - INFO - orders - Using order model: UserOrder
2025-07-22 03:28:36,893 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:28:36,895 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:28:36,896 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:28:36,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:28:36,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:28:36,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:28:36,900 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:28:36,904 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:28:37,822 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:28:37,822 - INFO - orders - Using order model: UserOrder
2025-07-22 03:28:37,826 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:28:37,830 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:28:37,832 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:28:37,836 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:28:37,836 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:28:37,837 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:28:37,837 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:28:37,837 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:28:37,841 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:28:39,749 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:28:44,762 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:28:49,070 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:28:58,393 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:29:11,003 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:29:11,003 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:11,006 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:29:11,010 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:29:11,012 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:29:11,015 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:29:11,016 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:29:11,023 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:29:11,926 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:29:11,926 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:11,930 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:29:11,936 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:29:11,938 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:29:11,943 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:29:11,951 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:29:37,589 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:29:44,670 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:29:45,206 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:29:45,206 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:45,207 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:29:45,209 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:29:45,209 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:29:45,211 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:29:45,213 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:29:46,021 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:29:46,022 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:46,025 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:29:46,032 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:29:46,036 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:29:46,043 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:29:46,047 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:30:07,654 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:10,121 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:19,876 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:30:19,877 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:19,883 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:30:19,886 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:30:19,889 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:30:19,895 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:30:19,896 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:30:19,900 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:30:20,753 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:30:20,755 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:20,758 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:30:20,760 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:30:20,762 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:30:20,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:30:20,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:30:20,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:30:20,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:30:20,769 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:30:20,774 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:30:26,476 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:32,640 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:30:32,649 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:30:37,612 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:30:37,617 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:30:40,561 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:49,782 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:51,012 - INFO - orders - Fetching rejected orders for user: 25
2025-07-22 03:30:51,015 - INFO - orders - Found 1 rejected orders for user 25
2025-07-22 03:30:51,934 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:30:51,935 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:30:51,935 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:30:51,935 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:30:51,935 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:30:54,580 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:30:54,581 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:54,588 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:30:54,593 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:30:54,595 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:30:54,600 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:30:54,602 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:30:54,602 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:30:54,602 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:30:54,607 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:30:55,351 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:30:55,351 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:55,353 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:30:55,357 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:30:55,359 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:30:55,363 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:30:55,368 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:31:03,802 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:06,111 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:08,822 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:20,086 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:24,693 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:26,920 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:28,627 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:31:28,628 - INFO - orders - Using order model: UserOrder
2025-07-22 03:31:28,632 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:31:28,636 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:31:28,639 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:31:28,645 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:31:28,647 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:31:28,647 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:31:28,655 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:31:29,482 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:31:29,482 - INFO - orders - Using order model: UserOrder
2025-07-22 03:31:29,486 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:31:29,490 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:31:29,492 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:31:29,496 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:31:29,501 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:40:10,976 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:40:12,272 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:40:12,272 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:40:12,272 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:40:12,272 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:40:12,307 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:40:12,308 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:40:13,206 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 03:40:13,207 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 03:40:13,207 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 03:40:13,207 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 03:40:13,207 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:40:13,247 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:40:13,321 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 03:40:13,330 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 03:40:14,373 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:40:14,373 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:14,375 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:40:14,377 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:40:14,379 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:40:14,382 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:40:14,382 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:40:14,382 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:40:14,383 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:40:14,386 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:40:15,082 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:40:15,082 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:15,087 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:40:15,091 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:40:15,094 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:40:15,099 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:40:15,100 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:40:15,100 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:40:15,100 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:40:15,100 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:40:15,108 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:40:17,272 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:40:19,367 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:21,637 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:22,278 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:40:26,326 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:26,568 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:40:26,599 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:40:35,601 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:48,235 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:40:48,235 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:48,238 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:40:48,240 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:40:48,241 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:40:48,244 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:40:48,245 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:40:48,250 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:40:49,047 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:40:49,047 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:49,052 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:40:49,056 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:40:49,057 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:40:49,062 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:40:49,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:40:49,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:40:49,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:40:49,063 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:40:49,068 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:40:50,393 - INFO - orders - Pending order placement request received - User ID: 30, Symbol: BTCUSD, Type: BUY_LIMIT, Quantity: 10
2025-07-22 03:40:50,534 - INFO - orders - Calculated contract_value for pending order: 10.00000000 (contract_size: 1.00000000 * quantity: 10)
2025-07-22 03:40:50,541 - INFO - orders - [DEBUG] User data from cache: {'id': 30, 'email': 'dhanush777ss@gmail.com', 'account_number': '5B0HV', 'group_name': 'Royal+', 'leverage': Decimal('100.00'), 'wallet_balance': Decimal('10000.00000000'), 'margin': Decimal('0E-8'), 'user_type': 'live', 'first_name': None, 'last_name': None, 'country': 'India', 'phone_number': Decimal('1777')}
2025-07-22 03:40:50,541 - INFO - orders - [DEBUG] Group name: Royal+
2025-07-22 03:40:50,545 - INFO - orders - User 30 is_barclays_live_user: True (user_type: live, sending_orders_normalized: barclays)
2025-07-22 03:40:50,549 - INFO - orders - [SYMBOL_INFO] Retrieved external symbol info for BTCUSD: contract_size=1.00000000, profit_currency=USD, digit=2.00000
2025-07-22 03:40:50,972 - INFO - orders - [MARGIN_CALC] Market data for BTCUSD: {'b': '118746.1000000000', 'o': '118736.1000000000'}
2025-07-22 03:40:50,973 - WARNING - orders - [MARGIN_CALC] Missing ask price for BTCUSD, using bid price with spread: bid=118746.1000000000, ask=118757.97461000000000
2025-07-22 03:40:50,973 - INFO - orders - [MARGIN_CALC] Using prices for BTCUSD: bid=118746.1000000000, ask=118757.97461000000000
2025-07-22 03:40:50,973 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: BTCUSD, Type: BUY_LIMIT, Qty: 10, Price: 118757.97461000000000, Margin: 237515.95, Commission: 5937.90
2025-07-22 03:40:50,974 - INFO - orders - Calculated initial margin: 237515.95, commission: 5937.90 for pending order 1194-001
2025-07-22 03:40:51,035 - INFO - orders - [DEBUG][pending_order] Prepared order_data_for_internal_processing: {'order_id': '1194-001', 'order_company_name': 'BTCUSD', 'order_type': 'BUY_LIMIT', 'order_quantity': Decimal('10'), 'order_price': Decimal('100'), 'user_type': 'live', 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '1195-005', 'takeprofit_id': '1196-006', 'order_user_id': 30, 'order_status': 'PENDING_PROCESSING', 'contract_value': Decimal('10.00000000'), 'margin': Decimal('237515.95'), 'commission': Decimal('5937.90'), 'open_time': None}
2025-07-22 03:40:51,035 - INFO - orders - [BARCLAYS] Setting initial order_status to PENDING_PROCESSING for Barclays user. Will be updated to PENDING after service provider confirmation.
2025-07-22 03:40:51,035 - INFO - orders - Placing PENDING order: BUY_LIMIT for user 30 at price 100
2025-07-22 03:40:51,036 - INFO - orders - [ENTER-CRUD] create_order called with: {'order_id': '1194-001', 'order_status': 'PENDING_PROCESSING', 'order_user_id': 30, 'order_company_name': 'BTCUSD', 'order_type': 'BUY_LIMIT', 'order_price': Decimal('100'), 'order_quantity': Decimal('10'), 'contract_value': Decimal('10.00000000'), 'margin': Decimal('237515.95'), 'commission': Decimal('5937.90'), 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '1195-005', 'takeprofit_id': '1196-006', 'close_id': None}
2025-07-22 03:40:51,126 - INFO - orders - Order 1194-001 verified in database on attempt 1 before adding to Redis.
2025-07-22 03:40:51,130 - INFO - orders - Skipping Redis storage for Barclays user pending order 1194-001
2025-07-22 03:40:51,168 - INFO - orders - [PERF] TOTAL place_order: 0.7783s
2025-07-22 03:40:51,271 - INFO - orders - Background balance/margin cache updated for user 30: balance=10000.00000000, margin=0.0
2025-07-22 03:40:51,292 - INFO - orders - [BARCLAYS] barclays_push called for user 30, is_barclays_live_user=True
2025-07-22 03:40:53,792 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:40:53,810 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:40:56,387 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:08,093 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:10,554 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:24,140 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:41:24,140 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:24,143 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:41:24,146 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:41:24,148 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:41:24,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:41:24,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:41:24,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:41:24,154 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:41:24,159 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:41:25,091 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:41:25,091 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:25,096 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:41:25,099 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:41:25,101 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:41:25,108 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:41:25,113 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:41:26,847 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:45,133 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:54,116 - INFO - orders - Service provider update request received: {"order_id":"1194-001","order_status":"PENDING","status":"PENDING"}
2025-07-22 03:41:54,136 - INFO - orders - Original order status: PENDING_PROCESSING
2025-07-22 03:41:54,137 - INFO - orders - Update fields: {'order_id': '1194-001', 'order_status': 'PENDING', 'status': 'PENDING'}
2025-07-22 03:41:54,137 - INFO - orders - Processing regular update for order 1194-001
2025-07-22 03:41:54,176 - ERROR - orders - Error updating user data cache after service provider update: get_user_by_id() missing 1 required positional argument: 'user_type'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\orders.py", line 4837, in service_provider_order_update
    db_user = await get_user_by_id(db, user_id)
                    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
TypeError: get_user_by_id() missing 1 required positional argument: 'user_type'
2025-07-22 03:41:54,183 - INFO - orders - Starting update_user_static_orders for user 30, user_type live
2025-07-22 03:41:54,183 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:54,187 - INFO - orders - Fetched 0 open orders for user 30
2025-07-22 03:41:54,191 - INFO - orders - Fetched 1 pending orders for user 30
2025-07-22 03:41:54,194 - INFO - orders - Updated static orders cache for user 30 with 0 open orders and 1 pending orders
2025-07-22 03:41:54,207 - INFO - orders - User 30: Updated balance/margin cache after static orders update - balance=10000.00000000, margin=0.0
2025-07-22 03:41:54,615 - INFO - orders - Starting update_user_static_orders for user 30, user_type live
2025-07-22 03:41:54,615 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:54,630 - INFO - orders - Fetched 0 open orders for user 30
2025-07-22 03:41:54,634 - INFO - orders - Fetched 0 pending orders for user 30
2025-07-22 03:41:54,636 - INFO - orders - Updated static orders cache for user 30 with 0 open orders and 0 pending orders
2025-07-22 03:41:54,643 - INFO - orders - User 30: Updated balance/margin cache after static orders update - balance=10000.00000000, margin=0.0
2025-07-22 03:41:57,253 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:41:57,258 - INFO - orders - Found 1 rejected orders for user 30
2025-07-22 03:41:58,566 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:41:58,567 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:58,571 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:41:58,576 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:41:58,580 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:41:58,588 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:41:58,597 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:41:59,276 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:41:59,276 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:59,281 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:41:59,287 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:41:59,289 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:41:59,294 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:41:59,294 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:41:59,295 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:41:59,295 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:41:59,295 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:41:59,299 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:42:01,501 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:42:08,388 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:42:24,637 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:42:32,881 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:42:32,881 - INFO - orders - Using order model: UserOrder
2025-07-22 03:42:32,886 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:42:32,890 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:42:32,893 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:42:32,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:42:32,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:42:32,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:42:32,901 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:42:32,902 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:42:32,902 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:42:32,902 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:42:32,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:42:32,906 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:42:32,916 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:42:33,995 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:42:33,995 - INFO - orders - Using order model: UserOrder
2025-07-22 03:42:34,000 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:42:34,005 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:42:34,007 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:42:34,010 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:42:34,011 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:42:34,011 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:42:34,011 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:42:34,011 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:42:34,014 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:54:38,416 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:54:39,730 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:54:39,731 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:54:39,731 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:54:39,731 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:54:39,776 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:54:39,777 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:54:41,265 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 10, Symbol AUDJPY
2025-07-22 03:54:41,269 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:41,269 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDJPY: AllMarginsPerLot=[Decimal('651.421031')], HighestMarginPerLot=651.421031
2025-07-22 03:54:41,269 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 10, Symbol AUDJPY: CalculatedTotalMargin=6.51
2025-07-22 03:54:41,271 - INFO - orders - [TOTAL_USER_MARGIN] User 10 total margin across all symbols: 6.51
2025-07-22 03:54:41,357 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 11, Symbol AUDJPY
2025-07-22 03:54:41,357 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:41,357 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: AllMarginsPerLot=[Decimal('96717')], HighestMarginPerLot=96717
2025-07-22 03:54:41,357 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 11, Symbol AUDJPY: CalculatedTotalMargin=967.17
2025-07-22 03:54:41,357 - INFO - orders - [TOTAL_USER_MARGIN] User 11 total margin across all symbols: 967.17
2025-07-22 03:54:42,158 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 19, Symbol AUDJPY
2025-07-22 03:54:42,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol AUDJPY: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:42,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol AUDJPY: AllMarginsPerLot=[Decimal('654.751744')], HighestMarginPerLot=654.751744
2025-07-22 03:54:42,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 19, Symbol AUDJPY: CalculatedTotalMargin=6.55
2025-07-22 03:54:42,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 19, Symbol CADCHF
2025-07-22 03:54:42,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:42,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol CADCHF: AllMarginsPerLot=[Decimal('727.123574')], HighestMarginPerLot=727.123574
2025-07-22 03:54:42,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 19, Symbol CADCHF: CalculatedTotalMargin=7.27
2025-07-22 03:54:42,160 - INFO - orders - [TOTAL_USER_MARGIN] User 19 total margin across all symbols: 13.82
2025-07-22 03:54:42,232 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol AUDCAD
2025-07-22 03:54:42,232 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:42,232 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.55194')], HighestMarginPerLot=657.55194
2025-07-22 03:54:42,232 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol AUDCAD: CalculatedTotalMargin=6.58
2025-07-22 03:54:42,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol EURUSD
2025-07-22 03:54:42,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:42,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: AllMarginsPerLot=[Decimal('1180')], HighestMarginPerLot=1180
2025-07-22 03:54:42,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol EURUSD: CalculatedTotalMargin=11.80
2025-07-22 03:54:42,233 - INFO - orders - [TOTAL_USER_MARGIN] User 20 total margin across all symbols: 18.38
2025-07-22 03:54:46,346 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:54:46,561 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 22, Symbol AUDCHF
2025-07-22 03:54:46,563 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.101216')], HighestMarginPerLot=657.101216
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 4 positions for User 22, Symbol AUDJPY
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000, IsHedged=True
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: AllMarginsPerLot=[Decimal('657.431957'), Decimal('652.816419'), Decimal('652.829301'), Decimal('652.889785')], HighestMarginPerLot=657.431957
2025-07-22 03:54:46,565 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDJPY: CalculatedTotalMargin=13.15
2025-07-22 03:54:46,565 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 22, Symbol AUDCAD
2025-07-22 03:54:46,565 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 03:54:46,566 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.598728'), Decimal('652.660595')], HighestMarginPerLot=652.660595
2025-07-22 03:54:46,566 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCAD: CalculatedTotalMargin=6.53
2025-07-22 03:54:46,567 - INFO - orders - [TOTAL_USER_MARGIN] User 22 total margin across all symbols: 26.25
2025-07-22 03:54:47,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol CHFSGD
2025-07-22 03:54:47,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol CHFSGD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol CHFSGD: AllMarginsPerLot=[Decimal('1252.62263')], HighestMarginPerLot=1252.62263
2025-07-22 03:54:47,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol CHFSGD: CalculatedTotalMargin=12.53
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol AUDJPY
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDJPY: AllMarginsPerLot=[Decimal('651.87873')], HighestMarginPerLot=651.87873
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol AUDJPY: CalculatedTotalMargin=6.52
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol AUDCAD
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.11352')], HighestMarginPerLot=652.11352
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol AUDCAD: CalculatedTotalMargin=6.52
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1943')], HighestMarginPerLot=1943
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.43
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol JP225
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol JP225: TotalBuyQty=10.00000000, TotalSellQty=0, NetQty=10.00000000, IsHedged=False
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol JP225: AllMarginsPerLot=[Decimal('2.69301619')], HighestMarginPerLot=2.69301619
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol JP225: CalculatedTotalMargin=26.93
2025-07-22 03:54:47,060 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:54:47,060 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,060 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23682')], HighestMarginPerLot=23682
2025-07-22 03:54:47,060 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=236.82
2025-07-22 03:54:47,060 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 308.75
2025-07-22 03:54:47,127 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 27, Symbol AUDJPY
2025-07-22 03:54:47,127 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 03:54:47,127 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: AllMarginsPerLot=[Decimal('648.460213'), Decimal('651.498922')], HighestMarginPerLot=651.498922
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDJPY: CalculatedTotalMargin=13.03
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 27, Symbol AUDUSD
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: AllMarginsPerLot=[Decimal('652')], HighestMarginPerLot=652
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDUSD: CalculatedTotalMargin=6.52
2025-07-22 03:54:47,128 - INFO - orders - [TOTAL_USER_MARGIN] User 27 total margin across all symbols: 19.55
2025-07-22 03:54:47,195 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 28, Symbol EURPLN
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: AllMarginsPerLot=[Decimal('4257'), Decimal('4257')], HighestMarginPerLot=4257
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol EURPLN: CalculatedTotalMargin=85.14
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 28, Symbol BTCUSD
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24050.95')], HighestMarginPerLot=24050.95
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol BTCUSD: CalculatedTotalMargin=9620.38
2025-07-22 03:54:47,196 - INFO - orders - [TOTAL_USER_MARGIN] User 28 total margin across all symbols: 9705.52
2025-07-22 03:54:48,311 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:54:49,029 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:54:49,727 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:54:53,009 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:54:56,344 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:54:59,391 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:54:59,763 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:01,035 - INFO - orders - Fetching rejected orders for user: 1
2025-07-22 03:55:01,075 - INFO - orders - Found 0 rejected orders for user 1
2025-07-22 03:55:01,700 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:03,985 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:04,476 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:06,305 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:08,694 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:09,073 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:10,987 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:11,721 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:13,725 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:15,996 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:18,376 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:22,942 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:25,231 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:27,893 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:32,716 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:38,830 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:39,509 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:41,433 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:43,505 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:48,400 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:50,688 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:53,007 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:55,406 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:57,592 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:02,535 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:09,551 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:11,469 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:11,853 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:16,090 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:18,801 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:20,670 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:23,794 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:32,576 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:35,146 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:39,916 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:43,916 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:44,781 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:46,227 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:53,120 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:53,477 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:58,152 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:00,051 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:02,355 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:04,643 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:05,166 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:06,970 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:07,593 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:11,589 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:12,507 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:14,255 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:16,223 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:16,817 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:18,506 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:23,387 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:24,094 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:26,407 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:27,894 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:28,664 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:30,304 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:32,873 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:36,991 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:39,319 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:48,537 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:50,844 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:51,353 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:53,106 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:53,612 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:55,938 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:58,179 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:00,437 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:02,374 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:02,853 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:04,673 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:07,579 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:09,348 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:14,349 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:16,307 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:23,956 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:25,788 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:30,790 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:32,737 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:33,213 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:35,404 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:39,905 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:40,662 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:42,315 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:43,258 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:46,962 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:49,359 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:51,357 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:51,802 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:53,545 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:55,850 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:56,244 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:58,160 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:58,554 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:00,895 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:05,538 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:07,776 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:10,089 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:12,017 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:12,743 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:14,350 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:14,731 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:17,011 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:22,131 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:26,442 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:28,824 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:31,295 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:33,316 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:37,606 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:38,050 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:39,863 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:42,532 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:45,336 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:49,364 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 10, Symbol AUDJPY
2025-07-22 03:59:49,364 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:49,364 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDJPY: AllMarginsPerLot=[Decimal('651.421031')], HighestMarginPerLot=651.421031
2025-07-22 03:59:49,364 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 10, Symbol AUDJPY: CalculatedTotalMargin=6.51
2025-07-22 03:59:49,364 - INFO - orders - [TOTAL_USER_MARGIN] User 10 total margin across all symbols: 6.51
2025-07-22 03:59:49,452 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 11, Symbol AUDJPY
2025-07-22 03:59:49,452 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:49,452 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: AllMarginsPerLot=[Decimal('96717')], HighestMarginPerLot=96717
2025-07-22 03:59:49,452 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 11, Symbol AUDJPY: CalculatedTotalMargin=967.17
2025-07-22 03:59:49,452 - INFO - orders - [TOTAL_USER_MARGIN] User 11 total margin across all symbols: 967.17
2025-07-22 03:59:49,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 19, Symbol AUDJPY
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol AUDJPY: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol AUDJPY: AllMarginsPerLot=[Decimal('654.751744')], HighestMarginPerLot=654.751744
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 19, Symbol AUDJPY: CalculatedTotalMargin=6.55
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 19, Symbol CADCHF
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol CADCHF: AllMarginsPerLot=[Decimal('727.123574')], HighestMarginPerLot=727.123574
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 19, Symbol CADCHF: CalculatedTotalMargin=7.27
2025-07-22 03:59:49,997 - INFO - orders - [TOTAL_USER_MARGIN] User 19 total margin across all symbols: 13.82
2025-07-22 03:59:50,070 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol AUDCAD
2025-07-22 03:59:50,070 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.55194')], HighestMarginPerLot=657.55194
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol AUDCAD: CalculatedTotalMargin=6.58
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol EURUSD
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: AllMarginsPerLot=[Decimal('1180')], HighestMarginPerLot=1180
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol EURUSD: CalculatedTotalMargin=11.80
2025-07-22 03:59:50,071 - INFO - orders - [TOTAL_USER_MARGIN] User 20 total margin across all symbols: 18.38
2025-07-22 03:59:50,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 22, Symbol AUDCHF
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.101216')], HighestMarginPerLot=657.101216
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 4 positions for User 22, Symbol AUDJPY
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000, IsHedged=True
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: AllMarginsPerLot=[Decimal('657.431957'), Decimal('652.816419'), Decimal('652.829301'), Decimal('652.889785')], HighestMarginPerLot=657.431957
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDJPY: CalculatedTotalMargin=13.15
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 22, Symbol AUDCAD
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.598728'), Decimal('652.660595')], HighestMarginPerLot=652.660595
2025-07-22 03:59:50,242 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCAD: CalculatedTotalMargin=6.53
2025-07-22 03:59:50,242 - INFO - orders - [TOTAL_USER_MARGIN] User 22 total margin across all symbols: 26.25
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol CHFSGD
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol CHFSGD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol CHFSGD: AllMarginsPerLot=[Decimal('1252.62263')], HighestMarginPerLot=1252.62263
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol CHFSGD: CalculatedTotalMargin=12.53
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol AUDJPY
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDJPY: AllMarginsPerLot=[Decimal('651.87873')], HighestMarginPerLot=651.87873
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol AUDJPY: CalculatedTotalMargin=6.52
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol AUDCAD
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.11352')], HighestMarginPerLot=652.11352
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol AUDCAD: CalculatedTotalMargin=6.52
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1943')], HighestMarginPerLot=1943
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.43
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol JP225
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol JP225: TotalBuyQty=10.00000000, TotalSellQty=0, NetQty=10.00000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol JP225: AllMarginsPerLot=[Decimal('2.69301619')], HighestMarginPerLot=2.69301619
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol JP225: CalculatedTotalMargin=26.93
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23682')], HighestMarginPerLot=23682
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=236.82
2025-07-22 03:59:50,534 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 308.75
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 27, Symbol AUDJPY
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: AllMarginsPerLot=[Decimal('648.460213'), Decimal('651.498922')], HighestMarginPerLot=651.498922
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDJPY: CalculatedTotalMargin=13.03
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 27, Symbol AUDUSD
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: AllMarginsPerLot=[Decimal('652')], HighestMarginPerLot=652
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDUSD: CalculatedTotalMargin=6.52
2025-07-22 03:59:50,615 - INFO - orders - [TOTAL_USER_MARGIN] User 27 total margin across all symbols: 19.55
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 28, Symbol EURPLN
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: AllMarginsPerLot=[Decimal('4257'), Decimal('4257')], HighestMarginPerLot=4257
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol EURPLN: CalculatedTotalMargin=85.14
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 28, Symbol BTCUSD
2025-07-22 03:59:50,694 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:59:50,694 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24050.95')], HighestMarginPerLot=24050.95
2025-07-22 03:59:50,694 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol BTCUSD: CalculatedTotalMargin=9620.38
2025-07-22 03:59:50,694 - INFO - orders - [TOTAL_USER_MARGIN] User 28 total margin across all symbols: 9705.52
2025-07-22 03:59:56,736 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:58,808 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 04:00:03,484 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 04:00:04,003 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 04:00:10,851 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 04:00:13,464 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 04:00:15,356 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 04:00:15,913 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 04:00:22,296 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 04:00:23,193 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 21:32:51,458 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 21:32:52,653 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 21:32:52,653 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 21:32:52,653 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 21:32:52,654 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 21:32:52,688 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 21:32:52,688 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 21:32:53,569 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 21:32:53,570 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 21:32:53,570 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 21:32:53,570 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 21:32:53,570 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:32:53,615 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:32:53,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:32:53,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:32:53,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:32:53,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:32:53,721 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:32:53,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 21:32:53,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 21:32:53,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 21:32:53,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 21:32:53,733 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 21:32:53,733 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 21:32:53,733 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 21:32:53,733 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 21:32:53,733 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 21:32:54,892 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:32:54,892 - INFO - orders - Using order model: UserOrder
2025-07-22 21:32:54,894 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:32:54,896 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:32:54,897 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:32:54,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:32:54,900 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:32:54,903 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:32:55,702 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:32:55,702 - INFO - orders - Using order model: UserOrder
2025-07-22 21:32:55,703 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:32:55,705 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:32:55,705 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:32:55,708 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:32:55,708 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:32:55,708 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:32:55,708 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:32:55,708 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:32:55,710 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:32:57,653 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 21:33:02,659 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 21:33:24,108 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:26,450 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:28,614 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:33:28,614 - INFO - orders - Using order model: UserOrder
2025-07-22 21:33:28,616 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:33:28,617 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:33:28,618 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:33:28,620 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:33:28,621 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:33:28,695 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:29,203 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:33:29,204 - INFO - orders - Using order model: UserOrder
2025-07-22 21:33:29,205 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:33:29,208 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:33:29,212 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:33:29,217 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:33:29,217 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:33:29,217 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:33:29,217 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:33:29,217 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:33:29,223 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:33:35,682 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:37,886 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:42,533 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:44,812 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:47,107 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:49,901 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:52,156 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:54,414 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:56,768 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:59,127 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:02,672 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:34:02,672 - INFO - orders - Using order model: UserOrder
2025-07-22 21:34:02,674 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:34:02,675 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:34:02,676 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:34:02,678 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:34:02,679 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:34:02,684 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:34:03,298 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:34:03,298 - INFO - orders - Using order model: UserOrder
2025-07-22 21:34:03,300 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:34:03,302 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:34:03,303 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:34:03,305 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:34:03,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:34:03,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:34:03,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:34:03,306 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:34:03,309 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:34:03,929 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:06,236 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:08,658 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:10,934 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:13,185 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:15,499 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:17,767 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:34,064 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:36,490 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:34:36,490 - INFO - orders - Using order model: UserOrder
2025-07-22 21:34:36,494 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:34:36,498 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:34:36,500 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:34:36,505 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:34:36,505 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:34:36,507 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:34:36,512 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:34:37,307 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:34:37,307 - INFO - orders - Using order model: UserOrder
2025-07-22 21:34:37,312 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:34:37,318 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:34:37,321 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:34:37,328 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:34:37,328 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:34:37,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:34:37,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:34:37,329 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:34:37,337 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:34:38,708 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:45,584 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:47,896 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:50,239 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:54,773 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:59,502 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:01,829 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:04,235 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:06,416 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:08,715 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:10,872 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:35:10,872 - INFO - orders - Using order model: UserOrder
2025-07-22 21:35:10,874 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:35:10,875 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:35:10,876 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:35:10,878 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:35:10,880 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:35:11,641 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:35:11,642 - INFO - orders - Using order model: UserOrder
2025-07-22 21:35:11,645 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:35:11,651 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:35:11,653 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:35:11,660 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:35:11,660 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:35:11,660 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:35:11,660 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:35:11,661 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:35:11,670 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:35:11,679 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:13,858 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:15,990 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:18,381 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:20,672 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:22,992 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:25,308 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:27,654 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:32,342 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:45,190 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:35:45,191 - INFO - orders - Using order model: UserOrder
2025-07-22 21:35:45,192 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:35:45,194 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:35:45,195 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:35:45,198 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:35:45,198 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:35:45,199 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:35:45,796 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:35:45,796 - INFO - orders - Using order model: UserOrder
2025-07-22 21:35:45,797 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:35:45,799 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:35:45,800 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:35:45,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:35:45,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:35:45,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:35:45,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:35:45,802 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:35:45,804 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:35:46,182 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:53,104 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:57,697 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:02,291 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:11,620 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:16,243 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:18,473 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:36:18,473 - INFO - orders - Using order model: UserOrder
2025-07-22 21:36:18,476 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:36:18,477 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:36:18,478 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:36:18,480 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:36:18,480 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:36:18,480 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:36:18,480 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:36:18,481 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:36:18,991 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:36:18,991 - INFO - orders - Using order model: UserOrder
2025-07-22 21:36:18,992 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:36:18,994 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:36:18,995 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:36:18,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:36:18,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:36:18,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:36:18,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:36:18,997 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:36:18,998 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:36:27,808 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:32,400 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:51,848 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:36:51,848 - INFO - orders - Using order model: UserOrder
2025-07-22 21:36:51,849 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:36:51,850 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:36:51,851 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:36:51,853 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:36:51,854 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:36:52,346 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:36:52,346 - INFO - orders - Using order model: UserOrder
2025-07-22 21:36:52,348 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:36:52,350 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:36:52,352 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:36:52,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:36:52,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:36:52,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:36:52,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:36:52,356 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:36:52,359 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:41:56,701 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 21:41:57,708 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 21:41:57,708 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 21:41:57,708 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 21:41:57,709 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 21:41:57,745 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 21:41:57,746 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 21:41:58,578 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 21:41:58,578 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 21:41:58,579 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 21:41:58,579 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 21:41:58,579 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:41:58,621 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:41:58,696 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:41:58,696 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:41:58,696 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:41:58,696 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:41:58,696 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 21:41:58,705 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 21:41:59,718 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:41:59,719 - INFO - orders - Using order model: UserOrder
2025-07-22 21:41:59,721 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:41:59,724 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:41:59,725 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:41:59,728 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:41:59,729 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:41:59,734 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:42:00,505 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:42:00,505 - INFO - orders - Using order model: UserOrder
2025-07-22 21:42:00,509 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:42:00,514 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:42:00,516 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:42:00,522 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:42:00,522 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:42:00,522 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:42:00,522 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:42:00,522 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:42:00,531 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:42:02,910 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 21:42:07,719 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 21:42:34,784 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:42:34,785 - INFO - orders - Using order model: UserOrder
2025-07-22 21:42:34,789 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:42:34,795 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:42:34,797 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:42:34,801 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:42:34,801 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:42:34,801 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:42:34,802 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:42:34,807 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:42:35,598 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:42:35,599 - INFO - orders - Using order model: UserOrder
2025-07-22 21:42:35,602 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:42:35,606 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:42:35,609 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:42:35,616 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:42:35,616 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:42:35,616 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:42:35,616 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:42:35,617 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:42:35,625 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:43:09,691 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 21:43:10,907 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 21:43:10,907 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 21:43:10,907 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 21:43:10,907 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 21:43:10,944 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 21:43:10,945 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 21:43:12,845 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:43:12,845 - INFO - orders - Using order model: UserOrder
2025-07-22 21:43:12,847 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:43:12,851 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:43:12,854 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:43:12,859 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:43:12,859 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:43:12,860 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:43:12,863 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:43:13,580 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:43:13,580 - INFO - orders - Using order model: UserOrder
2025-07-22 21:43:13,583 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:43:13,585 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:43:13,587 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:43:13,591 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:43:13,591 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:43:13,591 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:43:13,591 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:43:13,591 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:43:13,597 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:43:16,232 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 21:43:20,912 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 21:43:30,614 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:43:32,929 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:43:37,571 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:43:44,525 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:43:48,101 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:43:48,101 - INFO - orders - Using order model: UserOrder
2025-07-22 21:43:48,105 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:43:48,107 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:43:48,109 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:43:48,114 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:43:48,114 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:43:48,114 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:43:48,115 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:43:48,121 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:43:49,203 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:43:49,204 - INFO - orders - Using order model: UserOrder
2025-07-22 21:43:49,207 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:43:49,210 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:43:49,213 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:43:49,218 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:43:49,218 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:43:49,218 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:43:49,219 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:43:49,219 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:43:49,225 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:43:54,149 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:45:33,086 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 21:45:34,174 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 21:45:34,174 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 21:45:34,174 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 21:45:34,175 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 21:45:34,216 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 21:45:34,216 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 21:45:35,896 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:45:35,896 - INFO - orders - Using order model: UserOrder
2025-07-22 21:45:35,898 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:45:35,900 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:45:35,901 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:45:35,904 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:45:35,907 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:45:36,514 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:45:36,514 - INFO - orders - Using order model: UserOrder
2025-07-22 21:45:36,516 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:45:36,519 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:45:36,521 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:45:36,525 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:45:36,526 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:45:36,526 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:45:36,526 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:45:36,526 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:45:36,530 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:45:39,189 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 21:45:44,175 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 21:46:09,715 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:46:09,716 - INFO - orders - Using order model: UserOrder
2025-07-22 21:46:09,717 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:46:09,718 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:46:09,719 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:46:09,721 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:46:09,723 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:46:10,312 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:46:10,312 - INFO - orders - Using order model: UserOrder
2025-07-22 21:46:10,314 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:46:10,315 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:46:10,316 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:46:10,318 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:46:10,318 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:46:10,318 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:46:10,318 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:46:10,318 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:46:10,320 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:46:25,271 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:14:24,163 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:14:25,051 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:14:25,051 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:14:25,051 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:14:25,051 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:14:25,089 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:14:25,089 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:14:33,079 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:14:34,047 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:14:34,047 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:14:34,047 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:14:34,048 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:14:34,582 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:14:34,588 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:14:35,885 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 22:14:35,885 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 22:14:35,885 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 22:14:35,885 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 22:14:35,886 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:14:36,021 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:14:36,021 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:14:36,021 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:14:36,022 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:14:36,221 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:14:36,221 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:14:36,221 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:14:36,221 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:14:36,221 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 22:14:36,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 22:14:36,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 22:14:36,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 22:14:36,241 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 22:14:39,025 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:14:39,221 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 22:14:39,285 - INFO - orders - Found 1 rejected orders for user 30
2025-07-22 22:14:39,911 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:14:39,912 - INFO - orders - Using order model: UserOrder
2025-07-22 22:14:39,919 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:14:39,923 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:14:39,926 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:14:39,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:14:39,937 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:14:39,943 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:14:41,369 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:14:41,369 - INFO - orders - Using order model: UserOrder
2025-07-22 22:14:41,372 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:14:41,375 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:14:41,376 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:14:41,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:14:41,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:14:41,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:14:41,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:14:41,381 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:14:41,386 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:14:44,024 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 22:14:44,897 - INFO - orders - [get_closed_orders] user_type: live
2025-07-22 22:14:54,302 - INFO - orders - Fetching rejected orders for user: 1
2025-07-22 22:14:54,303 - INFO - orders - Found 0 rejected orders for user 1
2025-07-22 22:14:59,549 - INFO - orders - [get_closed_orders] user_type: demo
2025-07-22 22:14:59,851 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:02,176 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:04,484 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:06,822 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:09,107 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:13,751 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:15,041 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:15:15,041 - INFO - orders - Using order model: UserOrder
2025-07-22 22:15:15,043 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:15:15,044 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:15:15,045 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:15:15,047 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:15:15,049 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:29:59,916 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:30:00,802 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:30:00,803 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:30:00,803 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:30:00,803 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:30:00,844 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:30:00,844 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:30:01,630 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 22:30:01,631 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 22:30:01,631 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 22:30:01,631 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 22:30:01,631 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:30:01,840 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:30:01,840 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:30:01,840 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:30:01,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:30:01,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:30:01,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:30:01,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:30:01,996 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 22:30:02,014 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 22:30:03,069 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:30:03,069 - INFO - orders - Using order model: UserOrder
2025-07-22 22:30:03,072 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:30:03,074 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:30:03,076 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:30:03,080 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:30:03,084 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:30:03,857 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:30:03,857 - INFO - orders - Using order model: UserOrder
2025-07-22 22:30:03,860 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:30:03,862 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:30:03,864 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:30:03,868 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:30:03,868 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:30:03,868 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:30:03,868 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:30:03,868 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:30:03,873 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:30:05,980 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:30:10,817 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 22:30:16,676 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 22:30:16,700 - INFO - orders - Found 1 rejected orders for user 30
2025-07-22 22:30:27,499 - INFO - orders - [get_closed_orders] user_type: live
2025-07-22 22:30:35,471 - INFO - orders - Order placement request received - User: 30, Symbol: AUDJPY, Type: BUY
2025-07-22 22:30:35,915 - INFO - orders - [MARGIN_CALC] Market data for AUDJPY: {'b': '96.5580000000', 'o': '96.5500000000'}
2025-07-22 22:30:35,915 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDJPY, using bid price with spread: bid=96.5580000000, ask=96.56765580000000
2025-07-22 22:30:35,915 - INFO - orders - [MARGIN_CALC] Using prices for AUDJPY: bid=96.5580000000, ask=96.56765580000000
2025-07-22 22:30:35,918 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 965.68 JPY to USD for margin_calculation (user_id: 30, position: None)
2025-07-22 22:30:35,918 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:30:35,919 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:30:35,920 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:30:35,920 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:30:35,921 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0200000000'), 'o': Decimal('147.0130000000')}
2025-07-22 22:30:35,921 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0200000000
2025-07-22 22:30:35,921 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 965.68 JPY / 147.0200000000 = 6.568358046524282410556386886 USD
2025-07-22 22:30:35,921 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDJPY, Type: BUY, Qty: 0.01, Price: 96.56765580000000, Margin: 6.568358046524282410556386886, Commission: 0.10
2025-07-22 22:30:35,921 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 30, Symbol: AUDJPY, OrderType: BUY, Quantity: 0.01, FullMargin: 6.568358046524282410556386886
2025-07-22 22:30:35,922 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 0
2025-07-22 22:30:35,922 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=BUY, Qty=0.01, Margin=6.568358046524282410556386886
2025-07-22 22:30:35,922 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 0 existing orders + 1 new order
2025-07-22 22:30:35,922 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 30, Symbol AUDJPY. Returning zero margin.
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 30, Symbol AUDJPY
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 30, Symbol AUDJPY: TotalBuyQty=0.01, TotalSellQty=0, NetQty=0.01, IsHedged=False
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 30, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.8358046524282410556386886')], HighestMarginPerLot=656.8358046524282410556386886
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 30, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:30:35,923 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:30:35,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 30, Symbol: AUDJPY, OrderType: BUY, MarginBefore: 0.0, MarginAfter: 6.57, AdditionalMargin: 6.57, OpenOrders: 0
2025-07-22 22:30:35,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=BUY, Qty=0.01, Margin=6.568358046524282410556386886
2025-07-22 22:30:35,924 - INFO - orders - [PERF] Order processing: 0.4491s
2025-07-22 22:30:35,984 - INFO - orders - [PERF] Order creation: 0.0597s
2025-07-22 22:30:35,985 - INFO - orders - is_barclays_live_user in place_order: True
2025-07-22 22:30:35,985 - INFO - orders - [BARCLAYS] Scheduling barclays_push in place_order
2025-07-22 22:30:35,985 - INFO - orders - [PERF] TOTAL place_order: 0.5188s
2025-07-22 22:30:36,016 - INFO - orders - Background balance/margin cache updated for user 30: balance=10000.00000000, margin=0.0
2025-07-22 22:30:36,056 - INFO - orders - [BARCLAYS] barclays_push called in place_order
2025-07-22 22:30:36,463 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 30
2025-07-22 22:30:37,925 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:30:37,925 - INFO - orders - Using order model: UserOrder
2025-07-22 22:30:37,930 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:30:37,933 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:30:37,935 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:30:37,941 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:30:37,942 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:30:37,942 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:30:37,942 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:30:37,942 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:30:37,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:30:37,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:30:37,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:30:37,943 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:30:37,949 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:30:38,786 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:30:38,786 - INFO - orders - Using order model: UserOrder
2025-07-22 22:30:38,789 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:30:38,791 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:30:38,794 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:30:38,800 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:30:38,800 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:30:38,800 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:30:38,800 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:30:38,800 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:30:38,804 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:30:48,584 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:30:49,339 - INFO - orders - Fetching rejected orders for user: 1
2025-07-22 22:30:49,347 - INFO - orders - Found 0 rejected orders for user 1
2025-07-22 22:30:55,444 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:30:58,733 - INFO - orders - [get_closed_orders] user_type: demo
2025-07-22 22:31:02,210 - INFO - orders - [get_closed_orders] user_type: demo
2025-07-22 22:31:02,581 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:31:04,893 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:31:08,554 - INFO - orders - Order placement request received - User: 1, Symbol: AUDJPY, Type: BUY
2025-07-22 22:31:08,917 - INFO - orders - [MARGIN_CALC] Market data for AUDJPY: {'b': '96.5530000000', 'o': '96.5450000000'}
2025-07-22 22:31:08,917 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDJPY, using bid price with spread: bid=96.5530000000, ask=96.56265530000000
2025-07-22 22:31:08,917 - INFO - orders - [MARGIN_CALC] Using prices for AUDJPY: bid=96.5530000000, ask=96.56265530000000
2025-07-22 22:31:08,919 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 965.63 JPY to USD for margin_calculation (user_id: 1, position: None)
2025-07-22 22:31:08,920 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:31:08,921 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:31:08,921 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:31:08,922 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:31:08,923 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0110000000'), 'o': Decimal('147.0050000000')}
2025-07-22 22:31:08,923 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0110000000
2025-07-22 22:31:08,923 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 965.63 JPY / 147.0110000000 = 6.568420050200325145737393800 USD
2025-07-22 22:31:08,923 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDJPY, Type: BUY, Qty: 0.01, Price: 96.56265530000000, Margin: 6.568420050200325145737393800, Commission: 0.10
2025-07-22 22:31:08,923 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 1, Symbol: AUDJPY, OrderType: BUY, Quantity: 0.01, FullMargin: 6.568420050200325145737393800
2025-07-22 22:31:08,923 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 0
2025-07-22 22:31:08,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=BUY, Qty=0.01, Margin=6.568420050200325145737393800
2025-07-22 22:31:08,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 0 existing orders + 1 new order
2025-07-22 22:31:08,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 1, Symbol AUDJPY. Returning zero margin.
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01, TotalSellQty=0, NetQty=0.01, IsHedged=False
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.8420050200325145737393800')], HighestMarginPerLot=656.8420050200325145737393800
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:08,926 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:31:08,926 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 1, Symbol: AUDJPY, OrderType: BUY, MarginBefore: 0.0, MarginAfter: 6.57, AdditionalMargin: 6.57, OpenOrders: 0
2025-07-22 22:31:08,926 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=BUY, Qty=0.01, Margin=6.568420050200325145737393800
2025-07-22 22:31:08,955 - INFO - orders - [CACHE_UPDATE] Updating balance/margin cache for user 1: balance=16449.41000000, margin=6.57000000 (was 0E-8)
2025-07-22 22:31:08,955 - INFO - orders - [CACHE_UPDATE] Balance/margin cache updated for user 1
2025-07-22 22:31:08,956 - INFO - orders - [PERF] Order processing: 0.3976s
2025-07-22 22:31:08,986 - INFO - orders - [PERF] Order creation: 0.0303s
2025-07-22 22:31:08,986 - INFO - orders - is_barclays_live_user in place_order: False
2025-07-22 22:31:08,987 - INFO - orders - [PERF] TOTAL place_order: 0.4337s
2025-07-22 22:31:09,007 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:09,007 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:09,007 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:09,007 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:09,007 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:09,035 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:09,036 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:09,036 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:09,036 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:09,036 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:09,045 - INFO - orders - Background balance/margin cache updated for user 1: balance=16449.41000000, margin=6.57
2025-07-22 22:31:09,550 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:31:10,682 - INFO - orders - Order placement request received - User: 1, Symbol: AUDJPY, Type: SELL
2025-07-22 22:31:11,076 - INFO - orders - [MARGIN_CALC] Market data for AUDJPY: {'b': '96.5520000000', 'o': '96.5440000000'}
2025-07-22 22:31:11,077 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDJPY, using bid price with spread: bid=96.5520000000, ask=96.56165520000000
2025-07-22 22:31:11,077 - INFO - orders - [MARGIN_CALC] Using prices for AUDJPY: bid=96.5520000000, ask=96.56165520000000
2025-07-22 22:31:11,079 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 965.52 JPY to USD for margin_calculation (user_id: 1, position: None)
2025-07-22 22:31:11,079 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:31:11,080 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:31:11,081 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:31:11,081 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:31:11,082 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0120000000'), 'o': Decimal('147.0060000000')}
2025-07-22 22:31:11,082 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0120000000
2025-07-22 22:31:11,082 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 965.52 JPY / 147.0120000000 = 6.567627132478981307648355236 USD
2025-07-22 22:31:11,082 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDJPY, Type: SELL, Qty: 0.01, Price: 96.5520000000, Margin: 6.567627132478981307648355236, Commission: 0.10
2025-07-22 22:31:11,082 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 1, Symbol: AUDJPY, OrderType: SELL, Quantity: 0.01, FullMargin: 6.567627132478981307648355236
2025-07-22 22:31:11,083 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 1
2025-07-22 22:31:11,083 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=SELL, Qty=0.01, Margin=6.567627132478981307648355236
2025-07-22 22:31:11,083 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 1 existing orders + 1 new order
2025-07-22 22:31:11,083 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:31:11,083 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:11,084 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.01, NetQty=0.01000000, IsHedged=True
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005'), Decimal('656.7627132478981307648355236')], HighestMarginPerLot=656.842005
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:11,086 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:31:11,086 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 1, Symbol: AUDJPY, OrderType: SELL, MarginBefore: 6.57, MarginAfter: 6.57, AdditionalMargin: 0.0, OpenOrders: 1
2025-07-22 22:31:11,086 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=SELL, Qty=0.01, Margin=6.567627132478981307648355236
2025-07-22 22:31:11,103 - INFO - orders - [CACHE_UPDATE] Updating balance/margin cache for user 1: balance=16449.41000000, margin=6.57000000 (was 6.57000000)
2025-07-22 22:31:11,103 - INFO - orders - [CACHE_UPDATE] Balance/margin cache updated for user 1
2025-07-22 22:31:11,103 - INFO - orders - [PERF] Order processing: 0.4184s
2025-07-22 22:31:11,122 - INFO - orders - [PERF] Order creation: 0.0185s
2025-07-22 22:31:11,122 - INFO - orders - is_barclays_live_user in place_order: False
2025-07-22 22:31:11,122 - INFO - orders - [PERF] TOTAL place_order: 0.4405s
2025-07-22 22:31:11,150 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:11,157 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 22:31:11,157 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005'), Decimal('656.762713')], HighestMarginPerLot=656.842005
2025-07-22 22:31:11,158 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:11,158 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:11,190 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:11,191 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 22:31:11,191 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005'), Decimal('656.762713')], HighestMarginPerLot=656.842005
2025-07-22 22:31:11,191 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:11,191 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:11,198 - INFO - orders - Background balance/margin cache updated for user 1: balance=16449.41000000, margin=6.57
2025-07-22 22:31:11,670 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:31:12,135 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:31:12,720 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:31:12,720 - INFO - orders - Using order model: UserOrder
2025-07-22 22:31:12,725 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:31:12,730 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:31:12,732 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:31:12,739 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:31:12,739 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:31:12,739 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:31:12,743 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:31:13,620 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:31:13,620 - INFO - orders - Using order model: UserOrder
2025-07-22 22:31:13,624 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:31:13,628 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:31:13,631 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:31:13,637 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:31:13,637 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:31:13,637 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:31:13,637 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:31:13,637 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:31:13,643 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:31:14,164 - INFO - orders - Order close request received - Order ID: 1200-001, User ID: 1, Close Price: 96.602
2025-07-22 22:31:14,168 - INFO - orders - Request to close order 1200-001 for user 1 (user_type: demo) with price 96.602. Frontend provided type: SELL, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:31:14,260 - INFO - orders - Demo user 1 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-07-22 22:31:14,277 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:14,277 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005'), Decimal('656.762713')], HighestMarginPerLot=656.842005
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:14,287 - INFO - orders - Existing entry commission for order 1200-001: 0.10000000
2025-07-22 22:31:14,288 - INFO - orders - Commission calculation for order 1200-001: entry=0.10000000, exit=0.100000000000, total=0.20
2025-07-22 22:31:14,288 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -107.000000000000000000000000 JPY to USD for PnL on Close (user_id: 1, position: 1200-001)
2025-07-22 22:31:14,288 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:31:14,290 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:31:14,290 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:31:14,290 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:31:14,291 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0130000000'), 'o': Decimal('147.0050000000')}
2025-07-22 22:31:14,292 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0130000000
2025-07-22 22:31:14,292 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -107.000000000000000000000000 JPY / 147.0130000000 = -0.7278267908280220116588328923 USD
2025-07-22 22:31:14,376 - INFO - orders - AFTER COMMIT: User 1 wallet_balance=16448.48000000, margin=6.57
2025-07-22 22:31:14,406 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:14,406 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:14,406 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:14,406 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:14,406 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:14,449 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:14,450 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:14,450 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:14,450 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:14,450 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:14,458 - INFO - orders - Background balance/margin cache updated for user 1: balance=16448.48000000, margin=6.57
2025-07-22 22:31:14,931 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:31:15,795 - INFO - orders - Order close request received - Order ID: 1199-001, User ID: 1, Close Price: 96.495
2025-07-22 22:31:15,796 - INFO - orders - Request to close order 1199-001 for user 1 (user_type: demo) with price 96.495. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:31:15,824 - INFO - orders - Demo user 1 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-07-22 22:31:15,837 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:15,838 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:15,838 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:15,838 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:15,838 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 1, Symbol AUDJPY. Returning zero margin.
2025-07-22 22:31:15,845 - INFO - orders - Existing entry commission for order 1199-001: 0.10000000
2025-07-22 22:31:15,845 - INFO - orders - Commission calculation for order 1199-001: entry=0.10000000, exit=0.100000000000, total=0.20
2025-07-22 22:31:15,845 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -109.000000000000000000000000 JPY to USD for PnL on Close (user_id: 1, position: 1199-001)
2025-07-22 22:31:15,845 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:31:15,846 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:31:15,846 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:31:15,847 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:31:15,848 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0130000000'), 'o': Decimal('147.0070000000')}
2025-07-22 22:31:15,848 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0130000000
2025-07-22 22:31:15,849 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -109.000000000000000000000000 JPY / 147.0130000000 = -0.7414310299089196193533905165 USD
2025-07-22 22:31:15,884 - INFO - orders - AFTER COMMIT: User 1 wallet_balance=16447.54000000, margin=0
2025-07-22 22:31:15,933 - INFO - orders - Background balance/margin cache updated for user 1: balance=16447.54000000, margin=0.0
2025-07-22 22:31:15,970 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:31:16,504 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:31:18,737 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
