2025-07-10 03:05:16,774 - WARNING - websocket - User DYY5A: Failed to send initial data, connection may be closed
2025-07-10 03:38:51,364 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:59057: Could not validate credentials
2025-07-10 03:38:56,854 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:59067: Could not validate credentials
2025-07-10 04:10:25,491 - WARNING - websocket - [WEBSOCKET_DEBUG] User 1: Stale/missing balance_margin_cache, attempting refresh
2025-07-10 04:15:26,026 - WARNING - websocket - [WEBSOCKET_DEBUG] User 1: Stale/missing balance_margin_cache, attempting refresh
2025-07-10 04:28:39,331 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61387: Could not validate credentials
2025-07-10 04:28:44,825 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61400: Could not validate credentials
2025-07-10 04:28:50,785 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61412: Could not validate credentials
2025-07-10 04:28:56,771 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61422: Could not validate credentials
2025-07-10 04:29:02,793 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61431: Could not validate credentials
2025-07-10 04:29:08,773 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61434: Could not validate credentials
2025-07-10 04:29:14,793 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61441: Could not validate credentials
2025-07-10 04:29:20,791 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61450: Could not validate credentials
2025-07-10 04:29:26,781 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61454: Could not validate credentials
2025-07-10 04:29:32,805 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61457: Could not validate credentials
2025-07-10 04:29:38,790 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61461: Could not validate credentials
2025-07-10 04:29:44,794 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61464: Could not validate credentials
2025-07-10 04:29:50,808 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61467: Could not validate credentials
2025-07-10 04:29:56,781 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61475: Could not validate credentials
2025-07-10 04:30:02,784 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61477: Could not validate credentials
2025-07-10 04:30:08,792 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61480: Could not validate credentials
2025-07-10 04:30:14,775 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61485: Could not validate credentials
2025-07-10 04:30:20,791 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61488: Could not validate credentials
2025-07-10 04:30:26,793 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61497: Could not validate credentials
2025-07-10 04:30:32,804 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61501: Could not validate credentials
2025-07-10 04:30:38,841 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61508: Could not validate credentials
2025-07-10 04:30:44,771 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61512: Could not validate credentials
2025-07-10 04:30:50,776 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61520: Could not validate credentials
2025-07-10 04:30:56,775 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61522: Could not validate credentials
2025-07-10 04:31:02,774 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61525: Could not validate credentials
2025-07-10 04:31:08,797 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61528: Could not validate credentials
2025-07-10 04:31:14,794 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61532: Could not validate credentials
2025-07-10 04:31:20,789 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61535: Could not validate credentials
2025-07-10 04:31:26,784 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61538: Could not validate credentials
2025-07-10 04:31:32,788 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61542: Could not validate credentials
2025-07-10 04:31:38,790 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61546: Could not validate credentials
2025-07-10 04:31:44,785 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61549: Could not validate credentials
2025-07-10 04:31:50,783 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61552: Could not validate credentials
2025-07-10 04:31:56,790 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61555: Could not validate credentials
2025-07-10 04:32:02,788 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61562: Could not validate credentials
2025-07-10 04:32:08,772 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61573: Could not validate credentials
2025-07-10 04:32:14,794 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61583: Could not validate credentials
2025-07-10 04:32:20,798 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61586: Could not validate credentials
2025-07-10 04:32:26,784 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61589: Could not validate credentials
2025-07-10 04:32:32,789 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61592: Could not validate credentials
2025-07-10 04:32:38,786 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:61595: Could not validate credentials
2025-07-10 05:08:42,825 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:49450: Could not validate credentials
2025-07-10 05:08:48,178 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:49468: Could not validate credentials
2025-07-10 05:35:07,511 - WARNING - websocket - User 5O42G: Failed to send initial data, connection may be closed
2025-07-10 06:08:54,816 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:53556: Could not validate credentials
2025-07-10 06:09:00,801 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:53576: Could not validate credentials
2025-07-10 06:09:06,790 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:53584: Could not validate credentials
2025-07-10 06:09:12,800 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:53591: Could not validate credentials
2025-07-10 06:09:18,798 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:53594: Could not validate credentials
2025-07-10 21:23:07,241 - WARNING - websocket - User DYY5A: Failed to send initial data, connection may be closed
2025-07-10 23:13:23,756 - WARNING - websocket - [WEBSOCKET_DEBUG] User 9: Stale/missing balance_margin_cache, attempting refresh
2025-07-10 23:18:25,481 - WARNING - websocket - [WEBSOCKET_DEBUG] User 9: Stale/missing balance_margin_cache, attempting refresh
2025-07-10 23:23:25,835 - WARNING - websocket - [WEBSOCKET_DEBUG] User 9: Stale/missing balance_margin_cache, attempting refresh
2025-07-10 23:36:42,916 - WARNING - websocket - [WEBSOCKET_DEBUG] User 9: Stale/missing balance_margin_cache, attempting refresh
2025-07-10 23:36:42,917 - WARNING - websocket - [WEBSOCKET_DEBUG] User 9: Stale/missing balance_margin_cache, attempting refresh
2025-07-10 23:41:09,153 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:09,194 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:15,019 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:15,149 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:20,513 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:20,558 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:25,896 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:26,014 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:31,285 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:31,487 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:36,684 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:36,874 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:42,181 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:42,289 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:47,566 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:47,688 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:52,954 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:53,099 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:58,348 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:41:58,473 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:04,003 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:04,006 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:09,388 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:09,406 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:14,806 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:14,821 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:20,201 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:20,216 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:25,604 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:25,621 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:30,985 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:31,030 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:36,369 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:36,428 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:41,770 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:41,832 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:47,180 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:47,225 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:53,123 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:53,522 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:58,508 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:42:58,910 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:03,952 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:04,510 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:09,336 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:09,889 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:14,735 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:15,289 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:20,822 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:20,832 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:26,828 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:26,841 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:32,808 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:32,817 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:38,771 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-10 23:43:38,800 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-11 00:01:00,927 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-11 00:01:08,182 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-11 00:01:14,406 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-11 00:01:19,816 - WARNING - websocket - Authentication failed for account_number VTHTN (type live): User not found in correct table.
2025-07-11 00:04:37,606 - WARNING - websocket - User DB7JG: Failed to send initial data, connection may be closed
2025-07-11 00:11:39,213 - WARNING - websocket - User DB7JG: Failed to send initial data, connection may be closed
2025-07-13 21:47:36,912 - WARNING - websocket - WebSocket auth failed: JWT error for 127.0.0.1:54453: Could not validate credentials
2025-07-13 21:50:00,768 - ERROR - websocket - Unexpected WS auth error for 127.0.0.1:54735: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 844, in _request_authentication
    auth_packet = await self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 914, in websocket_endpoint
    db_user_instance = await get_user_by_account_number(db, account_number, user_type)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\crud\user.py", line 38, in get_user_by_account_number
    result = await db.execute(
             ^^^^^^^^^^^^^^^^^
        select(User).filter(User.account_number == account_number, User.user_type == user_type)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3273, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 844, in _request_authentication
    auth_packet = await self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-13 21:50:06,572 - ERROR - websocket - Unexpected WS auth error for 127.0.0.1:54754: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 844, in _request_authentication
    auth_packet = await self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\market_data_ws.py", line 914, in websocket_endpoint
    db_user_instance = await get_user_by_account_number(db, account_number, user_type)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\crud\user.py", line 38, in get_user_by_account_number
    result = await db.execute(
             ^^^^^^^^^^^^^^^^^
        select(User).filter(User.account_number == account_number, User.user_type == user_type)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3273, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 844, in _request_authentication
    auth_packet = await self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
