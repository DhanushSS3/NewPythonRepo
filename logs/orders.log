2025-07-22 03:19:55,994 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:19:56,916 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:19:56,916 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:19:56,916 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:19:56,917 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:19:56,956 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:19:56,956 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:19:57,716 - INFO - orders - Starting update_user_static_orders for user 4, user_type demo
2025-07-22 03:19:57,716 - INFO - orders - Using order model: DemoUserOrder
2025-07-22 03:19:57,721 - INFO - orders - Fetched 0 open orders for user 4
2025-07-22 03:19:57,723 - INFO - orders - Fetched 0 pending orders for user 4
2025-07-22 03:19:57,724 - INFO - orders - Updated static orders cache for user 4 with 0 open orders and 0 pending orders
2025-07-22 03:19:57,730 - INFO - orders - User 4: Updated balance/margin cache after static orders update - balance=100000.00000000, margin=0.0
2025-07-22 03:19:58,760 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:19:58,760 - INFO - orders - Using order model: UserOrder
2025-07-22 03:19:58,762 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:19:58,764 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:19:58,765 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:19:58,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:19:58,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:19:58,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:19:58,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:19:58,770 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:19:58,773 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:19:59,447 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:19:59,447 - INFO - orders - Using order model: UserOrder
2025-07-22 03:19:59,452 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:19:59,456 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:19:59,460 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:19:59,467 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:19:59,467 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:19:59,477 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:20:01,923 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:20:03,632 - ERROR - orders - Error recording rejected order: name 'RejectedOrder' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\orders.py", line 5331, in service_provider_rejected_order
    select(RejectedOrder)
           ^^^^^^^^^^^^^
NameError: name 'RejectedOrder' is not defined
2025-07-22 03:20:06,916 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:20:10,689 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:19,916 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:22,216 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:32,347 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:20:32,347 - INFO - orders - Using order model: UserOrder
2025-07-22 03:20:32,350 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:20:32,352 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:20:32,353 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:20:32,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:20:32,356 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:20:32,359 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:20:32,993 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:20:32,993 - INFO - orders - Using order model: UserOrder
2025-07-22 03:20:32,995 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:20:32,997 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:20:32,998 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:20:33,001 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:20:33,001 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:20:33,008 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:20:34,438 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:36,755 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:20:57,719 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:21:05,937 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:21:05,937 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:05,940 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:21:05,944 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:21:05,945 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:21:05,949 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:21:05,950 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:21:05,950 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:21:05,950 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:21:05,950 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:21:05,955 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:21:06,745 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:21:06,745 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:06,747 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:21:06,751 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:21:06,757 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:21:06,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:21:06,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:21:06,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:21:06,770 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:21:06,770 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:21:06,778 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:21:54,047 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:21:55,186 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:21:55,187 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:21:55,187 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:21:55,187 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:21:55,223 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:21:55,223 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:21:57,418 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:21:57,418 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:57,420 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:21:57,421 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:21:57,423 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:21:57,426 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:21:57,427 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:21:57,427 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:21:57,431 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:21:58,096 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:21:58,096 - INFO - orders - Using order model: UserOrder
2025-07-22 03:21:58,099 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:21:58,104 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:21:58,107 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:21:58,111 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:21:58,111 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:21:58,121 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:22:00,186 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:22:02,106 - INFO - orders - Order rejection recorded: order_id=1031-001, rejected_id=1182-007, reason=Under Maintenance
2025-07-22 03:22:05,187 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:22:14,126 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:16,471 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:30,292 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:32,369 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:22:32,369 - INFO - orders - Using order model: UserOrder
2025-07-22 03:22:32,372 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:22:32,375 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:22:32,376 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:22:32,380 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:22:32,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:22:32,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:22:32,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:22:32,381 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:22:32,385 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:22:33,092 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:22:33,092 - INFO - orders - Using order model: UserOrder
2025-07-22 03:22:33,098 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:22:33,101 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:22:33,104 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:22:33,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:22:33,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:22:33,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:22:33,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:22:33,110 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:22:33,114 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:22:44,321 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:22:46,558 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:06,157 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:23:06,158 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:06,162 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:23:06,167 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:23:06,169 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:23:06,174 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:23:06,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:23:06,175 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:23:06,181 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:23:07,172 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:23:07,172 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:07,175 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:23:07,180 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:23:07,184 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:23:07,190 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:23:07,191 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:23:07,193 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:23:07,193 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:23:07,194 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:23:07,202 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:23:10,529 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:12,974 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:17,597 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:22,218 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:24,559 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:26,796 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:29,164 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:31,503 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:23:41,094 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:23:41,094 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:41,100 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:23:41,103 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:23:41,106 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:23:41,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:23:41,109 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:23:41,110 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:23:41,110 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:23:41,114 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:23:41,880 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:23:41,880 - INFO - orders - Using order model: UserOrder
2025-07-22 03:23:41,884 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:23:41,886 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:23:41,888 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:23:41,891 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:23:41,891 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:23:41,895 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:23:52,195 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:28:33,448 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:28:34,749 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:28:34,749 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:28:34,749 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:28:34,749 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:28:34,845 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:28:34,845 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:28:35,625 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 03:28:35,625 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 03:28:35,625 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 03:28:35,626 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 03:28:35,626 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 03:28:35,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 03:28:35,806 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 03:28:36,891 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:28:36,891 - INFO - orders - Using order model: UserOrder
2025-07-22 03:28:36,893 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:28:36,895 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:28:36,896 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:28:36,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:28:36,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:28:36,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:28:36,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:28:36,900 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:28:36,904 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:28:37,822 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:28:37,822 - INFO - orders - Using order model: UserOrder
2025-07-22 03:28:37,826 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:28:37,830 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:28:37,832 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:28:37,836 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:28:37,836 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:28:37,837 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:28:37,837 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:28:37,837 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:28:37,841 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:28:39,749 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:28:44,762 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:28:49,070 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:28:58,393 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:29:11,003 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:29:11,003 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:11,006 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:29:11,010 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:29:11,012 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:29:11,015 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:29:11,016 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:29:11,016 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:29:11,023 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:29:11,926 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:29:11,926 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:11,930 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:29:11,936 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:29:11,938 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:29:11,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:29:11,943 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:29:11,951 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:29:37,589 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:29:44,670 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:29:45,206 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:29:45,206 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:45,207 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:29:45,209 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:29:45,209 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:29:45,211 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:29:45,211 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:29:45,213 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:29:46,021 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:29:46,022 - INFO - orders - Using order model: UserOrder
2025-07-22 03:29:46,025 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:29:46,032 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:29:46,036 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:29:46,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:29:46,043 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:29:46,047 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:30:07,654 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:10,121 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:19,876 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:30:19,877 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:19,883 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:30:19,886 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:30:19,889 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:30:19,895 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:30:19,896 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:30:19,896 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:30:19,900 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:30:20,753 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:30:20,755 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:20,758 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:30:20,760 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:30:20,762 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:30:20,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:30:20,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:30:20,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:30:20,769 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:30:20,769 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:30:20,774 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:30:26,476 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:32,640 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:30:32,649 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:30:37,612 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:30:37,617 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:30:40,561 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:49,782 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:30:51,012 - INFO - orders - Fetching rejected orders for user: 25
2025-07-22 03:30:51,015 - INFO - orders - Found 1 rejected orders for user 25
2025-07-22 03:30:51,934 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:30:51,935 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:30:51,935 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:30:51,935 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:30:51,935 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:30:54,580 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:30:54,581 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:54,588 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:30:54,593 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:30:54,595 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:30:54,600 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:30:54,601 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:30:54,602 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:30:54,602 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:30:54,602 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:30:54,607 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:30:55,351 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:30:55,351 - INFO - orders - Using order model: UserOrder
2025-07-22 03:30:55,353 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:30:55,357 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:30:55,359 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:30:55,363 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:30:55,363 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:30:55,368 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:31:03,802 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:06,111 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:08,822 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:20,086 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:24,693 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:26,920 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:31:28,627 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:31:28,628 - INFO - orders - Using order model: UserOrder
2025-07-22 03:31:28,632 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:31:28,636 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:31:28,639 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:31:28,645 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:31:28,646 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:31:28,647 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:31:28,647 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:31:28,655 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:31:29,482 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:31:29,482 - INFO - orders - Using order model: UserOrder
2025-07-22 03:31:29,486 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:31:29,490 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:31:29,492 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:31:29,496 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:31:29,496 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:31:29,501 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:40:10,976 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:40:12,272 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:40:12,272 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:40:12,272 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:40:12,272 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:40:12,307 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:40:12,308 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:40:13,206 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 03:40:13,207 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 03:40:13,207 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 03:40:13,207 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 03:40:13,207 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:40:13,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:40:13,247 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:40:13,321 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:40:13,321 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 03:40:13,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 03:40:13,330 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 03:40:14,373 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:40:14,373 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:14,375 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:40:14,377 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:40:14,379 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:40:14,382 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:40:14,382 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:40:14,382 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:40:14,383 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:40:14,383 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:40:14,386 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:40:15,082 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:40:15,082 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:15,087 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:40:15,091 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:40:15,094 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:40:15,099 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:40:15,100 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:40:15,100 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:40:15,100 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:40:15,100 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:40:15,108 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:40:17,272 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:40:19,367 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:21,637 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:22,278 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:40:26,326 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:26,568 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:40:26,599 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:40:35,601 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:40:48,235 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:40:48,235 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:48,238 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:40:48,240 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:40:48,241 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:40:48,244 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:40:48,245 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:40:48,245 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:40:48,250 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:40:49,047 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:40:49,047 - INFO - orders - Using order model: UserOrder
2025-07-22 03:40:49,052 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:40:49,056 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:40:49,057 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:40:49,062 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:40:49,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:40:49,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:40:49,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:40:49,063 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:40:49,068 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:40:50,393 - INFO - orders - Pending order placement request received - User ID: 30, Symbol: BTCUSD, Type: BUY_LIMIT, Quantity: 10
2025-07-22 03:40:50,534 - INFO - orders - Calculated contract_value for pending order: 10.00000000 (contract_size: 1.00000000 * quantity: 10)
2025-07-22 03:40:50,541 - INFO - orders - [DEBUG] User data from cache: {'id': 30, 'email': 'dhanush777ss@gmail.com', 'account_number': '5B0HV', 'group_name': 'Royal+', 'leverage': Decimal('100.00'), 'wallet_balance': Decimal('10000.00000000'), 'margin': Decimal('0E-8'), 'user_type': 'live', 'first_name': None, 'last_name': None, 'country': 'India', 'phone_number': Decimal('1777')}
2025-07-22 03:40:50,541 - INFO - orders - [DEBUG] Group name: Royal+
2025-07-22 03:40:50,545 - INFO - orders - User 30 is_barclays_live_user: True (user_type: live, sending_orders_normalized: barclays)
2025-07-22 03:40:50,549 - INFO - orders - [SYMBOL_INFO] Retrieved external symbol info for BTCUSD: contract_size=1.00000000, profit_currency=USD, digit=2.00000
2025-07-22 03:40:50,972 - INFO - orders - [MARGIN_CALC] Market data for BTCUSD: {'b': '118746.1000000000', 'o': '118736.1000000000'}
2025-07-22 03:40:50,973 - WARNING - orders - [MARGIN_CALC] Missing ask price for BTCUSD, using bid price with spread: bid=118746.1000000000, ask=118757.97461000000000
2025-07-22 03:40:50,973 - INFO - orders - [MARGIN_CALC] Using prices for BTCUSD: bid=118746.1000000000, ask=118757.97461000000000
2025-07-22 03:40:50,973 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: BTCUSD, Type: BUY_LIMIT, Qty: 10, Price: 118757.97461000000000, Margin: 237515.95, Commission: 5937.90
2025-07-22 03:40:50,974 - INFO - orders - Calculated initial margin: 237515.95, commission: 5937.90 for pending order 1194-001
2025-07-22 03:40:51,035 - INFO - orders - [DEBUG][pending_order] Prepared order_data_for_internal_processing: {'order_id': '1194-001', 'order_company_name': 'BTCUSD', 'order_type': 'BUY_LIMIT', 'order_quantity': Decimal('10'), 'order_price': Decimal('100'), 'user_type': 'live', 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '1195-005', 'takeprofit_id': '1196-006', 'order_user_id': 30, 'order_status': 'PENDING_PROCESSING', 'contract_value': Decimal('10.00000000'), 'margin': Decimal('237515.95'), 'commission': Decimal('5937.90'), 'open_time': None}
2025-07-22 03:40:51,035 - INFO - orders - [BARCLAYS] Setting initial order_status to PENDING_PROCESSING for Barclays user. Will be updated to PENDING after service provider confirmation.
2025-07-22 03:40:51,035 - INFO - orders - Placing PENDING order: BUY_LIMIT for user 30 at price 100
2025-07-22 03:40:51,036 - INFO - orders - [ENTER-CRUD] create_order called with: {'order_id': '1194-001', 'order_status': 'PENDING_PROCESSING', 'order_user_id': 30, 'order_company_name': 'BTCUSD', 'order_type': 'BUY_LIMIT', 'order_price': Decimal('100'), 'order_quantity': Decimal('10'), 'contract_value': Decimal('10.00000000'), 'margin': Decimal('237515.95'), 'commission': Decimal('5937.90'), 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '1195-005', 'takeprofit_id': '1196-006', 'close_id': None}
2025-07-22 03:40:51,126 - INFO - orders - Order 1194-001 verified in database on attempt 1 before adding to Redis.
2025-07-22 03:40:51,130 - INFO - orders - Skipping Redis storage for Barclays user pending order 1194-001
2025-07-22 03:40:51,168 - INFO - orders - [PERF] TOTAL place_order: 0.7783s
2025-07-22 03:40:51,271 - INFO - orders - Background balance/margin cache updated for user 30: balance=10000.00000000, margin=0.0
2025-07-22 03:40:51,292 - INFO - orders - [BARCLAYS] barclays_push called for user 30, is_barclays_live_user=True
2025-07-22 03:40:53,792 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:40:53,810 - INFO - orders - Found 0 rejected orders for user 30
2025-07-22 03:40:56,387 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:08,093 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:10,554 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:24,140 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:41:24,140 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:24,143 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:41:24,146 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:41:24,148 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:41:24,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:41:24,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:41:24,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:41:24,154 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:41:24,154 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:41:24,159 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:41:25,091 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:41:25,091 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:25,096 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:41:25,099 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:41:25,101 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:41:25,107 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:41:25,108 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:41:25,113 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:41:26,847 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:45,133 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:41:54,116 - INFO - orders - Service provider update request received: {"order_id":"1194-001","order_status":"PENDING","status":"PENDING"}
2025-07-22 03:41:54,136 - INFO - orders - Original order status: PENDING_PROCESSING
2025-07-22 03:41:54,137 - INFO - orders - Update fields: {'order_id': '1194-001', 'order_status': 'PENDING', 'status': 'PENDING'}
2025-07-22 03:41:54,137 - INFO - orders - Processing regular update for order 1194-001
2025-07-22 03:41:54,176 - ERROR - orders - Error updating user data cache after service provider update: get_user_by_id() missing 1 required positional argument: 'user_type'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\orders.py", line 4837, in service_provider_order_update
    db_user = await get_user_by_id(db, user_id)
                    ~~~~~~~~~~~~~~^^^^^^^^^^^^^
TypeError: get_user_by_id() missing 1 required positional argument: 'user_type'
2025-07-22 03:41:54,183 - INFO - orders - Starting update_user_static_orders for user 30, user_type live
2025-07-22 03:41:54,183 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:54,187 - INFO - orders - Fetched 0 open orders for user 30
2025-07-22 03:41:54,191 - INFO - orders - Fetched 1 pending orders for user 30
2025-07-22 03:41:54,194 - INFO - orders - Updated static orders cache for user 30 with 0 open orders and 1 pending orders
2025-07-22 03:41:54,207 - INFO - orders - User 30: Updated balance/margin cache after static orders update - balance=10000.00000000, margin=0.0
2025-07-22 03:41:54,615 - INFO - orders - Starting update_user_static_orders for user 30, user_type live
2025-07-22 03:41:54,615 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:54,630 - INFO - orders - Fetched 0 open orders for user 30
2025-07-22 03:41:54,634 - INFO - orders - Fetched 0 pending orders for user 30
2025-07-22 03:41:54,636 - INFO - orders - Updated static orders cache for user 30 with 0 open orders and 0 pending orders
2025-07-22 03:41:54,643 - INFO - orders - User 30: Updated balance/margin cache after static orders update - balance=10000.00000000, margin=0.0
2025-07-22 03:41:57,253 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 03:41:57,258 - INFO - orders - Found 1 rejected orders for user 30
2025-07-22 03:41:58,566 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:41:58,567 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:58,571 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:41:58,576 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:41:58,580 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:41:58,587 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:41:58,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:41:58,588 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:41:58,597 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:41:59,276 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:41:59,276 - INFO - orders - Using order model: UserOrder
2025-07-22 03:41:59,281 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:41:59,287 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:41:59,289 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:41:59,294 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:41:59,294 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:41:59,295 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:41:59,295 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:41:59,295 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:41:59,299 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:42:01,501 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:42:08,388 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:42:24,637 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 03:42:32,881 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 03:42:32,881 - INFO - orders - Using order model: UserOrder
2025-07-22 03:42:32,886 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 03:42:32,890 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 03:42:32,893 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 03:42:32,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 03:42:32,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:42:32,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 03:42:32,901 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 03:42:32,902 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 03:42:32,902 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 03:42:32,902 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 03:42:32,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 03:42:32,906 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 03:42:32,916 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 03:42:33,995 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 03:42:33,995 - INFO - orders - Using order model: UserOrder
2025-07-22 03:42:34,000 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 03:42:34,005 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 03:42:34,007 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 03:42:34,010 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 03:42:34,011 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 03:42:34,011 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 03:42:34,011 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 03:42:34,011 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 03:42:34,014 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 03:54:38,416 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 03:54:39,730 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 03:54:39,731 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 03:54:39,731 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 03:54:39,731 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 03:54:39,776 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 03:54:39,777 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 03:54:41,265 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 10, Symbol AUDJPY
2025-07-22 03:54:41,269 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:41,269 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDJPY: AllMarginsPerLot=[Decimal('651.421031')], HighestMarginPerLot=651.421031
2025-07-22 03:54:41,269 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 10, Symbol AUDJPY: CalculatedTotalMargin=6.51
2025-07-22 03:54:41,271 - INFO - orders - [TOTAL_USER_MARGIN] User 10 total margin across all symbols: 6.51
2025-07-22 03:54:41,357 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 11, Symbol AUDJPY
2025-07-22 03:54:41,357 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:41,357 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: AllMarginsPerLot=[Decimal('96717')], HighestMarginPerLot=96717
2025-07-22 03:54:41,357 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 11, Symbol AUDJPY: CalculatedTotalMargin=967.17
2025-07-22 03:54:41,357 - INFO - orders - [TOTAL_USER_MARGIN] User 11 total margin across all symbols: 967.17
2025-07-22 03:54:42,158 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 19, Symbol AUDJPY
2025-07-22 03:54:42,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol AUDJPY: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:42,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol AUDJPY: AllMarginsPerLot=[Decimal('654.751744')], HighestMarginPerLot=654.751744
2025-07-22 03:54:42,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 19, Symbol AUDJPY: CalculatedTotalMargin=6.55
2025-07-22 03:54:42,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 19, Symbol CADCHF
2025-07-22 03:54:42,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:42,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol CADCHF: AllMarginsPerLot=[Decimal('727.123574')], HighestMarginPerLot=727.123574
2025-07-22 03:54:42,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 19, Symbol CADCHF: CalculatedTotalMargin=7.27
2025-07-22 03:54:42,160 - INFO - orders - [TOTAL_USER_MARGIN] User 19 total margin across all symbols: 13.82
2025-07-22 03:54:42,232 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol AUDCAD
2025-07-22 03:54:42,232 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:42,232 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.55194')], HighestMarginPerLot=657.55194
2025-07-22 03:54:42,232 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol AUDCAD: CalculatedTotalMargin=6.58
2025-07-22 03:54:42,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol EURUSD
2025-07-22 03:54:42,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:42,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: AllMarginsPerLot=[Decimal('1180')], HighestMarginPerLot=1180
2025-07-22 03:54:42,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol EURUSD: CalculatedTotalMargin=11.80
2025-07-22 03:54:42,233 - INFO - orders - [TOTAL_USER_MARGIN] User 20 total margin across all symbols: 18.38
2025-07-22 03:54:46,346 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 03:54:46,561 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 22, Symbol AUDCHF
2025-07-22 03:54:46,563 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.101216')], HighestMarginPerLot=657.101216
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 4 positions for User 22, Symbol AUDJPY
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000, IsHedged=True
2025-07-22 03:54:46,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: AllMarginsPerLot=[Decimal('657.431957'), Decimal('652.816419'), Decimal('652.829301'), Decimal('652.889785')], HighestMarginPerLot=657.431957
2025-07-22 03:54:46,565 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDJPY: CalculatedTotalMargin=13.15
2025-07-22 03:54:46,565 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 22, Symbol AUDCAD
2025-07-22 03:54:46,565 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 03:54:46,566 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.598728'), Decimal('652.660595')], HighestMarginPerLot=652.660595
2025-07-22 03:54:46,566 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCAD: CalculatedTotalMargin=6.53
2025-07-22 03:54:46,567 - INFO - orders - [TOTAL_USER_MARGIN] User 22 total margin across all symbols: 26.25
2025-07-22 03:54:47,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol CHFSGD
2025-07-22 03:54:47,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol CHFSGD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol CHFSGD: AllMarginsPerLot=[Decimal('1252.62263')], HighestMarginPerLot=1252.62263
2025-07-22 03:54:47,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol CHFSGD: CalculatedTotalMargin=12.53
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol AUDJPY
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDJPY: AllMarginsPerLot=[Decimal('651.87873')], HighestMarginPerLot=651.87873
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol AUDJPY: CalculatedTotalMargin=6.52
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol AUDCAD
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.11352')], HighestMarginPerLot=652.11352
2025-07-22 03:54:47,058 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol AUDCAD: CalculatedTotalMargin=6.52
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1943')], HighestMarginPerLot=1943
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.43
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol JP225
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol JP225: TotalBuyQty=10.00000000, TotalSellQty=0, NetQty=10.00000000, IsHedged=False
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol JP225: AllMarginsPerLot=[Decimal('2.69301619')], HighestMarginPerLot=2.69301619
2025-07-22 03:54:47,059 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol JP225: CalculatedTotalMargin=26.93
2025-07-22 03:54:47,060 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:54:47,060 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,060 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23682')], HighestMarginPerLot=23682
2025-07-22 03:54:47,060 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=236.82
2025-07-22 03:54:47,060 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 308.75
2025-07-22 03:54:47,127 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 27, Symbol AUDJPY
2025-07-22 03:54:47,127 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 03:54:47,127 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: AllMarginsPerLot=[Decimal('648.460213'), Decimal('651.498922')], HighestMarginPerLot=651.498922
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDJPY: CalculatedTotalMargin=13.03
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 27, Symbol AUDUSD
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: AllMarginsPerLot=[Decimal('652')], HighestMarginPerLot=652
2025-07-22 03:54:47,128 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDUSD: CalculatedTotalMargin=6.52
2025-07-22 03:54:47,128 - INFO - orders - [TOTAL_USER_MARGIN] User 27 total margin across all symbols: 19.55
2025-07-22 03:54:47,195 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 28, Symbol EURPLN
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: AllMarginsPerLot=[Decimal('4257'), Decimal('4257')], HighestMarginPerLot=4257
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol EURPLN: CalculatedTotalMargin=85.14
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 28, Symbol BTCUSD
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24050.95')], HighestMarginPerLot=24050.95
2025-07-22 03:54:47,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol BTCUSD: CalculatedTotalMargin=9620.38
2025-07-22 03:54:47,196 - INFO - orders - [TOTAL_USER_MARGIN] User 28 total margin across all symbols: 9705.52
2025-07-22 03:54:48,311 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:54:49,029 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:54:49,727 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 03:54:53,009 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:54:56,344 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:54:59,391 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:54:59,763 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:01,035 - INFO - orders - Fetching rejected orders for user: 1
2025-07-22 03:55:01,075 - INFO - orders - Found 0 rejected orders for user 1
2025-07-22 03:55:01,700 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:03,985 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:04,476 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:06,305 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:08,694 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:09,073 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:10,987 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:11,721 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:13,725 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:15,996 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:18,376 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:22,942 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:25,231 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:27,893 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:32,716 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:38,830 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:39,509 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:41,433 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:43,505 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:55:48,400 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:50,688 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:53,007 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:55,406 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:55:57,592 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:02,535 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:09,551 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:11,469 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:11,853 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:16,090 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:18,801 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:20,670 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:23,794 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:32,576 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:35,146 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:39,916 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:43,916 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:44,781 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:46,227 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:53,120 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:56:53,477 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:56:58,152 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:00,051 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:02,355 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:04,643 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:05,166 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:06,970 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:07,593 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:11,589 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:12,507 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:14,255 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:16,223 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:16,817 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:18,506 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:23,387 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:24,094 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:26,407 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:27,894 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:28,664 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:30,304 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:32,873 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:36,991 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:39,319 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:48,537 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:50,844 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:51,353 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:53,106 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:57:53,612 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:55,938 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:57:58,179 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:00,437 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:02,374 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:02,853 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:04,673 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:07,579 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:09,348 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:14,349 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:16,307 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:23,956 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:25,788 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:30,790 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:32,737 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:33,213 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:35,404 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:39,905 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:40,662 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:42,315 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:43,258 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:46,962 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:49,359 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:51,357 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:51,802 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:53,545 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:55,850 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:56,244 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:58:58,160 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:58:58,554 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:00,895 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:05,538 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:07,776 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:10,089 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:12,017 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:12,743 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:14,350 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:14,731 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:17,011 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:22,131 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:26,442 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:28,824 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:31,295 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:33,316 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:37,606 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:38,050 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:39,863 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:42,532 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:45,336 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 03:59:49,364 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 10, Symbol AUDJPY
2025-07-22 03:59:49,364 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:49,364 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDJPY: AllMarginsPerLot=[Decimal('651.421031')], HighestMarginPerLot=651.421031
2025-07-22 03:59:49,364 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 10, Symbol AUDJPY: CalculatedTotalMargin=6.51
2025-07-22 03:59:49,364 - INFO - orders - [TOTAL_USER_MARGIN] User 10 total margin across all symbols: 6.51
2025-07-22 03:59:49,452 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 11, Symbol AUDJPY
2025-07-22 03:59:49,452 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:49,452 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: AllMarginsPerLot=[Decimal('96717')], HighestMarginPerLot=96717
2025-07-22 03:59:49,452 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 11, Symbol AUDJPY: CalculatedTotalMargin=967.17
2025-07-22 03:59:49,452 - INFO - orders - [TOTAL_USER_MARGIN] User 11 total margin across all symbols: 967.17
2025-07-22 03:59:49,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 19, Symbol AUDJPY
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol AUDJPY: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol AUDJPY: AllMarginsPerLot=[Decimal('654.751744')], HighestMarginPerLot=654.751744
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 19, Symbol AUDJPY: CalculatedTotalMargin=6.55
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 19, Symbol CADCHF
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 19, Symbol CADCHF: AllMarginsPerLot=[Decimal('727.123574')], HighestMarginPerLot=727.123574
2025-07-22 03:59:49,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 19, Symbol CADCHF: CalculatedTotalMargin=7.27
2025-07-22 03:59:49,997 - INFO - orders - [TOTAL_USER_MARGIN] User 19 total margin across all symbols: 13.82
2025-07-22 03:59:50,070 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol AUDCAD
2025-07-22 03:59:50,070 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.55194')], HighestMarginPerLot=657.55194
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol AUDCAD: CalculatedTotalMargin=6.58
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol EURUSD
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: AllMarginsPerLot=[Decimal('1180')], HighestMarginPerLot=1180
2025-07-22 03:59:50,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol EURUSD: CalculatedTotalMargin=11.80
2025-07-22 03:59:50,071 - INFO - orders - [TOTAL_USER_MARGIN] User 20 total margin across all symbols: 18.38
2025-07-22 03:59:50,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 22, Symbol AUDCHF
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.101216')], HighestMarginPerLot=657.101216
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 4 positions for User 22, Symbol AUDJPY
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000, IsHedged=True
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: AllMarginsPerLot=[Decimal('657.431957'), Decimal('652.816419'), Decimal('652.829301'), Decimal('652.889785')], HighestMarginPerLot=657.431957
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDJPY: CalculatedTotalMargin=13.15
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 22, Symbol AUDCAD
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 03:59:50,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.598728'), Decimal('652.660595')], HighestMarginPerLot=652.660595
2025-07-22 03:59:50,242 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCAD: CalculatedTotalMargin=6.53
2025-07-22 03:59:50,242 - INFO - orders - [TOTAL_USER_MARGIN] User 22 total margin across all symbols: 26.25
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol CHFSGD
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol CHFSGD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol CHFSGD: AllMarginsPerLot=[Decimal('1252.62263')], HighestMarginPerLot=1252.62263
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol CHFSGD: CalculatedTotalMargin=12.53
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol AUDJPY
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDJPY: AllMarginsPerLot=[Decimal('651.87873')], HighestMarginPerLot=651.87873
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol AUDJPY: CalculatedTotalMargin=6.52
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol AUDCAD
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.11352')], HighestMarginPerLot=652.11352
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol AUDCAD: CalculatedTotalMargin=6.52
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1943')], HighestMarginPerLot=1943
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.43
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol JP225
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol JP225: TotalBuyQty=10.00000000, TotalSellQty=0, NetQty=10.00000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol JP225: AllMarginsPerLot=[Decimal('2.69301619')], HighestMarginPerLot=2.69301619
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol JP225: CalculatedTotalMargin=26.93
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23682')], HighestMarginPerLot=23682
2025-07-22 03:59:50,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=236.82
2025-07-22 03:59:50,534 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 308.75
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 27, Symbol AUDJPY
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: AllMarginsPerLot=[Decimal('648.460213'), Decimal('651.498922')], HighestMarginPerLot=651.498922
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDJPY: CalculatedTotalMargin=13.03
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 27, Symbol AUDUSD
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: AllMarginsPerLot=[Decimal('652')], HighestMarginPerLot=652
2025-07-22 03:59:50,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDUSD: CalculatedTotalMargin=6.52
2025-07-22 03:59:50,615 - INFO - orders - [TOTAL_USER_MARGIN] User 27 total margin across all symbols: 19.55
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 28, Symbol EURPLN
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: AllMarginsPerLot=[Decimal('4257'), Decimal('4257')], HighestMarginPerLot=4257
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol EURPLN: CalculatedTotalMargin=85.14
2025-07-22 03:59:50,693 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 28, Symbol BTCUSD
2025-07-22 03:59:50,694 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 03:59:50,694 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24050.95')], HighestMarginPerLot=24050.95
2025-07-22 03:59:50,694 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol BTCUSD: CalculatedTotalMargin=9620.38
2025-07-22 03:59:50,694 - INFO - orders - [TOTAL_USER_MARGIN] User 28 total margin across all symbols: 9705.52
2025-07-22 03:59:56,736 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 03:59:58,808 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 04:00:03,484 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 04:00:04,003 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 04:00:10,851 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 04:00:13,464 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 04:00:15,356 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 04:00:15,913 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 04:00:22,296 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-22 04:00:23,193 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-22 21:32:51,458 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 21:32:52,653 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 21:32:52,653 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 21:32:52,653 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 21:32:52,654 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 21:32:52,688 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 21:32:52,688 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 21:32:53,569 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 21:32:53,570 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 21:32:53,570 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 21:32:53,570 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 21:32:53,570 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:32:53,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:32:53,615 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:32:53,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:32:53,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:32:53,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:32:53,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:32:53,721 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:32:53,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 21:32:53,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 21:32:53,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 21:32:53,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 21:32:53,733 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 21:32:53,733 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 21:32:53,733 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 21:32:53,733 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 21:32:53,733 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 21:32:54,892 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:32:54,892 - INFO - orders - Using order model: UserOrder
2025-07-22 21:32:54,894 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:32:54,896 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:32:54,897 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:32:54,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:32:54,900 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:32:54,900 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:32:54,903 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:32:55,702 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:32:55,702 - INFO - orders - Using order model: UserOrder
2025-07-22 21:32:55,703 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:32:55,705 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:32:55,705 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:32:55,708 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:32:55,708 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:32:55,708 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:32:55,708 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:32:55,708 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:32:55,710 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:32:57,653 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 21:33:02,659 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 21:33:24,108 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:26,450 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:28,614 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:33:28,614 - INFO - orders - Using order model: UserOrder
2025-07-22 21:33:28,616 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:33:28,617 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:33:28,618 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:33:28,620 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:33:28,620 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:33:28,621 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:33:28,695 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:29,203 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:33:29,204 - INFO - orders - Using order model: UserOrder
2025-07-22 21:33:29,205 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:33:29,208 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:33:29,212 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:33:29,217 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:33:29,217 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:33:29,217 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:33:29,217 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:33:29,217 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:33:29,223 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:33:35,682 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:37,886 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:42,533 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:44,812 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:47,107 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:49,901 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:52,156 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:54,414 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:56,768 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:33:59,127 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:02,672 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:34:02,672 - INFO - orders - Using order model: UserOrder
2025-07-22 21:34:02,674 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:34:02,675 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:34:02,676 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:34:02,678 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:34:02,679 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:34:02,679 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:34:02,684 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:34:03,298 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:34:03,298 - INFO - orders - Using order model: UserOrder
2025-07-22 21:34:03,300 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:34:03,302 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:34:03,303 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:34:03,305 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:34:03,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:34:03,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:34:03,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:34:03,306 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:34:03,309 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:34:03,929 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:06,236 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:08,658 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:10,934 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:13,185 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:15,499 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:17,767 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:34,064 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:36,490 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:34:36,490 - INFO - orders - Using order model: UserOrder
2025-07-22 21:34:36,494 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:34:36,498 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:34:36,500 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:34:36,505 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:34:36,505 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:34:36,506 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:34:36,507 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:34:36,512 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:34:37,307 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:34:37,307 - INFO - orders - Using order model: UserOrder
2025-07-22 21:34:37,312 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:34:37,318 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:34:37,321 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:34:37,328 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:34:37,328 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:34:37,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:34:37,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:34:37,329 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:34:37,337 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:34:38,708 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:45,584 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:47,896 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:50,239 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:54,773 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:34:59,502 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:01,829 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:04,235 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:06,416 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:08,715 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:10,872 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:35:10,872 - INFO - orders - Using order model: UserOrder
2025-07-22 21:35:10,874 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:35:10,875 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:35:10,876 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:35:10,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:35:10,878 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:35:10,880 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:35:11,641 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:35:11,642 - INFO - orders - Using order model: UserOrder
2025-07-22 21:35:11,645 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:35:11,651 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:35:11,653 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:35:11,660 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:35:11,660 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:35:11,660 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:35:11,660 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:35:11,661 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:35:11,670 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:35:11,679 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:13,858 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:15,990 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:18,381 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:20,672 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:22,992 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:25,308 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:27,654 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:32,342 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:45,190 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:35:45,191 - INFO - orders - Using order model: UserOrder
2025-07-22 21:35:45,192 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:35:45,194 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:35:45,195 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:35:45,197 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:35:45,198 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:35:45,198 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:35:45,199 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:35:45,796 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:35:45,796 - INFO - orders - Using order model: UserOrder
2025-07-22 21:35:45,797 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:35:45,799 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:35:45,800 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:35:45,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:35:45,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:35:45,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:35:45,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:35:45,802 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:35:45,804 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:35:46,182 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:53,104 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:35:57,697 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:02,291 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:11,620 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:16,243 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:18,473 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:36:18,473 - INFO - orders - Using order model: UserOrder
2025-07-22 21:36:18,476 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:36:18,477 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:36:18,478 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:36:18,479 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:36:18,480 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:36:18,480 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:36:18,480 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:36:18,480 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:36:18,481 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:36:18,991 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:36:18,991 - INFO - orders - Using order model: UserOrder
2025-07-22 21:36:18,992 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:36:18,994 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:36:18,995 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:36:18,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:36:18,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:36:18,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:36:18,997 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:36:18,997 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:36:18,998 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:36:27,808 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:32,400 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:36:51,848 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:36:51,848 - INFO - orders - Using order model: UserOrder
2025-07-22 21:36:51,849 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:36:51,850 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:36:51,851 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:36:51,853 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:36:51,853 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:36:51,854 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:36:52,346 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:36:52,346 - INFO - orders - Using order model: UserOrder
2025-07-22 21:36:52,348 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:36:52,350 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:36:52,352 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:36:52,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:36:52,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:36:52,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:36:52,356 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:36:52,356 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:36:52,359 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:41:56,701 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 21:41:57,708 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 21:41:57,708 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 21:41:57,708 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 21:41:57,709 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 21:41:57,745 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 21:41:57,746 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 21:41:58,578 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 21:41:58,578 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 21:41:58,579 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 21:41:58,579 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 21:41:58,579 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:41:58,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:41:58,621 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:41:58,696 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:41:58,696 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:41:58,696 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:41:58,696 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:41:58,696 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 21:41:58,705 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 21:41:58,705 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 21:41:59,718 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:41:59,719 - INFO - orders - Using order model: UserOrder
2025-07-22 21:41:59,721 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:41:59,724 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:41:59,725 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:41:59,728 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:41:59,729 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:41:59,729 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:41:59,734 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:42:00,505 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:42:00,505 - INFO - orders - Using order model: UserOrder
2025-07-22 21:42:00,509 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:42:00,514 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:42:00,516 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:42:00,522 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:42:00,522 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:42:00,522 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:42:00,522 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:42:00,522 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:42:00,531 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:42:02,910 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 21:42:07,719 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 21:42:34,784 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:42:34,785 - INFO - orders - Using order model: UserOrder
2025-07-22 21:42:34,789 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:42:34,795 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:42:34,797 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:42:34,801 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:42:34,801 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:42:34,801 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:42:34,802 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:42:34,802 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:42:34,807 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:42:35,598 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:42:35,599 - INFO - orders - Using order model: UserOrder
2025-07-22 21:42:35,602 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:42:35,606 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:42:35,609 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:42:35,616 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:42:35,616 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:42:35,616 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:42:35,616 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:42:35,617 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:42:35,625 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:43:09,691 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 21:43:10,907 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 21:43:10,907 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 21:43:10,907 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 21:43:10,907 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 21:43:10,944 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 21:43:10,945 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 21:43:12,845 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:43:12,845 - INFO - orders - Using order model: UserOrder
2025-07-22 21:43:12,847 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:43:12,851 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:43:12,854 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:43:12,859 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:43:12,859 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:43:12,860 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:43:12,860 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:43:12,863 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:43:13,580 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:43:13,580 - INFO - orders - Using order model: UserOrder
2025-07-22 21:43:13,583 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:43:13,585 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:43:13,587 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:43:13,591 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:43:13,591 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:43:13,591 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:43:13,591 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:43:13,591 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:43:13,597 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:43:16,232 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 21:43:20,912 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 21:43:30,614 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:43:32,929 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:43:37,571 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:43:44,525 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:43:48,101 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:43:48,101 - INFO - orders - Using order model: UserOrder
2025-07-22 21:43:48,105 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:43:48,107 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:43:48,109 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:43:48,114 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:43:48,114 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:43:48,114 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:43:48,115 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:43:48,115 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:43:48,121 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:43:49,203 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:43:49,204 - INFO - orders - Using order model: UserOrder
2025-07-22 21:43:49,207 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:43:49,210 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:43:49,213 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:43:49,218 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:43:49,218 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:43:49,218 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:43:49,219 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:43:49,219 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:43:49,225 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:43:54,149 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 21:45:33,086 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 21:45:34,174 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 21:45:34,174 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 21:45:34,174 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 21:45:34,175 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 21:45:34,216 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 21:45:34,216 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 21:45:35,896 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:45:35,896 - INFO - orders - Using order model: UserOrder
2025-07-22 21:45:35,898 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:45:35,900 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:45:35,901 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:45:35,904 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:45:35,904 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:45:35,907 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:45:36,514 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:45:36,514 - INFO - orders - Using order model: UserOrder
2025-07-22 21:45:36,516 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:45:36,519 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:45:36,521 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:45:36,525 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:45:36,526 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:45:36,526 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:45:36,526 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:45:36,526 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:45:36,530 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:45:39,189 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 21:45:44,175 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 21:46:09,715 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 21:46:09,716 - INFO - orders - Using order model: UserOrder
2025-07-22 21:46:09,717 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 21:46:09,718 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 21:46:09,719 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 21:46:09,721 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 21:46:09,721 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 21:46:09,723 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 21:46:10,312 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 21:46:10,312 - INFO - orders - Using order model: UserOrder
2025-07-22 21:46:10,314 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 21:46:10,315 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 21:46:10,316 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 21:46:10,318 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 21:46:10,318 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 21:46:10,318 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 21:46:10,318 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 21:46:10,318 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 21:46:10,320 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 21:46:25,271 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:14:24,163 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:14:25,051 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:14:25,051 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:14:25,051 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:14:25,051 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:14:25,089 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:14:25,089 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:14:33,079 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:14:34,047 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:14:34,047 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:14:34,047 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:14:34,048 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:14:34,582 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:14:34,588 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:14:35,885 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 22:14:35,885 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 22:14:35,885 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 22:14:35,885 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 22:14:35,886 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:14:36,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:14:36,021 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:14:36,021 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:14:36,021 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:14:36,022 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:14:36,221 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:14:36,221 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:14:36,221 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:14:36,221 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:14:36,221 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 22:14:36,240 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 22:14:36,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 22:14:36,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 22:14:36,241 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 22:14:36,241 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 22:14:39,025 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:14:39,221 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 22:14:39,285 - INFO - orders - Found 1 rejected orders for user 30
2025-07-22 22:14:39,911 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:14:39,912 - INFO - orders - Using order model: UserOrder
2025-07-22 22:14:39,919 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:14:39,923 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:14:39,926 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:14:39,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:14:39,937 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:14:39,937 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:14:39,943 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:14:41,369 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:14:41,369 - INFO - orders - Using order model: UserOrder
2025-07-22 22:14:41,372 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:14:41,375 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:14:41,376 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:14:41,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:14:41,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:14:41,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:14:41,381 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:14:41,381 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:14:41,386 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:14:44,024 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 22:14:44,897 - INFO - orders - [get_closed_orders] user_type: live
2025-07-22 22:14:54,302 - INFO - orders - Fetching rejected orders for user: 1
2025-07-22 22:14:54,303 - INFO - orders - Found 0 rejected orders for user 1
2025-07-22 22:14:59,549 - INFO - orders - [get_closed_orders] user_type: demo
2025-07-22 22:14:59,851 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:02,176 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:04,484 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:06,822 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:09,107 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:13,751 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:15:15,041 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:15:15,041 - INFO - orders - Using order model: UserOrder
2025-07-22 22:15:15,043 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:15:15,044 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:15:15,045 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:15:15,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:15:15,047 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:15:15,049 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:29:59,916 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:30:00,802 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:30:00,803 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:30:00,803 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:30:00,803 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:30:00,844 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:30:00,844 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:30:01,630 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 22:30:01,631 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 22:30:01,631 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 22:30:01,631 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 22:30:01,631 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:30:01,839 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:30:01,840 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:30:01,840 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:30:01,840 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:30:01,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:30:01,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:30:01,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:30:01,996 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:30:01,996 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 22:30:02,014 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 22:30:02,014 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 22:30:03,069 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:30:03,069 - INFO - orders - Using order model: UserOrder
2025-07-22 22:30:03,072 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:30:03,074 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:30:03,076 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:30:03,080 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:30:03,080 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:30:03,084 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:30:03,857 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:30:03,857 - INFO - orders - Using order model: UserOrder
2025-07-22 22:30:03,860 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:30:03,862 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:30:03,864 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:30:03,868 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:30:03,868 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:30:03,868 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:30:03,868 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:30:03,868 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:30:03,873 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:30:05,980 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:30:10,817 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 22:30:16,676 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 22:30:16,700 - INFO - orders - Found 1 rejected orders for user 30
2025-07-22 22:30:27,499 - INFO - orders - [get_closed_orders] user_type: live
2025-07-22 22:30:35,471 - INFO - orders - Order placement request received - User: 30, Symbol: AUDJPY, Type: BUY
2025-07-22 22:30:35,915 - INFO - orders - [MARGIN_CALC] Market data for AUDJPY: {'b': '96.5580000000', 'o': '96.5500000000'}
2025-07-22 22:30:35,915 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDJPY, using bid price with spread: bid=96.5580000000, ask=96.56765580000000
2025-07-22 22:30:35,915 - INFO - orders - [MARGIN_CALC] Using prices for AUDJPY: bid=96.5580000000, ask=96.56765580000000
2025-07-22 22:30:35,918 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 965.68 JPY to USD for margin_calculation (user_id: 30, position: None)
2025-07-22 22:30:35,918 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:30:35,919 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:30:35,920 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:30:35,920 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:30:35,921 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0200000000'), 'o': Decimal('147.0130000000')}
2025-07-22 22:30:35,921 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0200000000
2025-07-22 22:30:35,921 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 965.68 JPY / 147.0200000000 = 6.568358046524282410556386886 USD
2025-07-22 22:30:35,921 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDJPY, Type: BUY, Qty: 0.01, Price: 96.56765580000000, Margin: 6.568358046524282410556386886, Commission: 0.10
2025-07-22 22:30:35,921 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 30, Symbol: AUDJPY, OrderType: BUY, Quantity: 0.01, FullMargin: 6.568358046524282410556386886
2025-07-22 22:30:35,922 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 0
2025-07-22 22:30:35,922 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=BUY, Qty=0.01, Margin=6.568358046524282410556386886
2025-07-22 22:30:35,922 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 0 existing orders + 1 new order
2025-07-22 22:30:35,922 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 30, Symbol AUDJPY. Returning zero margin.
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 30, Symbol AUDJPY
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 30, Symbol AUDJPY: TotalBuyQty=0.01, TotalSellQty=0, NetQty=0.01, IsHedged=False
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 30, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.8358046524282410556386886')], HighestMarginPerLot=656.8358046524282410556386886
2025-07-22 22:30:35,923 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 30, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:30:35,923 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:30:35,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 30, Symbol: AUDJPY, OrderType: BUY, MarginBefore: 0.0, MarginAfter: 6.57, AdditionalMargin: 6.57, OpenOrders: 0
2025-07-22 22:30:35,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=BUY, Qty=0.01, Margin=6.568358046524282410556386886
2025-07-22 22:30:35,924 - INFO - orders - [PERF] Order processing: 0.4491s
2025-07-22 22:30:35,984 - INFO - orders - [PERF] Order creation: 0.0597s
2025-07-22 22:30:35,985 - INFO - orders - is_barclays_live_user in place_order: True
2025-07-22 22:30:35,985 - INFO - orders - [BARCLAYS] Scheduling barclays_push in place_order
2025-07-22 22:30:35,985 - INFO - orders - [PERF] TOTAL place_order: 0.5188s
2025-07-22 22:30:36,016 - INFO - orders - Background balance/margin cache updated for user 30: balance=10000.00000000, margin=0.0
2025-07-22 22:30:36,056 - INFO - orders - [BARCLAYS] barclays_push called in place_order
2025-07-22 22:30:36,463 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 30
2025-07-22 22:30:37,925 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:30:37,925 - INFO - orders - Using order model: UserOrder
2025-07-22 22:30:37,930 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:30:37,933 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:30:37,935 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:30:37,941 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:30:37,942 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:30:37,942 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:30:37,942 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:30:37,942 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:30:37,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:30:37,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:30:37,943 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:30:37,943 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:30:37,949 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:30:38,786 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:30:38,786 - INFO - orders - Using order model: UserOrder
2025-07-22 22:30:38,789 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:30:38,791 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:30:38,794 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:30:38,800 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:30:38,800 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:30:38,800 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:30:38,800 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:30:38,800 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:30:38,804 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:30:48,584 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:30:49,339 - INFO - orders - Fetching rejected orders for user: 1
2025-07-22 22:30:49,347 - INFO - orders - Found 0 rejected orders for user 1
2025-07-22 22:30:55,444 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:30:58,733 - INFO - orders - [get_closed_orders] user_type: demo
2025-07-22 22:31:02,210 - INFO - orders - [get_closed_orders] user_type: demo
2025-07-22 22:31:02,581 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:31:04,893 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:31:08,554 - INFO - orders - Order placement request received - User: 1, Symbol: AUDJPY, Type: BUY
2025-07-22 22:31:08,917 - INFO - orders - [MARGIN_CALC] Market data for AUDJPY: {'b': '96.5530000000', 'o': '96.5450000000'}
2025-07-22 22:31:08,917 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDJPY, using bid price with spread: bid=96.5530000000, ask=96.56265530000000
2025-07-22 22:31:08,917 - INFO - orders - [MARGIN_CALC] Using prices for AUDJPY: bid=96.5530000000, ask=96.56265530000000
2025-07-22 22:31:08,919 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 965.63 JPY to USD for margin_calculation (user_id: 1, position: None)
2025-07-22 22:31:08,920 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:31:08,921 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:31:08,921 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:31:08,922 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:31:08,923 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0110000000'), 'o': Decimal('147.0050000000')}
2025-07-22 22:31:08,923 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0110000000
2025-07-22 22:31:08,923 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 965.63 JPY / 147.0110000000 = 6.568420050200325145737393800 USD
2025-07-22 22:31:08,923 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDJPY, Type: BUY, Qty: 0.01, Price: 96.56265530000000, Margin: 6.568420050200325145737393800, Commission: 0.10
2025-07-22 22:31:08,923 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 1, Symbol: AUDJPY, OrderType: BUY, Quantity: 0.01, FullMargin: 6.568420050200325145737393800
2025-07-22 22:31:08,923 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 0
2025-07-22 22:31:08,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=BUY, Qty=0.01, Margin=6.568420050200325145737393800
2025-07-22 22:31:08,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 0 existing orders + 1 new order
2025-07-22 22:31:08,924 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 1, Symbol AUDJPY. Returning zero margin.
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01, TotalSellQty=0, NetQty=0.01, IsHedged=False
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.8420050200325145737393800')], HighestMarginPerLot=656.8420050200325145737393800
2025-07-22 22:31:08,925 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:08,926 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:31:08,926 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 1, Symbol: AUDJPY, OrderType: BUY, MarginBefore: 0.0, MarginAfter: 6.57, AdditionalMargin: 6.57, OpenOrders: 0
2025-07-22 22:31:08,926 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=BUY, Qty=0.01, Margin=6.568420050200325145737393800
2025-07-22 22:31:08,955 - INFO - orders - [CACHE_UPDATE] Updating balance/margin cache for user 1: balance=16449.41000000, margin=6.57000000 (was 0E-8)
2025-07-22 22:31:08,955 - INFO - orders - [CACHE_UPDATE] Balance/margin cache updated for user 1
2025-07-22 22:31:08,956 - INFO - orders - [PERF] Order processing: 0.3976s
2025-07-22 22:31:08,986 - INFO - orders - [PERF] Order creation: 0.0303s
2025-07-22 22:31:08,986 - INFO - orders - is_barclays_live_user in place_order: False
2025-07-22 22:31:08,987 - INFO - orders - [PERF] TOTAL place_order: 0.4337s
2025-07-22 22:31:09,007 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:09,007 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:09,007 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:09,007 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:09,007 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:09,035 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:09,036 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:09,036 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:09,036 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:09,036 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:09,045 - INFO - orders - Background balance/margin cache updated for user 1: balance=16449.41000000, margin=6.57
2025-07-22 22:31:09,550 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:31:10,682 - INFO - orders - Order placement request received - User: 1, Symbol: AUDJPY, Type: SELL
2025-07-22 22:31:11,076 - INFO - orders - [MARGIN_CALC] Market data for AUDJPY: {'b': '96.5520000000', 'o': '96.5440000000'}
2025-07-22 22:31:11,077 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDJPY, using bid price with spread: bid=96.5520000000, ask=96.56165520000000
2025-07-22 22:31:11,077 - INFO - orders - [MARGIN_CALC] Using prices for AUDJPY: bid=96.5520000000, ask=96.56165520000000
2025-07-22 22:31:11,079 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 965.52 JPY to USD for margin_calculation (user_id: 1, position: None)
2025-07-22 22:31:11,079 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:31:11,080 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:31:11,081 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:31:11,081 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:31:11,082 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0120000000'), 'o': Decimal('147.0060000000')}
2025-07-22 22:31:11,082 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0120000000
2025-07-22 22:31:11,082 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 965.52 JPY / 147.0120000000 = 6.567627132478981307648355236 USD
2025-07-22 22:31:11,082 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDJPY, Type: SELL, Qty: 0.01, Price: 96.5520000000, Margin: 6.567627132478981307648355236, Commission: 0.10
2025-07-22 22:31:11,082 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 1, Symbol: AUDJPY, OrderType: SELL, Quantity: 0.01, FullMargin: 6.567627132478981307648355236
2025-07-22 22:31:11,083 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 1
2025-07-22 22:31:11,083 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=SELL, Qty=0.01, Margin=6.567627132478981307648355236
2025-07-22 22:31:11,083 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 1 existing orders + 1 new order
2025-07-22 22:31:11,083 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:31:11,083 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:11,084 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.01, NetQty=0.01000000, IsHedged=True
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005'), Decimal('656.7627132478981307648355236')], HighestMarginPerLot=656.842005
2025-07-22 22:31:11,085 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:11,086 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:31:11,086 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 1, Symbol: AUDJPY, OrderType: SELL, MarginBefore: 6.57, MarginAfter: 6.57, AdditionalMargin: 0.0, OpenOrders: 1
2025-07-22 22:31:11,086 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=SELL, Qty=0.01, Margin=6.567627132478981307648355236
2025-07-22 22:31:11,103 - INFO - orders - [CACHE_UPDATE] Updating balance/margin cache for user 1: balance=16449.41000000, margin=6.57000000 (was 6.57000000)
2025-07-22 22:31:11,103 - INFO - orders - [CACHE_UPDATE] Balance/margin cache updated for user 1
2025-07-22 22:31:11,103 - INFO - orders - [PERF] Order processing: 0.4184s
2025-07-22 22:31:11,122 - INFO - orders - [PERF] Order creation: 0.0185s
2025-07-22 22:31:11,122 - INFO - orders - is_barclays_live_user in place_order: False
2025-07-22 22:31:11,122 - INFO - orders - [PERF] TOTAL place_order: 0.4405s
2025-07-22 22:31:11,150 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:11,157 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 22:31:11,157 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005'), Decimal('656.762713')], HighestMarginPerLot=656.842005
2025-07-22 22:31:11,158 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:11,158 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:11,190 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:11,191 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 22:31:11,191 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005'), Decimal('656.762713')], HighestMarginPerLot=656.842005
2025-07-22 22:31:11,191 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:11,191 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:11,198 - INFO - orders - Background balance/margin cache updated for user 1: balance=16449.41000000, margin=6.57
2025-07-22 22:31:11,670 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:31:12,135 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:31:12,720 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:31:12,720 - INFO - orders - Using order model: UserOrder
2025-07-22 22:31:12,725 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:31:12,730 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:31:12,732 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:31:12,738 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:31:12,739 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:31:12,739 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:31:12,739 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:31:12,743 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:31:13,620 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:31:13,620 - INFO - orders - Using order model: UserOrder
2025-07-22 22:31:13,624 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:31:13,628 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:31:13,631 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:31:13,637 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:31:13,637 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:31:13,637 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:31:13,637 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:31:13,637 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:31:13,643 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:31:14,164 - INFO - orders - Order close request received - Order ID: 1200-001, User ID: 1, Close Price: 96.602
2025-07-22 22:31:14,168 - INFO - orders - Request to close order 1200-001 for user 1 (user_type: demo) with price 96.602. Frontend provided type: SELL, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:31:14,260 - INFO - orders - Demo user 1 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-07-22 22:31:14,277 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:14,277 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005'), Decimal('656.762713')], HighestMarginPerLot=656.842005
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:14,278 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:14,287 - INFO - orders - Existing entry commission for order 1200-001: 0.10000000
2025-07-22 22:31:14,288 - INFO - orders - Commission calculation for order 1200-001: entry=0.10000000, exit=0.100000000000, total=0.20
2025-07-22 22:31:14,288 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -107.000000000000000000000000 JPY to USD for PnL on Close (user_id: 1, position: 1200-001)
2025-07-22 22:31:14,288 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:31:14,290 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:31:14,290 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:31:14,290 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:31:14,291 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0130000000'), 'o': Decimal('147.0050000000')}
2025-07-22 22:31:14,292 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0130000000
2025-07-22 22:31:14,292 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -107.000000000000000000000000 JPY / 147.0130000000 = -0.7278267908280220116588328923 USD
2025-07-22 22:31:14,376 - INFO - orders - AFTER COMMIT: User 1 wallet_balance=16448.48000000, margin=6.57
2025-07-22 22:31:14,406 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:14,406 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:14,406 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:14,406 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:14,406 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:14,449 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:14,450 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:14,450 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:14,450 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:14,450 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:31:14,458 - INFO - orders - Background balance/margin cache updated for user 1: balance=16448.48000000, margin=6.57
2025-07-22 22:31:14,931 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:31:15,795 - INFO - orders - Order close request received - Order ID: 1199-001, User ID: 1, Close Price: 96.495
2025-07-22 22:31:15,796 - INFO - orders - Request to close order 1199-001 for user 1 (user_type: demo) with price 96.495. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:31:15,824 - INFO - orders - Demo user 1 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-07-22 22:31:15,837 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDJPY
2025-07-22 22:31:15,838 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:31:15,838 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDJPY: AllMarginsPerLot=[Decimal('656.842005')], HighestMarginPerLot=656.842005
2025-07-22 22:31:15,838 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDJPY: CalculatedTotalMargin=6.57
2025-07-22 22:31:15,838 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 1, Symbol AUDJPY. Returning zero margin.
2025-07-22 22:31:15,845 - INFO - orders - Existing entry commission for order 1199-001: 0.10000000
2025-07-22 22:31:15,845 - INFO - orders - Commission calculation for order 1199-001: entry=0.10000000, exit=0.100000000000, total=0.20
2025-07-22 22:31:15,845 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -109.000000000000000000000000 JPY to USD for PnL on Close (user_id: 1, position: 1199-001)
2025-07-22 22:31:15,845 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-07-22 22:31:15,846 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:31:15,846 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-07-22 22:31:15,847 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-07-22 22:31:15,848 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('147.0130000000'), 'o': Decimal('147.0070000000')}
2025-07-22 22:31:15,848 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 147.0130000000
2025-07-22 22:31:15,849 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -109.000000000000000000000000 JPY / 147.0130000000 = -0.7414310299089196193533905165 USD
2025-07-22 22:31:15,884 - INFO - orders - AFTER COMMIT: User 1 wallet_balance=16447.54000000, margin=0
2025-07-22 22:31:15,933 - INFO - orders - Background balance/margin cache updated for user 1: balance=16447.54000000, margin=0.0
2025-07-22 22:31:15,970 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:31:16,504 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:31:18,737 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:32:41,768 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:32:42,617 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:32:42,617 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:32:42,617 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:32:42,617 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:32:42,649 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:32:42,650 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:32:43,363 - INFO - orders - Starting update_user_static_orders for user 29, user_type live
2025-07-22 22:32:43,363 - INFO - orders - Using order model: UserOrder
2025-07-22 22:32:43,365 - INFO - orders - Fetched 0 open orders for user 29
2025-07-22 22:32:43,367 - INFO - orders - Fetched 0 pending orders for user 29
2025-07-22 22:32:43,369 - INFO - orders - Updated static orders cache for user 29 with 0 open orders and 0 pending orders
2025-07-22 22:32:43,378 - INFO - orders - User 29: Updated balance/margin cache after static orders update - balance=0E-8, margin=0.0
2025-07-22 22:32:44,605 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:32:44,605 - INFO - orders - Using order model: UserOrder
2025-07-22 22:32:44,609 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:32:44,611 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:32:44,613 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:32:44,617 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:32:44,617 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:32:44,617 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:32:44,617 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:32:44,618 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:32:44,618 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:32:44,618 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:32:44,618 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:32:44,618 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:32:44,622 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:32:45,489 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:32:45,489 - INFO - orders - Using order model: UserOrder
2025-07-22 22:32:45,492 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:32:45,497 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:32:45,500 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:32:45,504 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:32:45,505 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:32:45,505 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:32:45,505 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:32:45,505 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:32:45,512 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:32:47,618 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:32:50,950 - INFO - orders - Fetching rejected orders for user: 1
2025-07-22 22:32:50,962 - INFO - orders - Found 0 rejected orders for user 1
2025-07-22 22:32:52,618 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 22:32:58,378 - INFO - orders - Order placement request received - User: 1, Symbol: AUDCHF, Type: BUY
2025-07-22 22:32:58,725 - INFO - orders - [MARGIN_CALC] Market data for AUDCHF: {'b': '0.5214800000', 'o': '0.5214000000'}
2025-07-22 22:32:58,725 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDCHF, using bid price with spread: bid=0.5214800000, ask=0.52153214800000
2025-07-22 22:32:58,725 - INFO - orders - [MARGIN_CALC] Using prices for AUDCHF: bid=0.5214800000, ask=0.52153214800000
2025-07-22 22:32:58,730 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 5.22 CHF to USD for margin_calculation (user_id: 1, position: None)
2025-07-22 22:32:58,730 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CHFUSD
2025-07-22 22:32:58,731 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:32:58,732 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CHFUSD, trying inverse
2025-07-22 22:32:58,732 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCHF
2025-07-22 22:32:58,732 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('0.7940700000'), 'o': Decimal('0.7940400000')}
2025-07-22 22:32:58,733 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 0.7940700000
2025-07-22 22:32:58,733 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 5.22 CHF / 0.7940700000 = 6.573727756998753258528845064 USD
2025-07-22 22:32:58,733 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDCHF, Type: BUY, Qty: 0.01, Price: 0.52153214800000, Margin: 6.573727756998753258528845064, Commission: 0.10
2025-07-22 22:32:58,733 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 1, Symbol: AUDCHF, OrderType: BUY, Quantity: 0.01, FullMargin: 6.573727756998753258528845064
2025-07-22 22:32:58,733 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 0
2025-07-22 22:32:58,734 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=BUY, Qty=0.01, Margin=6.573727756998753258528845064
2025-07-22 22:32:58,734 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 0 existing orders + 1 new order
2025-07-22 22:32:58,735 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:32:58,735 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 1, Symbol AUDCHF. Returning zero margin.
2025-07-22 22:32:58,735 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:32:58,735 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01, TotalSellQty=0, NetQty=0.01, IsHedged=False
2025-07-22 22:32:58,735 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.3727756998753258528845064')], HighestMarginPerLot=657.3727756998753258528845064
2025-07-22 22:32:58,735 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:32:58,736 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:32:58,736 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 1, Symbol: AUDCHF, OrderType: BUY, MarginBefore: 0.0, MarginAfter: 6.57, AdditionalMargin: 6.57, OpenOrders: 0
2025-07-22 22:32:58,736 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=BUY, Qty=0.01, Margin=6.573727756998753258528845064
2025-07-22 22:32:58,762 - INFO - orders - [CACHE_UPDATE] Updating balance/margin cache for user 1: balance=16447.54000000, margin=6.57000000 (was 0E-8)
2025-07-22 22:32:58,762 - INFO - orders - [CACHE_UPDATE] Balance/margin cache updated for user 1
2025-07-22 22:32:58,762 - INFO - orders - [PERF] Order processing: 0.3792s
2025-07-22 22:32:58,782 - INFO - orders - [PERF] Order creation: 0.0199s
2025-07-22 22:32:58,782 - INFO - orders - is_barclays_live_user in place_order: False
2025-07-22 22:32:58,783 - INFO - orders - [PERF] TOTAL place_order: 0.4076s
2025-07-22 22:32:58,805 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:32:58,806 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:32:58,806 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776')], HighestMarginPerLot=657.372776
2025-07-22 22:32:58,806 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:32:58,806 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:32:58,828 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:32:58,829 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:32:58,829 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776')], HighestMarginPerLot=657.372776
2025-07-22 22:32:58,829 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:32:58,829 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:32:58,836 - INFO - orders - Background balance/margin cache updated for user 1: balance=16447.54000000, margin=6.57
2025-07-22 22:32:59,311 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:33:14,484 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:33:19,339 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:33:19,339 - INFO - orders - Using order model: UserOrder
2025-07-22 22:33:19,342 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:33:19,345 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:33:19,347 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:33:19,352 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:33:19,352 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:33:19,352 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:33:19,353 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:33:19,353 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:33:19,353 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:33:19,353 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:33:19,353 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:33:19,353 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:33:19,358 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:33:20,007 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:33:20,008 - INFO - orders - Using order model: UserOrder
2025-07-22 22:33:20,013 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:33:20,020 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:33:20,023 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:33:20,029 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:33:20,029 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:33:20,029 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:33:20,029 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:33:20,029 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:33:20,033 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:37:46,071 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:37:47,151 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:37:47,151 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:37:47,151 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:37:47,151 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:37:47,191 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:37:47,191 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:37:47,944 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 22:37:47,944 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 22:37:47,944 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 22:37:47,944 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 22:37:47,944 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 22:37:48,040 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 22:37:48,040 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:37:48,040 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 22:37:48,040 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 22:37:48,040 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 22:37:48,040 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 22:37:48,040 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 22:37:48,040 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 22:37:48,040 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 22:37:49,185 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:37:49,185 - INFO - orders - Using order model: UserOrder
2025-07-22 22:37:49,188 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:37:49,190 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:37:49,191 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:37:49,195 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:37:49,195 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:37:49,195 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:37:49,195 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:37:49,195 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:37:49,195 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:37:49,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:37:49,196 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:37:49,196 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:37:49,200 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:37:50,210 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:37:50,210 - INFO - orders - Using order model: UserOrder
2025-07-22 22:37:50,212 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:37:50,213 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:37:50,214 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:37:50,215 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:37:50,216 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:37:50,216 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:37:50,216 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:37:50,216 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:37:50,218 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:37:51,344 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:37:51,344 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:37:51,344 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776')], HighestMarginPerLot=657.372776
2025-07-22 22:37:51,344 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:37:51,344 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:37:52,250 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:37:55,693 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:37:57,157 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 22:37:58,116 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:38:00,423 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:38:24,238 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:38:24,238 - INFO - orders - Using order model: UserOrder
2025-07-22 22:38:24,240 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:38:24,242 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:38:24,244 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:38:24,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:38:24,250 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:38:24,250 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:38:24,250 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:38:24,250 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:38:24,251 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:38:24,251 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:38:24,251 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:38:24,251 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:38:24,257 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:38:25,087 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:38:25,087 - INFO - orders - Using order model: UserOrder
2025-07-22 22:38:25,090 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:38:25,093 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:38:25,096 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:38:25,101 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:38:25,101 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:38:25,101 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:38:25,101 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:38:25,102 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:38:25,107 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:38:35,262 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:38:39,875 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:38:44,477 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:38:58,930 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:38:58,930 - INFO - orders - Using order model: UserOrder
2025-07-22 22:38:58,931 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:38:58,933 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:38:58,934 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:38:58,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:38:58,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:38:58,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:38:58,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:38:58,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:38:58,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:38:58,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:38:58,936 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:38:58,936 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:38:58,938 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:38:59,484 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:38:59,484 - INFO - orders - Using order model: UserOrder
2025-07-22 22:38:59,486 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:38:59,488 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:38:59,489 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:38:59,492 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:38:59,492 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:38:59,492 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:38:59,493 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:38:59,493 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:38:59,495 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:39:12,396 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:39:14,773 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:39:16,984 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:39:19,341 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:39:21,700 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:39:23,942 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:39:26,239 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:39:28,614 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:39:32,724 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:39:32,724 - INFO - orders - Using order model: UserOrder
2025-07-22 22:39:32,726 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:39:32,728 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:39:32,729 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:39:32,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:39:32,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:39:32,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:39:32,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:39:32,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:39:32,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:39:32,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:39:32,732 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:39:32,732 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:39:32,736 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:39:33,702 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:39:33,702 - INFO - orders - Using order model: UserOrder
2025-07-22 22:39:33,706 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:39:33,709 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:39:33,711 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:39:33,715 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:39:33,716 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:39:33,716 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:39:33,716 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:39:33,716 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:39:33,720 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:39:47,453 - INFO - orders - Order placement request received - User: 1, Symbol: AUDCHF, Type: BUY
2025-07-22 22:39:47,773 - INFO - orders - [MARGIN_CALC] Market data for AUDCHF: {'b': '0.5217800000', 'o': '0.5217200000'}
2025-07-22 22:39:47,774 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDCHF, using bid price with spread: bid=0.5217800000, ask=0.52183217800000
2025-07-22 22:39:47,774 - INFO - orders - [MARGIN_CALC] Using prices for AUDCHF: bid=0.5217800000, ask=0.52183217800000
2025-07-22 22:39:47,774 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 5.22 CHF to USD for margin_calculation (user_id: 1, position: None)
2025-07-22 22:39:47,775 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CHFUSD
2025-07-22 22:39:47,775 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:39:47,776 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CHFUSD, trying inverse
2025-07-22 22:39:47,776 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCHF
2025-07-22 22:39:47,776 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('0.7941800000'), 'o': Decimal('0.7941700000')}
2025-07-22 22:39:47,776 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 0.7941800000
2025-07-22 22:39:47,776 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 5.22 CHF / 0.7941800000 = 6.572817245460726787378176232 USD
2025-07-22 22:39:47,776 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDCHF, Type: BUY, Qty: 0.01, Price: 0.52183217800000, Margin: 6.572817245460726787378176232, Commission: 0.10
2025-07-22 22:39:47,777 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 1, Symbol: AUDCHF, OrderType: BUY, Quantity: 0.01, FullMargin: 6.572817245460726787378176232
2025-07-22 22:39:47,777 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 1
2025-07-22 22:39:47,777 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=BUY, Qty=0.01, Margin=6.572817245460726787378176232
2025-07-22 22:39:47,777 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 1 existing orders + 1 new order
2025-07-22 22:39:47,777 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:39:47,777 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:39:47,777 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:39:47,777 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776')], HighestMarginPerLot=657.372776
2025-07-22 22:39:47,781 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:39:47,781 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDCHF
2025-07-22 22:39:47,781 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 22:39:47,781 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776'), Decimal('657.2817245460726787378176232')], HighestMarginPerLot=657.372776
2025-07-22 22:39:47,782 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=13.15
2025-07-22 22:39:47,782 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:39:47,782 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 1, Symbol: AUDCHF, OrderType: BUY, MarginBefore: 6.57, MarginAfter: 13.15, AdditionalMargin: 6.58, OpenOrders: 1
2025-07-22 22:39:47,783 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=BUY, Qty=0.01, Margin=6.572817245460726787378176232
2025-07-22 22:39:47,808 - INFO - orders - [CACHE_UPDATE] Updating balance/margin cache for user 1: balance=16447.54000000, margin=13.15000000 (was 6.57000000)
2025-07-22 22:39:47,808 - INFO - orders - [CACHE_UPDATE] Balance/margin cache updated for user 1
2025-07-22 22:39:47,808 - INFO - orders - [PERF] Order processing: 0.3533s
2025-07-22 22:39:47,830 - INFO - orders - [PERF] Order creation: 0.0220s
2025-07-22 22:39:47,831 - INFO - orders - is_barclays_live_user in place_order: False
2025-07-22 22:39:47,831 - INFO - orders - [PERF] TOTAL place_order: 0.3807s
2025-07-22 22:39:47,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDCHF
2025-07-22 22:39:47,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 22:39:47,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776'), Decimal('657.281725')], HighestMarginPerLot=657.372776
2025-07-22 22:39:47,849 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=13.15
2025-07-22 22:39:47,849 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 13.15
2025-07-22 22:39:47,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDCHF
2025-07-22 22:39:47,879 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 22:39:47,879 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776'), Decimal('657.281725')], HighestMarginPerLot=657.372776
2025-07-22 22:39:47,879 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=13.15
2025-07-22 22:39:47,879 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 13.15
2025-07-22 22:39:47,884 - INFO - orders - Background balance/margin cache updated for user 1: balance=16447.54000000, margin=13.15
2025-07-22 22:39:48,309 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:39:51,905 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:40:00,049 - INFO - orders - Order close request received - Order ID: 1208-001, User ID: 1, Close Price: 0.5215000000000001
2025-07-22 22:40:00,049 - INFO - orders - Request to close order 1208-001 for user 1 (user_type: demo) with price 0.5215000000000001. Frontend provided type: BUY, company: AUDCHF, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:40:00,065 - INFO - orders - Demo user 1 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-07-22 22:40:00,073 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 1, Symbol AUDCHF
2025-07-22 22:40:00,073 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-22 22:40:00,073 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776'), Decimal('657.281725')], HighestMarginPerLot=657.372776
2025-07-22 22:40:00,073 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=13.15
2025-07-22 22:40:00,073 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:40:00,073 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:40:00,073 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776')], HighestMarginPerLot=657.372776
2025-07-22 22:40:00,073 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:40:00,080 - INFO - orders - Existing entry commission for order 1208-001: 0.10000000
2025-07-22 22:40:00,080 - INFO - orders - Commission calculation for order 1208-001: entry=0.10000000, exit=0.100000000000, total=0.20
2025-07-22 22:40:00,080 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -0.4499999999999000000000000000 CHF to USD for PnL on Close (user_id: 1, position: 1208-001)
2025-07-22 22:40:00,080 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CHFUSD
2025-07-22 22:40:00,082 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:40:00,082 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CHFUSD, trying inverse
2025-07-22 22:40:00,082 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCHF
2025-07-22 22:40:00,083 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('0.7942100000'), 'o': Decimal('0.7941800000')}
2025-07-22 22:40:00,083 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 0.7942100000
2025-07-22 22:40:00,084 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -0.4499999999999000000000000000 CHF / 0.7942100000 = -0.5666007730951511564951335289 USD
2025-07-22 22:40:00,133 - INFO - orders - AFTER COMMIT: User 1 wallet_balance=16446.77000000, margin=6.57
2025-07-22 22:40:00,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:40:00,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:40:00,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776')], HighestMarginPerLot=657.372776
2025-07-22 22:40:00,153 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:40:00,153 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:40:00,182 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:40:00,182 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:40:00,182 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776')], HighestMarginPerLot=657.372776
2025-07-22 22:40:00,182 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:40:00,182 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:40:00,189 - INFO - orders - Background balance/margin cache updated for user 1: balance=16446.77000000, margin=6.57
2025-07-22 22:40:00,666 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:40:01,134 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:40:03,487 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:40:05,715 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:40:07,300 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:40:07,300 - INFO - orders - Using order model: UserOrder
2025-07-22 22:40:07,302 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:40:07,303 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:40:07,304 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:40:07,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:40:07,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:40:07,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:40:07,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:40:07,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:40:07,306 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:40:07,307 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:40:07,307 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:40:07,307 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:40:07,308 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:40:08,037 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:40:08,038 - INFO - orders - Using order model: UserOrder
2025-07-22 22:40:08,047 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:40:08,056 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:40:08,062 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:40:08,070 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:40:08,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:40:08,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:40:08,071 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:40:08,071 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:40:08,080 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:42:55,555 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:42:56,603 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:42:56,603 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:42:56,603 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:42:56,603 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:42:56,646 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:42:56,646 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:42:57,511 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 22:42:57,511 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 22:42:57,511 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 22:42:57,511 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 22:42:57,511 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 22:42:57,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-22 22:42:57,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:42:57,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-22 22:42:57,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-22 22:42:57,621 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-22 22:42:57,622 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-22 22:42:57,622 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-22 22:42:57,622 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-22 22:42:57,622 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-22 22:42:59,273 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:42:59,273 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:42:59,273 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776')], HighestMarginPerLot=657.372776
2025-07-22 22:42:59,273 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:42:59,273 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:43:00,027 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:43:00,027 - INFO - orders - Using order model: UserOrder
2025-07-22 22:43:00,031 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:43:00,035 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:43:00,037 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:43:00,047 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:43:00,048 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:43:00,048 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:43:00,048 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:43:00,048 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:43:00,048 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:43:00,048 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:43:00,048 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:43:00,049 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:43:00,058 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:43:01,873 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:43:02,563 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:43:02,563 - INFO - orders - Using order model: UserOrder
2025-07-22 22:43:02,571 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:43:02,574 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:43:02,578 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:43:02,584 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:43:02,584 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:43:02,584 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:43:02,584 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:43:02,584 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:43:02,589 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:43:06,602 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 22:43:06,772 - INFO - orders - Order close request received - Order ID: 1207-001, User ID: 1, Close Price: 0.52146
2025-07-22 22:43:06,773 - INFO - orders - Request to close order 1207-001 for user 1 (user_type: demo) with price 0.52146. Frontend provided type: BUY, company: AUDCHF, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:43:06,803 - INFO - orders - Demo user 1 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-07-22 22:43:06,829 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:43:06,830 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:43:06,830 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.372776')], HighestMarginPerLot=657.372776
2025-07-22 22:43:06,830 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:43:06,830 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 1, Symbol AUDCHF. Returning zero margin.
2025-07-22 22:43:06,857 - INFO - orders - Existing entry commission for order 1207-001: 0.10000000
2025-07-22 22:43:06,858 - INFO - orders - Commission calculation for order 1207-001: entry=0.10000000, exit=0.100000000000, total=0.20
2025-07-22 22:43:06,858 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -0.260000000000000000000000 CHF to USD for PnL on Close (user_id: 1, position: 1207-001)
2025-07-22 22:43:06,858 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CHFUSD
2025-07-22 22:43:06,862 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:43:06,862 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CHFUSD, trying inverse
2025-07-22 22:43:06,862 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCHF
2025-07-22 22:43:06,865 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('0.7941800000'), 'o': Decimal('0.7941500000')}
2025-07-22 22:43:06,865 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 0.7941800000
2025-07-22 22:43:06,865 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -0.260000000000000000000000 CHF / 0.7941800000 = -0.3273817018811856254249666322 USD
2025-07-22 22:43:06,941 - INFO - orders - AFTER COMMIT: User 1 wallet_balance=16446.24000000, margin=0
2025-07-22 22:43:06,986 - INFO - orders - Background balance/margin cache updated for user 1: balance=16446.24000000, margin=0.0
2025-07-22 22:43:07,003 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:43:09,108 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:43:11,796 - INFO - orders - Order placement request received - User: 1, Symbol: AUDCHF, Type: BUY
2025-07-22 22:43:12,163 - INFO - orders - [MARGIN_CALC] Market data for AUDCHF: {'b': '0.5217100000', 'o': '0.5216500000'}
2025-07-22 22:43:12,164 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDCHF, using bid price with spread: bid=0.5217100000, ask=0.52176217100000
2025-07-22 22:43:12,164 - INFO - orders - [MARGIN_CALC] Using prices for AUDCHF: bid=0.5217100000, ask=0.52176217100000
2025-07-22 22:43:12,165 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 5.22 CHF to USD for margin_calculation (user_id: 1, position: None)
2025-07-22 22:43:12,165 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CHFUSD
2025-07-22 22:43:12,166 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:43:12,167 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CHFUSD, trying inverse
2025-07-22 22:43:12,167 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCHF
2025-07-22 22:43:12,168 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('0.7941400000'), 'o': Decimal('0.7941100000')}
2025-07-22 22:43:12,168 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 0.7941400000
2025-07-22 22:43:12,168 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 5.22 CHF / 0.7941400000 = 6.573148311380864834915757927 USD
2025-07-22 22:43:12,168 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDCHF, Type: BUY, Qty: 0.01, Price: 0.52176217100000, Margin: 6.573148311380864834915757927, Commission: 0.10
2025-07-22 22:43:12,168 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 1, Symbol: AUDCHF, OrderType: BUY, Quantity: 0.01, FullMargin: 6.573148311380864834915757927
2025-07-22 22:43:12,168 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 0
2025-07-22 22:43:12,168 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=BUY, Qty=0.01, Margin=6.573148311380864834915757927
2025-07-22 22:43:12,168 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 0 existing orders + 1 new order
2025-07-22 22:43:12,168 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:43:12,168 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 1, Symbol AUDCHF. Returning zero margin.
2025-07-22 22:43:12,168 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:43:12,169 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01, TotalSellQty=0, NetQty=0.01, IsHedged=False
2025-07-22 22:43:12,169 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.3148311380864834915757927')], HighestMarginPerLot=657.3148311380864834915757927
2025-07-22 22:43:12,169 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:43:12,169 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:43:12,169 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 1, Symbol: AUDCHF, OrderType: BUY, MarginBefore: 0.0, MarginAfter: 6.57, AdditionalMargin: 6.57, OpenOrders: 0
2025-07-22 22:43:12,169 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=BUY, Qty=0.01, Margin=6.573148311380864834915757927
2025-07-22 22:43:12,189 - INFO - orders - [CACHE_UPDATE] Updating balance/margin cache for user 1: balance=16446.24000000, margin=6.57000000 (was 0E-8)
2025-07-22 22:43:12,190 - INFO - orders - [CACHE_UPDATE] Balance/margin cache updated for user 1
2025-07-22 22:43:12,190 - INFO - orders - [PERF] Order processing: 0.3863s
2025-07-22 22:43:12,206 - INFO - orders - [PERF] Order creation: 0.0165s
2025-07-22 22:43:12,207 - INFO - orders - is_barclays_live_user in place_order: False
2025-07-22 22:43:12,207 - INFO - orders - [PERF] TOTAL place_order: 0.4110s
2025-07-22 22:43:12,222 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:43:12,223 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:43:12,223 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.314831')], HighestMarginPerLot=657.314831
2025-07-22 22:43:12,223 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:43:12,223 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:43:12,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-22 22:43:12,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-22 22:43:12,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.314831')], HighestMarginPerLot=657.314831
2025-07-22 22:43:12,247 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-22 22:43:12,247 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-22 22:43:12,255 - INFO - orders - Background balance/margin cache updated for user 1: balance=16446.24000000, margin=6.57
2025-07-22 22:43:12,773 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 1
2025-07-22 22:43:13,675 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:43:19,912 - INFO - orders - Fetching rejected orders for user: 30
2025-07-22 22:43:19,922 - INFO - orders - Found 1 rejected orders for user 30
2025-07-22 22:43:25,317 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:43:26,065 - INFO - orders - Order placement request received - User: 30, Symbol: AUDCAD, Type: BUY
2025-07-22 22:43:26,390 - INFO - orders - [MARGIN_CALC] Market data for AUDCAD: {'b': '0.8937400000', 'o': '0.8936700000'}
2025-07-22 22:43:26,390 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDCAD, using bid price with spread: bid=0.8937400000, ask=0.89382937400000
2025-07-22 22:43:26,391 - INFO - orders - [MARGIN_CALC] Using prices for AUDCAD: bid=0.8937400000, ask=0.89382937400000
2025-07-22 22:43:26,392 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 8.94 CAD to USD for margin_calculation (user_id: 30, position: None)
2025-07-22 22:43:26,392 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CADUSD
2025-07-22 22:43:26,394 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-22 22:43:26,394 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CADUSD, trying inverse
2025-07-22 22:43:26,394 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCAD
2025-07-22 22:43:26,396 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('1.3604500000'), 'o': Decimal('1.3603900000')}
2025-07-22 22:43:26,396 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 1.3604500000
2025-07-22 22:43:26,396 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 8.94 CAD / 1.3604500000 = 6.571355066338343930317174464 USD
2025-07-22 22:43:26,396 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDCAD, Type: BUY, Qty: 0.01, Price: 0.89382937400000, Margin: 6.571355066338343930317174464, Commission: 0.00
2025-07-22 22:43:26,397 - INFO - orders - [HEDGING_MARGIN_DEBUG] Starting hedging calculation for User: 30, Symbol: AUDCAD, OrderType: BUY, Quantity: 0.01, FullMargin: 6.571355066338343930317174464
2025-07-22 22:43:26,397 - INFO - orders - [HEDGING_MARGIN_DEBUG] Existing open orders count: 0
2025-07-22 22:43:26,397 - INFO - orders - [HEDGING_MARGIN_DEBUG] Created simulated order: Type=BUY, Qty=0.01, Margin=6.571355066338343930317174464
2025-07-22 22:43:26,397 - INFO - orders - [HEDGING_MARGIN_DEBUG] About to calculate margin before and after for 0 existing orders + 1 new order
2025-07-22 22:43:26,397 - INFO - orders - [HEDGING_MARGIN_DEBUG] Executing margin calculation tasks...
2025-07-22 22:43:26,397 - INFO - orders - [MARGIN_TOTAL_CONTRIB] No open positions for User 30, Symbol AUDCAD. Returning zero margin.
2025-07-22 22:43:26,397 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 30, Symbol AUDCAD
2025-07-22 22:43:26,397 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 30, Symbol AUDCAD: TotalBuyQty=0.01, TotalSellQty=0, NetQty=0.01, IsHedged=False
2025-07-22 22:43:26,398 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 30, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.1355066338343930317174464')], HighestMarginPerLot=657.1355066338343930317174464
2025-07-22 22:43:26,398 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 30, Symbol AUDCAD: CalculatedTotalMargin=6.57
2025-07-22 22:43:26,398 - INFO - orders - [HEDGING_MARGIN_DEBUG] Margin calculation tasks completed
2025-07-22 22:43:26,398 - INFO - orders - [HEDGING_MARGIN_DEBUG] User: 30, Symbol: AUDCAD, OrderType: BUY, MarginBefore: 0.0, MarginAfter: 6.57, AdditionalMargin: 6.57, OpenOrders: 0
2025-07-22 22:43:26,398 - INFO - orders - [HEDGING_MARGIN_DEBUG] Simulated order: Type=BUY, Qty=0.01, Margin=6.571355066338343930317174464
2025-07-22 22:43:26,398 - INFO - orders - [PERF] Order processing: 0.3301s
2025-07-22 22:43:26,428 - INFO - orders - [PERF] Order creation: 0.0302s
2025-07-22 22:43:26,429 - INFO - orders - is_barclays_live_user in place_order: True
2025-07-22 22:43:26,429 - INFO - orders - [BARCLAYS] Scheduling barclays_push in place_order
2025-07-22 22:43:26,429 - INFO - orders - [PERF] TOTAL place_order: 0.3652s
2025-07-22 22:43:26,465 - INFO - orders - Background balance/margin cache updated for user 30: balance=10000.00000000, margin=0.0
2025-07-22 22:43:26,479 - INFO - orders - [BARCLAYS] barclays_push called in place_order
2025-07-22 22:43:26,784 - INFO - orders - [PUBLISH_ASYNC] Triggering websocket updates for user 30
2025-07-22 22:43:27,730 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:43:30,010 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:43:37,512 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:43:37,514 - INFO - orders - Using order model: UserOrder
2025-07-22 22:43:37,535 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:43:37,553 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:43:37,579 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:43:37,636 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:43:37,639 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:43:37,639 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:43:37,640 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:43:37,640 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:43:37,640 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:43:37,640 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:43:37,640 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:43:37,640 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:43:37,653 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:43:38,550 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:43:38,551 - INFO - orders - Using order model: UserOrder
2025-07-22 22:43:38,553 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:43:38,557 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:43:38,560 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:43:38,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:43:38,564 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:43:38,565 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:43:38,565 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:43:38,565 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:43:38,569 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:43:45,093 - INFO - orders - Fetching rejected orders for user: 14
2025-07-22 22:43:45,100 - INFO - orders - Found 0 rejected orders for user 14
2025-07-22 22:43:45,995 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:43:45,995 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:43:45,995 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:43:45,995 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:43:45,995 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:43:45,995 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:43:45,995 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:43:45,995 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:43:45,996 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:43:47,599 - INFO - orders - Order close request received - Order ID: 1000333-001, User ID: 14, Close Price: 96.624
2025-07-22 22:43:47,599 - INFO - orders - Request to close order 1000333-001 for user 14 (user_type: live) with price 96.624. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:43:47,615 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-22 22:43:47,615 - INFO - orders - Live user 14 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-22 22:43:47,620 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '1000333-001', 'close_price': '96.624', 'user_id': 14, 'order_type': 'BUY', 'order_company_name': 'AUDJPY', 'order_quantity': '0.01000000', 'contract_value': '1000.00000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '1223-003'}
2025-07-22 22:44:06,071 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:44:12,582 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:44:12,582 - INFO - orders - Using order model: UserOrder
2025-07-22 22:44:12,584 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:44:12,589 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:44:12,591 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:44:12,597 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:44:12,598 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:44:12,598 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:44:12,598 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:44:12,598 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:44:12,598 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:44:12,598 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:44:12,598 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:44:12,598 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:44:12,601 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:44:13,458 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:44:13,458 - INFO - orders - Using order model: UserOrder
2025-07-22 22:44:13,460 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:44:13,464 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:44:13,466 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:44:13,469 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:44:13,469 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:44:13,469 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:44:13,469 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:44:13,469 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:44:13,475 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:44:47,291 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:44:47,291 - INFO - orders - Using order model: UserOrder
2025-07-22 22:44:47,293 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:44:47,294 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:44:47,295 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:44:47,298 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:44:47,298 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:44:47,298 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:44:47,298 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:44:47,298 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:44:47,298 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:44:47,298 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:44:47,298 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:44:47,298 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:44:47,300 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:44:47,940 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:44:47,940 - INFO - orders - Using order model: UserOrder
2025-07-22 22:44:47,946 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:44:47,950 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:44:47,954 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:44:47,960 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:44:47,961 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:44:47,961 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:44:47,961 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:44:47,961 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:44:47,968 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:44:47,969 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:44:54,554 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:44:56,851 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:44:59,190 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:45:10,183 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:45:11,154 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:45:11,154 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:45:11,154 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:45:11,155 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:45:11,209 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:45:11,209 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:45:12,624 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:45:12,624 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:45:12,624 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:45:12,624 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:45:12,624 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:45:12,624 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:45:12,624 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:45:12,624 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:45:12,624 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:45:13,051 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:45:13,051 - INFO - orders - Using order model: UserOrder
2025-07-22 22:45:13,054 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:45:13,056 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:45:13,058 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:45:13,062 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:45:13,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:45:13,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:45:13,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:45:13,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:45:13,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:45:13,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:45:13,063 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:45:13,063 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:45:13,069 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:45:13,907 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:45:13,907 - INFO - orders - Using order model: UserOrder
2025-07-22 22:45:13,909 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:45:13,911 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:45:13,913 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:45:13,917 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:45:13,917 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:45:13,917 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:45:13,917 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:45:13,917 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:45:13,923 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:45:15,650 - INFO - orders - Order close request received - Order ID: 1000330-001, User ID: 14, Close Price: 118669.7
2025-07-22 22:45:15,650 - INFO - orders - Request to close order 1000330-001 for user 14 (user_type: live) with price 118669.7. Frontend provided type: BUY, company: BTCUSD, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:45:15,668 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-22 22:45:15,668 - INFO - orders - Live user 14 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-22 22:45:15,671 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '1000330-001', 'close_price': '118669.7', 'user_id': 14, 'order_type': 'BUY', 'order_company_name': 'BTCUSD', 'order_quantity': '0.40000000', 'contract_value': '0.40000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '1224-003'}
2025-07-22 22:45:16,153 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:45:17,685 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:45:21,153 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 22:45:22,523 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:45:23,381 - INFO - orders - Order close request received - Order ID: 1000330-001, User ID: 14, Close Price: 118669.7
2025-07-22 22:45:23,381 - INFO - orders - Request to close order 1000330-001 for user 14 (user_type: live) with price 118669.7. Frontend provided type: BUY, company: BTCUSD, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:45:23,394 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-22 22:45:23,394 - INFO - orders - Live user 14 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-22 22:45:23,397 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '1000330-001', 'close_price': '118669.7', 'user_id': 14, 'order_type': 'BUY', 'order_company_name': 'BTCUSD', 'order_quantity': '0.40000000', 'contract_value': '0.40000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '1225-003'}
2025-07-22 22:45:29,460 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:45:31,682 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:45:38,619 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:45:48,041 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:45:48,041 - INFO - orders - Using order model: UserOrder
2025-07-22 22:45:48,043 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:45:48,048 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:45:48,050 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:45:48,053 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:45:48,053 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:45:48,053 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:45:48,053 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:45:48,053 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:45:48,053 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:45:48,053 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:45:48,053 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:45:48,053 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:45:48,059 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:45:48,828 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:45:48,829 - INFO - orders - Using order model: UserOrder
2025-07-22 22:45:48,833 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:45:48,835 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:45:48,836 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:45:48,841 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:45:48,841 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:45:48,841 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:45:48,841 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:45:48,841 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:45:48,846 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:45:54,910 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:45:57,168 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:45:59,535 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:46:01,768 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:46:24,541 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:46:25,471 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:46:25,471 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:46:25,471 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:46:25,471 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:46:25,516 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:46:25,516 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:46:26,223 - INFO - orders - Starting update_user_static_orders for user 9, user_type live
2025-07-22 22:46:26,223 - INFO - orders - Using order model: UserOrder
2025-07-22 22:46:26,226 - INFO - orders - Fetched 1 open orders for user 9
2025-07-22 22:46:26,230 - INFO - orders - Fetched 0 pending orders for user 9
2025-07-22 22:46:26,231 - INFO - orders - Updated static orders cache for user 9 with 1 open orders and 0 pending orders
2025-07-22 22:46:26,236 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-22 22:46:26,236 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-22 22:46:26,236 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-22 22:46:26,236 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-22 22:46:26,236 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-22 22:46:26,242 - INFO - orders - User 9: Updated balance/margin cache after static orders update - balance=8436.59000000, margin=8271.68
2025-07-22 22:46:26,244 - INFO - orders - Starting update_user_static_orders for user 10, user_type live
2025-07-22 22:46:26,244 - INFO - orders - Using order model: UserOrder
2025-07-22 22:46:26,247 - INFO - orders - Fetched 0 open orders for user 10
2025-07-22 22:46:26,249 - INFO - orders - Fetched 0 pending orders for user 10
2025-07-22 22:46:26,251 - INFO - orders - Updated static orders cache for user 10 with 0 open orders and 0 pending orders
2025-07-22 22:46:26,258 - INFO - orders - User 10: Updated balance/margin cache after static orders update - balance=9707.74000000, margin=0.0
2025-07-22 22:46:26,260 - INFO - orders - Starting update_user_static_orders for user 11, user_type live
2025-07-22 22:46:26,260 - INFO - orders - Using order model: UserOrder
2025-07-22 22:46:26,262 - INFO - orders - Fetched 0 open orders for user 11
2025-07-22 22:46:26,264 - INFO - orders - Fetched 0 pending orders for user 11
2025-07-22 22:46:26,265 - INFO - orders - Updated static orders cache for user 11 with 0 open orders and 0 pending orders
2025-07-22 22:46:26,273 - INFO - orders - User 11: Updated balance/margin cache after static orders update - balance=14420.38000000, margin=0.0
2025-07-22 22:46:26,280 - INFO - orders - Starting update_user_static_orders for user 13, user_type live
2025-07-22 22:46:26,280 - INFO - orders - Using order model: UserOrder
2025-07-22 22:46:26,283 - INFO - orders - Fetched 0 open orders for user 13
2025-07-22 22:46:26,287 - INFO - orders - Fetched 0 pending orders for user 13
2025-07-22 22:46:26,293 - INFO - orders - Updated static orders cache for user 13 with 0 open orders and 0 pending orders
2025-07-22 22:46:26,325 - INFO - orders - User 13: Updated balance/margin cache after static orders update - balance=94.25000000, margin=0.0
2025-07-22 22:46:30,662 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:46:30,846 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:46:30,846 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:46:30,846 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:46:30,846 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:46:30,846 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:46:30,846 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:46:30,846 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:46:30,846 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:46:30,846 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:46:31,238 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:46:31,238 - INFO - orders - Using order model: UserOrder
2025-07-22 22:46:31,240 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:46:31,242 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:46:31,244 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:46:31,246 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:46:31,246 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:46:31,246 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:46:31,246 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:46:31,246 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:46:31,246 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:46:31,246 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:46:31,246 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:46:31,246 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:46:31,249 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:46:32,020 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:46:32,020 - INFO - orders - Using order model: UserOrder
2025-07-22 22:46:32,025 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:46:32,027 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:46:32,028 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:46:32,031 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:46:32,031 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:46:32,031 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:46:32,031 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:46:32,031 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:46:32,038 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:46:32,176 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:46:35,476 - INFO - orders - Starting the users with orders cache updater task.
2025-07-22 22:46:41,513 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:46:53,792 - INFO - orders - Order close request received - Order ID: 1000333-001, User ID: 14, Close Price: 96.617
2025-07-22 22:46:53,792 - INFO - orders - Request to close order 1000333-001 for user 14 (user_type: live) with price 96.617. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:46:53,802 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-22 22:46:53,802 - INFO - orders - Live user 14 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-22 22:46:53,805 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '1000333-001', 'close_price': '96.617', 'user_id': 14, 'order_type': 'BUY', 'order_company_name': 'AUDJPY', 'order_quantity': '0.01000000', 'contract_value': '1000.00000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '1226-003'}
2025-07-22 22:47:00,741 - INFO - orders - Order close request received - Order ID: 1000332-001, User ID: 14, Close Price: 96.616
2025-07-22 22:47:00,741 - INFO - orders - Request to close order 1000332-001 for user 14 (user_type: live) with price 96.616. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-07-22 22:47:00,756 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-22 22:47:00,756 - INFO - orders - Live user 14 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-22 22:47:00,760 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '1000332-001', 'close_price': '96.616', 'user_id': 14, 'order_type': 'BUY', 'order_company_name': 'AUDJPY', 'order_quantity': '0.10000000', 'contract_value': '10000.00000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '1227-003'}
2025-07-22 22:47:09,282 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-22 22:47:22,108 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-22 22:47:23,153 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-22 22:47:23,153 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-22 22:47:23,154 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-22 22:47:23,154 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-22 22:47:23,200 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-22 22:47:23,200 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-22 22:47:25,165 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-22 22:47:25,165 - INFO - orders - Using order model: UserOrder
2025-07-22 22:47:25,167 - INFO - orders - Fetched 3 open orders for user 14
2025-07-22 22:47:25,170 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-22 22:47:25,171 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-22 22:47:25,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:47:25,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:47:25,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:47:25,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:47:25,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:47:25,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:47:25,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:47:25,175 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:47:25,175 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:47:25,180 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-22 22:47:25,235 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-22 22:47:25,235 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-22 22:47:25,235 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-22 22:47:25,235 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-22 22:47:25,235 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-22 22:47:25,235 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-22 22:47:25,235 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-22 22:47:25,235 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-22 22:47:25,235 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-22 22:47:25,875 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-22 22:47:25,875 - INFO - orders - Using order model: UserOrder
2025-07-22 22:47:25,877 - INFO - orders - Fetched 1 open orders for user 25
2025-07-22 22:47:25,879 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-22 22:47:25,881 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-22 22:47:25,884 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-22 22:47:25,884 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-22 22:47:25,884 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-22 22:47:25,884 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-22 22:47:25,885 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-22 22:47:25,888 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-22 22:47:28,153 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-22 22:47:33,163 - INFO - orders - Starting the users with orders cache updater task.
2025-07-23 02:21:31,442 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-23 02:21:32,811 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-23 02:21:32,811 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-23 02:21:32,811 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-23 02:21:32,812 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-23 02:21:32,873 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-23 02:21:32,873 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-23 02:21:33,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-23 02:21:33,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-23 02:21:33,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-23 02:21:33,899 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-23 02:21:33,899 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-23 02:21:33,944 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:21:33,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:21:33,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:21:33,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:21:33,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:21:33,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:21:33,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:21:33,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:21:33,945 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:21:34,044 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:21:34,044 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:21:34,044 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:21:34,044 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:21:34,044 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:21:34,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-23 02:21:34,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:21:34,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-23 02:21:34,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-23 02:21:34,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-23 02:21:34,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-23 02:21:34,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-23 02:21:34,057 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-23 02:21:34,057 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-23 02:21:34,158 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-23 02:21:34,158 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:21:34,158 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.314831')], HighestMarginPerLot=657.314831
2025-07-23 02:21:34,158 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-23 02:21:34,158 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-23 02:21:35,296 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:21:35,296 - INFO - orders - Using order model: UserOrder
2025-07-23 02:21:35,298 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:21:35,300 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:21:35,301 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:21:35,304 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:21:35,304 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:21:35,304 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:21:35,304 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:21:35,304 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:21:35,304 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:21:35,304 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:21:35,304 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:21:35,304 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:21:35,307 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:21:36,197 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:21:36,197 - INFO - orders - Using order model: UserOrder
2025-07-23 02:21:36,202 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:21:36,205 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:21:36,208 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:21:36,213 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:21:36,213 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:21:36,213 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:21:36,214 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:21:36,214 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:21:36,220 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:21:37,827 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-23 02:21:42,822 - INFO - orders - Starting the users with orders cache updater task.
2025-07-23 02:21:43,447 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:01,983 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:14,403 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:22:14,404 - INFO - orders - Using order model: UserOrder
2025-07-23 02:22:14,408 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:22:14,413 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:22:14,415 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:22:14,421 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:22:14,421 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:22:14,421 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:22:14,421 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:22:14,421 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:22:14,422 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:22:14,422 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:22:14,422 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:22:14,422 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:22:14,429 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:22:15,309 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:22:15,309 - INFO - orders - Using order model: UserOrder
2025-07-23 02:22:15,322 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:22:15,336 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:22:15,340 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:22:15,347 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:22:15,347 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:22:15,347 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:22:15,348 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:22:15,348 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:22:15,355 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:22:30,053 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:32,261 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:43,859 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:46,103 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:48,470 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:53,409 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:53,460 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:54,022 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:22:54,023 - INFO - orders - Using order model: UserOrder
2025-07-23 02:22:54,026 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:22:54,031 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:22:54,034 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:22:54,042 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:22:54,042 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:22:54,042 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:22:54,042 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:22:54,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:22:54,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:22:54,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:22:54,043 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:22:54,043 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:22:54,052 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:22:55,143 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:22:55,143 - INFO - orders - Using order model: UserOrder
2025-07-23 02:22:55,145 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:22:55,150 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:22:55,152 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:22:55,158 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:22:55,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:22:55,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:22:55,159 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:22:55,159 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:22:55,165 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:22:57,801 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:22:59,942 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:23:13,801 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:23:25,315 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:23:33,747 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:23:33,747 - INFO - orders - Using order model: UserOrder
2025-07-23 02:23:33,751 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:23:33,754 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:23:33,756 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:23:33,762 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:23:33,762 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:23:33,762 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:23:33,762 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:23:33,762 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:23:33,763 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:23:33,763 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:23:33,763 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:23:33,763 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:23:33,776 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:23:34,783 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:23:34,783 - INFO - orders - Using order model: UserOrder
2025-07-23 02:23:34,787 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:23:34,796 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:23:34,801 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:23:34,810 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:23:34,811 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:23:34,811 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:23:34,811 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:23:34,811 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:23:34,817 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:23:55,841 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:24:09,388 - INFO - orders - Starting update_user_static_orders for user 9, user_type live
2025-07-23 02:24:09,389 - INFO - orders - Using order model: UserOrder
2025-07-23 02:24:09,432 - INFO - orders - Fetched 1 open orders for user 9
2025-07-23 02:24:09,441 - INFO - orders - Fetched 0 pending orders for user 9
2025-07-23 02:24:09,460 - INFO - orders - Updated static orders cache for user 9 with 1 open orders and 0 pending orders
2025-07-23 02:24:09,472 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-23 02:24:09,472 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-23 02:24:09,472 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-23 02:24:09,472 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-23 02:24:09,472 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-23 02:24:09,483 - INFO - orders - User 9: Updated balance/margin cache after static orders update - balance=8436.59000000, margin=8271.68
2025-07-23 02:24:09,505 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:24:10,103 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:24:10,103 - INFO - orders - Using order model: UserOrder
2025-07-23 02:24:10,106 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:24:10,110 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:24:10,113 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:24:10,119 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:24:10,119 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:24:10,119 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:24:10,119 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:24:10,119 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:24:10,120 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:24:10,120 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:24:10,120 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:24:10,120 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:24:10,126 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:24:11,859 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:24:11,860 - INFO - orders - Using order model: UserOrder
2025-07-23 02:24:11,869 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:24:11,887 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:24:11,904 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:24:11,928 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:24:11,929 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:24:11,929 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:24:11,929 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:24:11,929 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:24:11,939 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:24:29,593 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-23 02:24:30,576 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-23 02:24:30,576 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-23 02:24:30,576 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-23 02:24:30,576 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-23 02:24:30,631 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-23 02:24:30,631 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-23 02:24:35,893 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-23 02:24:36,730 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:24:36,730 - INFO - orders - Using order model: UserOrder
2025-07-23 02:24:36,734 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:24:36,737 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:24:36,739 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:24:36,744 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:24:36,745 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:24:36,745 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:24:36,745 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:24:36,745 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:24:36,745 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:24:36,746 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:24:36,746 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:24:36,746 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:24:36,752 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:24:37,711 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:24:37,712 - INFO - orders - Using order model: UserOrder
2025-07-23 02:24:37,727 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:24:37,748 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:24:37,911 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:24:37,919 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:24:37,919 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:24:37,919 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:24:37,919 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:24:37,919 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:24:37,928 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:24:40,796 - INFO - orders - Starting the users with orders cache updater task.
2025-07-23 02:24:44,477 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:25:16,672 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:25:16,672 - INFO - orders - Using order model: UserOrder
2025-07-23 02:25:16,676 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:25:16,682 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:25:16,684 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:25:16,691 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:25:16,691 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:25:16,691 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:25:16,691 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:25:16,691 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:25:16,691 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:25:16,692 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:25:16,692 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:25:16,692 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:25:16,701 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:25:17,575 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:25:17,575 - INFO - orders - Using order model: UserOrder
2025-07-23 02:25:17,579 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:25:17,582 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:25:17,584 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:25:17,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:25:17,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:25:17,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:25:17,588 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:25:17,588 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:25:17,592 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:25:40,182 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:25:55,988 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:25:55,988 - INFO - orders - Using order model: UserOrder
2025-07-23 02:25:55,992 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:25:55,995 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:25:55,997 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:25:56,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:25:56,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:25:56,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:25:56,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:25:56,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:25:56,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:25:56,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:25:56,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:25:56,004 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:25:56,010 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:25:57,133 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:25:57,133 - INFO - orders - Using order model: UserOrder
2025-07-23 02:25:57,136 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:25:57,140 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:25:57,142 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:25:57,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:25:57,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:25:57,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:25:57,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:25:57,148 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:25:57,155 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:26:00,995 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:03,337 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:14,799 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:17,149 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:19,412 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:23,988 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:26,365 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:28,607 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:35,588 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:26:35,589 - INFO - orders - Using order model: UserOrder
2025-07-23 02:26:35,592 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:26:35,597 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:26:35,600 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:26:35,606 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:26:35,607 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:26:35,607 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:26:35,607 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:26:35,607 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:26:35,607 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:26:35,607 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:26:35,607 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:26:35,607 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:26:35,611 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:35,614 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:26:36,530 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:26:36,530 - INFO - orders - Using order model: UserOrder
2025-07-23 02:26:36,534 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:26:36,539 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:26:36,542 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:26:36,548 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:26:36,549 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:26:36,549 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:26:36,549 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:26:36,549 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:26:36,557 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:26:42,550 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:44,856 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:26:58,721 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:27:01,080 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:27:14,879 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:27:14,931 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:27:15,527 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:27:15,527 - INFO - orders - Using order model: UserOrder
2025-07-23 02:27:15,530 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:27:15,534 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:27:15,536 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:27:15,540 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:27:15,540 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:27:15,540 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:27:15,540 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:27:15,540 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:27:15,541 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:27:15,541 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:27:15,541 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:27:15,541 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:27:15,547 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:27:16,358 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:27:16,358 - INFO - orders - Using order model: UserOrder
2025-07-23 02:27:16,361 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:27:16,363 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:27:16,365 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:27:16,370 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:27:16,370 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:27:16,370 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:27:16,370 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:27:16,371 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:27:16,375 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:27:21,751 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:27:40,304 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:35:41,521 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-23 02:35:42,821 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-23 02:35:42,821 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-23 02:35:42,821 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-23 02:35:42,821 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-23 02:35:42,863 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-23 02:35:42,863 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-23 02:35:43,878 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-23 02:35:43,879 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-23 02:35:43,879 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-23 02:35:43,879 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-23 02:35:43,879 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-23 02:35:43,944 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:35:43,944 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:35:43,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:35:43,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:35:43,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:35:43,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:35:43,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:35:43,945 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:35:43,945 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:35:44,082 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:35:44,082 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:35:44,082 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:35:44,082 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:35:44,082 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:35:44,090 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol XAGUSD
2025-07-23 02:35:44,090 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:35:44,090 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-23 02:35:44,090 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-23 02:35:44,090 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 26, Symbol BTCUSD
2025-07-23 02:35:44,090 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: TotalBuyQty=6.00000000, TotalSellQty=0, NetQty=6.00000000, IsHedged=False
2025-07-23 02:35:44,090 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 26, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24410.82166666666666666666667')], HighestMarginPerLot=24410.82166666666666666666667
2025-07-23 02:35:44,090 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 26, Symbol BTCUSD: CalculatedTotalMargin=146464.93
2025-07-23 02:35:44,090 - INFO - orders - [TOTAL_USER_MARGIN] User 26 total margin across all symbols: 146484.47
2025-07-23 02:35:44,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 1, Symbol AUDCHF
2025-07-23 02:35:44,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:35:44,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 1, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.314831')], HighestMarginPerLot=657.314831
2025-07-23 02:35:44,160 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 1, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-23 02:35:44,160 - INFO - orders - [TOTAL_USER_MARGIN] User 1 total margin across all symbols: 6.57
2025-07-23 02:35:48,966 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-23 02:35:49,591 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:35:49,591 - INFO - orders - Using order model: UserOrder
2025-07-23 02:35:49,595 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:35:49,600 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:35:49,603 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:35:49,608 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:35:49,608 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:35:49,608 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:35:49,608 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:35:49,608 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:35:49,608 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:35:49,609 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:35:49,609 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:35:49,609 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:35:49,613 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:35:50,159 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:35:50,159 - INFO - orders - Using order model: UserOrder
2025-07-23 02:35:50,161 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:35:50,162 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:35:50,163 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:35:50,166 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:35:50,167 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:35:50,167 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:35:50,167 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:35:50,167 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:35:50,170 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:35:52,879 - INFO - orders - Starting the users with orders cache updater task.
2025-07-23 02:35:53,593 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:35:58,401 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:36:05,759 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:36:23,517 - INFO - orders - Starting update_user_static_orders for user 9, user_type live
2025-07-23 02:36:23,518 - INFO - orders - Using order model: UserOrder
2025-07-23 02:36:23,521 - INFO - orders - Fetched 1 open orders for user 9
2025-07-23 02:36:23,524 - INFO - orders - Fetched 0 pending orders for user 9
2025-07-23 02:36:23,525 - INFO - orders - Updated static orders cache for user 9 with 1 open orders and 0 pending orders
2025-07-23 02:36:23,533 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 9, Symbol BTCUSD
2025-07-23 02:36:23,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: TotalBuyQty=0.35000000, TotalSellQty=0, NetQty=0.35000000, IsHedged=False
2025-07-23 02:36:23,534 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 9, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23633.37142857142857142857143')], HighestMarginPerLot=23633.37142857142857142857143
2025-07-23 02:36:23,535 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 9, Symbol BTCUSD: CalculatedTotalMargin=8271.68
2025-07-23 02:36:23,535 - INFO - orders - [TOTAL_USER_MARGIN] User 9 total margin across all symbols: 8271.68
2025-07-23 02:36:23,546 - INFO - orders - User 9: Updated balance/margin cache after static orders update - balance=8436.59000000, margin=8271.68
2025-07-23 02:36:24,316 - INFO - orders - Starting update_user_static_orders for user 14, user_type live
2025-07-23 02:36:24,316 - INFO - orders - Using order model: UserOrder
2025-07-23 02:36:24,319 - INFO - orders - Fetched 3 open orders for user 14
2025-07-23 02:36:24,322 - INFO - orders - Fetched 0 pending orders for user 14
2025-07-23 02:36:24,325 - INFO - orders - Updated static orders cache for user 14 with 3 open orders and 0 pending orders
2025-07-23 02:36:24,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 14, Symbol BTCUSD
2025-07-23 02:36:24,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:36:24,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol BTCUSD: AllMarginsPerLot=[Decimal('23556.825')], HighestMarginPerLot=23556.825
2025-07-23 02:36:24,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol BTCUSD: CalculatedTotalMargin=9422.73
2025-07-23 02:36:24,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 14, Symbol AUDJPY
2025-07-23 02:36:24,329 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: TotalBuyQty=0.11000000, TotalSellQty=0, NetQty=0.11000000, IsHedged=False
2025-07-23 02:36:24,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 14, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.1517371'), Decimal('652.134765')], HighestMarginPerLot=652.1517371
2025-07-23 02:36:24,330 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 14, Symbol AUDJPY: CalculatedTotalMargin=71.74
2025-07-23 02:36:24,330 - INFO - orders - [TOTAL_USER_MARGIN] User 14 total margin across all symbols: 9494.47
2025-07-23 02:36:24,334 - INFO - orders - User 14: Updated balance/margin cache after static orders update - balance=9902.02000000, margin=9494.47
2025-07-23 02:36:25,214 - INFO - orders - Starting update_user_static_orders for user 25, user_type live
2025-07-23 02:36:25,214 - INFO - orders - Using order model: UserOrder
2025-07-23 02:36:25,218 - INFO - orders - Fetched 1 open orders for user 25
2025-07-23 02:36:25,224 - INFO - orders - Fetched 0 pending orders for user 25
2025-07-23 02:36:25,227 - INFO - orders - Updated static orders cache for user 25 with 1 open orders and 0 pending orders
2025-07-23 02:36:25,232 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 25, Symbol BTCUSD
2025-07-23 02:36:25,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: TotalBuyQty=0.10000000, TotalSellQty=0, NetQty=0.10000000, IsHedged=False
2025-07-23 02:36:25,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 25, Symbol BTCUSD: AllMarginsPerLot=[Decimal('59366.2')], HighestMarginPerLot=59366.2
2025-07-23 02:36:25,233 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 25, Symbol BTCUSD: CalculatedTotalMargin=5936.62
2025-07-23 02:36:25,234 - INFO - orders - [TOTAL_USER_MARGIN] User 25 total margin across all symbols: 5936.62
2025-07-23 02:36:25,240 - INFO - orders - User 25: Updated balance/margin cache after static orders update - balance=6389.62000000, margin=5936.62
2025-07-23 02:36:26,481 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 25 order 1031-001 (handled by service provider)
2025-07-23 02:36:59,406 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-23 02:37:00,442 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-23 02:37:00,442 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-23 02:37:00,443 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-23 02:37:00,443 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-23 02:37:00,503 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-23 02:37:00,503 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-23 02:37:02,414 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 27, Symbol AUDJPY
2025-07-23 02:37:02,414 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 02:37:02,414 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: AllMarginsPerLot=[Decimal('648.460213'), Decimal('651.498922')], HighestMarginPerLot=651.498922
2025-07-23 02:37:02,415 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDJPY: CalculatedTotalMargin=13.03
2025-07-23 02:37:02,415 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 27, Symbol AUDUSD
2025-07-23 02:37:02,415 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:37:02,415 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: AllMarginsPerLot=[Decimal('652')], HighestMarginPerLot=652
2025-07-23 02:37:02,415 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDUSD: CalculatedTotalMargin=6.52
2025-07-23 02:37:02,415 - INFO - orders - [TOTAL_USER_MARGIN] User 27 total margin across all symbols: 19.55
2025-07-23 02:37:02,976 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 28, Symbol EURPLN
2025-07-23 02:37:02,977 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 02:37:02,977 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: AllMarginsPerLot=[Decimal('4257'), Decimal('4257')], HighestMarginPerLot=4257
2025-07-23 02:37:02,977 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol EURPLN: CalculatedTotalMargin=85.14
2025-07-23 02:37:02,977 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 28, Symbol BTCUSD
2025-07-23 02:37:02,978 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:37:02,978 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24050.95')], HighestMarginPerLot=24050.95
2025-07-23 02:37:02,978 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol BTCUSD: CalculatedTotalMargin=9620.38
2025-07-23 02:37:02,978 - INFO - orders - [TOTAL_USER_MARGIN] User 28 total margin across all symbols: 9705.52
2025-07-23 02:37:05,797 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-23 02:37:10,556 - INFO - orders - Starting the users with orders cache updater task.
2025-07-23 02:37:11,125 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:15,652 - ERROR - orders - Error getting group settings for group Classic: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 844, in _request_authentication
    auth_packet = await self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\pending_orders.py", line 1084, in get_group_settings_cache
    group = await get_group_by_name(db, group_name)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\crud\group.py", line 27, in get_group_by_name
    result = await db.execute(select(Group).filter(Group.name == group_name))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3273, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 844, in _request_authentication
    auth_packet = await self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-23 02:37:15,800 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:18,163 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:20,665 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:37:20,746 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:22,580 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:24,881 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:27,110 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:37:27,371 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:29,358 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:37:31,759 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:37:32,023 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:34,159 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:37:34,540 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:36,433 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:37:37,032 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:38,900 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:41,482 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:43,814 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:45,856 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:37:46,152 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:48,859 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:50,669 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:52,715 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:37:53,323 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:55,186 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:37:57,813 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:00,358 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:02,241 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:04,420 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:06,991 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:09,078 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:13,799 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:16,038 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:18,265 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:38:18,591 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:20,666 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:22,802 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:38:22,932 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:25,376 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:29,821 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:32,854 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:34,287 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:38:36,800 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:38:37,606 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:39,060 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:38:39,211 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:38:41,806 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:40:48,160 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-23 02:40:49,421 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-23 02:40:49,421 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-23 02:40:49,422 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-23 02:40:49,422 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-23 02:40:49,453 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-23 02:40:49,454 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-23 02:40:50,652 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 4, Symbol CADCHF
2025-07-23 02:40:50,652 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:40:50,653 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: AllMarginsPerLot=[Decimal('736.585427')], HighestMarginPerLot=736.585427
2025-07-23 02:40:50,653 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 4, Symbol CADCHF: CalculatedTotalMargin=7.37
2025-07-23 02:40:50,653 - INFO - orders - [TOTAL_USER_MARGIN] User 4 total margin across all symbols: 7.37
2025-07-23 02:40:51,019 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 10, Symbol AUDCAD
2025-07-23 02:40:51,019 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:40:51,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: AllMarginsPerLot=[Decimal('658.916726')], HighestMarginPerLot=658.916726
2025-07-23 02:40:51,020 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 10, Symbol AUDCAD: CalculatedTotalMargin=6.59
2025-07-23 02:40:51,020 - INFO - orders - [TOTAL_USER_MARGIN] User 10 total margin across all symbols: 6.59
2025-07-23 02:40:51,119 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 11, Symbol AUDJPY
2025-07-23 02:40:51,119 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:40:51,119 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: AllMarginsPerLot=[Decimal('96717')], HighestMarginPerLot=96717
2025-07-23 02:40:51,119 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 11, Symbol AUDJPY: CalculatedTotalMargin=967.17
2025-07-23 02:40:51,119 - INFO - orders - [TOTAL_USER_MARGIN] User 11 total margin across all symbols: 967.17
2025-07-23 02:40:51,749 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 13, Symbol XAGUSD
2025-07-23 02:40:51,749 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=False
2025-07-23 02:40:51,749 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-23 02:40:51,749 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 13, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-23 02:40:51,749 - INFO - orders - [TOTAL_USER_MARGIN] User 13 total margin across all symbols: 19.54
2025-07-23 02:40:52,764 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol AUDCAD
2025-07-23 02:40:52,764 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:40:52,764 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.55194')], HighestMarginPerLot=657.55194
2025-07-23 02:40:52,764 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol AUDCAD: CalculatedTotalMargin=6.58
2025-07-23 02:40:52,764 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol EURUSD
2025-07-23 02:40:52,765 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:40:52,765 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: AllMarginsPerLot=[Decimal('1180')], HighestMarginPerLot=1180
2025-07-23 02:40:52,766 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol EURUSD: CalculatedTotalMargin=11.80
2025-07-23 02:40:52,766 - INFO - orders - [TOTAL_USER_MARGIN] User 20 total margin across all symbols: 18.38
2025-07-23 02:40:53,147 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 22, Symbol AUDCHF
2025-07-23 02:40:53,147 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:40:53,147 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.101216')], HighestMarginPerLot=657.101216
2025-07-23 02:40:53,147 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-23 02:40:53,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 4 positions for User 22, Symbol AUDJPY
2025-07-23 02:40:53,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000, IsHedged=True
2025-07-23 02:40:53,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: AllMarginsPerLot=[Decimal('657.431957'), Decimal('652.816419'), Decimal('652.829301'), Decimal('652.889785')], HighestMarginPerLot=657.431957
2025-07-23 02:40:53,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDJPY: CalculatedTotalMargin=13.15
2025-07-23 02:40:53,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 22, Symbol AUDCAD
2025-07-23 02:40:53,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-23 02:40:53,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.598728'), Decimal('652.660595')], HighestMarginPerLot=652.660595
2025-07-23 02:40:53,148 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCAD: CalculatedTotalMargin=6.53
2025-07-23 02:40:53,150 - INFO - orders - [TOTAL_USER_MARGIN] User 22 total margin across all symbols: 26.25
2025-07-23 02:40:53,338 - INFO - orders - Starting update_user_static_orders for user 24, user_type live
2025-07-23 02:40:53,339 - INFO - orders - Using order model: UserOrder
2025-07-23 02:40:53,767 - INFO - orders - Fetched 0 open orders for user 24
2025-07-23 02:40:53,836 - INFO - orders - Fetched 0 pending orders for user 24
2025-07-23 02:40:53,838 - INFO - orders - Updated static orders cache for user 24 with 0 open orders and 0 pending orders
2025-07-23 02:40:53,991 - INFO - orders - User 24: Updated balance/margin cache after static orders update - balance=500000.00000000, margin=0.0
2025-07-23 02:40:54,124 - INFO - orders - Starting update_user_static_orders for user 27, user_type live
2025-07-23 02:40:54,124 - INFO - orders - Using order model: UserOrder
2025-07-23 02:40:54,165 - INFO - orders - Fetched 3 open orders for user 27
2025-07-23 02:40:54,208 - INFO - orders - Fetched 0 pending orders for user 27
2025-07-23 02:40:54,210 - INFO - orders - Updated static orders cache for user 27 with 3 open orders and 0 pending orders
2025-07-23 02:40:54,248 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 27, Symbol AUDJPY
2025-07-23 02:40:54,248 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 02:40:54,248 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: AllMarginsPerLot=[Decimal('648.460213'), Decimal('651.498922')], HighestMarginPerLot=651.498922
2025-07-23 02:40:54,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDJPY: CalculatedTotalMargin=13.03
2025-07-23 02:40:54,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 27, Symbol AUDUSD
2025-07-23 02:40:54,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:40:54,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: AllMarginsPerLot=[Decimal('652')], HighestMarginPerLot=652
2025-07-23 02:40:54,249 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDUSD: CalculatedTotalMargin=6.52
2025-07-23 02:40:54,249 - INFO - orders - [TOTAL_USER_MARGIN] User 27 total margin across all symbols: 19.55
2025-07-23 02:40:54,254 - INFO - orders - User 27: Updated balance/margin cache after static orders update - balance=0E-8, margin=19.55
2025-07-23 02:40:54,258 - INFO - orders - Starting update_user_static_orders for user 28, user_type live
2025-07-23 02:40:54,258 - INFO - orders - Using order model: UserOrder
2025-07-23 02:40:54,317 - INFO - orders - Fetched 3 open orders for user 28
2025-07-23 02:40:54,356 - INFO - orders - Fetched 0 pending orders for user 28
2025-07-23 02:40:54,358 - INFO - orders - Updated static orders cache for user 28 with 3 open orders and 0 pending orders
2025-07-23 02:40:54,706 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 28, Symbol EURPLN
2025-07-23 02:40:54,706 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 02:40:54,706 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: AllMarginsPerLot=[Decimal('4257'), Decimal('4257')], HighestMarginPerLot=4257
2025-07-23 02:40:54,707 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol EURPLN: CalculatedTotalMargin=85.14
2025-07-23 02:40:54,707 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 28, Symbol BTCUSD
2025-07-23 02:40:54,707 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:40:54,707 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24050.95')], HighestMarginPerLot=24050.95
2025-07-23 02:40:54,707 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol BTCUSD: CalculatedTotalMargin=9620.38
2025-07-23 02:40:54,707 - INFO - orders - [TOTAL_USER_MARGIN] User 28 total margin across all symbols: 9705.52
2025-07-23 02:40:54,708 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-23 02:40:54,723 - INFO - orders - User 28: Updated balance/margin cache after static orders update - balance=0E-8, margin=9705.52
2025-07-23 02:40:55,013 - INFO - orders - Starting update_user_static_orders for user 31, user_type live
2025-07-23 02:40:55,013 - INFO - orders - Using order model: UserOrder
2025-07-23 02:40:55,054 - INFO - orders - Fetched 0 open orders for user 31
2025-07-23 02:40:55,113 - INFO - orders - Fetched 0 pending orders for user 31
2025-07-23 02:40:55,116 - INFO - orders - Updated static orders cache for user 31 with 0 open orders and 0 pending orders
2025-07-23 02:40:55,186 - INFO - orders - User 31: Updated balance/margin cache after static orders update - balance=0E-8, margin=0.0
2025-07-23 02:40:57,200 - ERROR - orders - Error getting group settings for group Group B: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 844, in _request_authentication
    auth_packet = await self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\pending_orders.py", line 1084, in get_group_settings_cache
    group = await get_group_by_name(db, group_name)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\crud\group.py", line 27, in get_group_by_name
    result = await db.execute(select(Group).filter(Group.name == group_name))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3273, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 147, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2436, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3297, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 713, in checkout
    rec = pool._do_get()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 675, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 901, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\pool\base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\dialects\mysql\aiomysql.py", line 270, in connect
    await_only(creator_fn(*arg, **kw)),
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 75, in _connect
    await conn._connect()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 540, in _connect
    await self._request_authentication()
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 844, in _request_authentication
    auth_packet = await self._read_packet()
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\aiomysql\connection.py", line 652, in _read_packet
    packet.raise_for_error()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-23 02:41:02,908 - INFO - orders - Starting the users with orders cache updater task.
2025-07-23 02:41:03,047 - ERROR - orders - Error getting symbols with open orders: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-23 02:41:04,455 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:05,978 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:41:06,474 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:07,172 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:24,201 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:26,787 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:28,783 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:31,263 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:33,855 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:38,618 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:41,236 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:43,136 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:45,300 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:41:45,949 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:50,569 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:52,617 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:41:54,960 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:00,081 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:01,794 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:04,221 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:06,617 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:08,768 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:11,164 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:13,223 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:42:13,552 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:15,845 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:18,092 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:20,158 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:42:20,319 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:22,981 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:23,008 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:42:25,165 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:30,748 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:33,362 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:37,393 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:42:37,903 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:42,120 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:42:42,381 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:46,985 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:49,406 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:56,873 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:42:58,936 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:01,095 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:03,657 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:10,105 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:43:10,920 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:12,746 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:43:17,387 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:43:19,678 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:43:24,220 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:43:24,434 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:26,676 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:43:26,911 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:29,154 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:31,681 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:33,976 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:38,343 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:40,612 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:43,010 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:45,509 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:47,790 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:50,637 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:52,721 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:54,516 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:43:55,091 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:56,791 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:43:57,395 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:43:59,469 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:43:59,643 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:01,587 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:44:02,081 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:03,888 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:44:04,156 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:08,526 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:15,550 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:17,989 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:24,923 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:29,751 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:32,049 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:44:32,328 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:34,237 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:36,457 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:38,669 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:41,140 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:43,415 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:45,803 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:44:50,203 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:53:29,449 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-23 02:53:30,632 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-23 02:53:30,632 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-23 02:53:30,632 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-23 02:53:30,632 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-23 02:53:30,660 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-23 02:53:30,661 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-23 02:53:31,914 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 4, Symbol CADCHF
2025-07-23 02:53:31,915 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:53:31,915 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: AllMarginsPerLot=[Decimal('736.585427')], HighestMarginPerLot=736.585427
2025-07-23 02:53:31,915 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 4, Symbol CADCHF: CalculatedTotalMargin=7.37
2025-07-23 02:53:31,915 - INFO - orders - [TOTAL_USER_MARGIN] User 4 total margin across all symbols: 7.37
2025-07-23 02:53:32,463 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 10, Symbol AUDCAD
2025-07-23 02:53:32,464 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:53:32,464 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: AllMarginsPerLot=[Decimal('658.916726')], HighestMarginPerLot=658.916726
2025-07-23 02:53:32,464 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 10, Symbol AUDCAD: CalculatedTotalMargin=6.59
2025-07-23 02:53:32,464 - INFO - orders - [TOTAL_USER_MARGIN] User 10 total margin across all symbols: 6.59
2025-07-23 02:53:32,917 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 11, Symbol AUDJPY
2025-07-23 02:53:32,918 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:53:32,918 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: AllMarginsPerLot=[Decimal('96717')], HighestMarginPerLot=96717
2025-07-23 02:53:32,918 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 11, Symbol AUDJPY: CalculatedTotalMargin=967.17
2025-07-23 02:53:32,918 - INFO - orders - [TOTAL_USER_MARGIN] User 11 total margin across all symbols: 967.17
2025-07-23 02:53:33,176 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 13, Symbol XAGUSD
2025-07-23 02:53:33,177 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=False
2025-07-23 02:53:33,177 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-23 02:53:33,177 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 13, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-23 02:53:33,177 - INFO - orders - [TOTAL_USER_MARGIN] User 13 total margin across all symbols: 19.54
2025-07-23 02:53:34,396 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol AUDCAD
2025-07-23 02:53:34,396 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:53:34,396 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.55194')], HighestMarginPerLot=657.55194
2025-07-23 02:53:34,396 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol AUDCAD: CalculatedTotalMargin=6.58
2025-07-23 02:53:34,396 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol EURUSD
2025-07-23 02:53:34,396 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:53:34,396 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: AllMarginsPerLot=[Decimal('1180')], HighestMarginPerLot=1180
2025-07-23 02:53:34,397 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol EURUSD: CalculatedTotalMargin=11.80
2025-07-23 02:53:34,397 - INFO - orders - [TOTAL_USER_MARGIN] User 20 total margin across all symbols: 18.38
2025-07-23 02:53:35,139 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 22, Symbol AUDCHF
2025-07-23 02:53:35,139 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:53:35,139 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.101216')], HighestMarginPerLot=657.101216
2025-07-23 02:53:35,139 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-23 02:53:35,139 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 4 positions for User 22, Symbol AUDJPY
2025-07-23 02:53:35,139 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000, IsHedged=True
2025-07-23 02:53:35,139 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: AllMarginsPerLot=[Decimal('657.431957'), Decimal('652.816419'), Decimal('652.829301'), Decimal('652.889785')], HighestMarginPerLot=657.431957
2025-07-23 02:53:35,139 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDJPY: CalculatedTotalMargin=13.15
2025-07-23 02:53:35,140 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 22, Symbol AUDCAD
2025-07-23 02:53:35,140 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-23 02:53:35,140 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.598728'), Decimal('652.660595')], HighestMarginPerLot=652.660595
2025-07-23 02:53:35,140 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCAD: CalculatedTotalMargin=6.53
2025-07-23 02:53:35,140 - INFO - orders - [TOTAL_USER_MARGIN] User 22 total margin across all symbols: 26.25
2025-07-23 02:53:35,631 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-23 02:53:36,301 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 27, Symbol AUDJPY
2025-07-23 02:53:36,301 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 02:53:36,301 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: AllMarginsPerLot=[Decimal('648.460213'), Decimal('651.498922')], HighestMarginPerLot=651.498922
2025-07-23 02:53:36,302 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDJPY: CalculatedTotalMargin=13.03
2025-07-23 02:53:36,302 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 27, Symbol AUDUSD
2025-07-23 02:53:36,302 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 02:53:36,302 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: AllMarginsPerLot=[Decimal('652')], HighestMarginPerLot=652
2025-07-23 02:53:36,302 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDUSD: CalculatedTotalMargin=6.52
2025-07-23 02:53:36,302 - INFO - orders - [TOTAL_USER_MARGIN] User 27 total margin across all symbols: 19.55
2025-07-23 02:53:36,391 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 28, Symbol EURPLN
2025-07-23 02:53:36,391 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 02:53:36,392 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: AllMarginsPerLot=[Decimal('4257'), Decimal('4257')], HighestMarginPerLot=4257
2025-07-23 02:53:36,392 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol EURPLN: CalculatedTotalMargin=85.14
2025-07-23 02:53:36,392 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 28, Symbol BTCUSD
2025-07-23 02:53:36,392 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 02:53:36,392 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24050.95')], HighestMarginPerLot=24050.95
2025-07-23 02:53:36,392 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol BTCUSD: CalculatedTotalMargin=9620.38
2025-07-23 02:53:36,392 - INFO - orders - [TOTAL_USER_MARGIN] User 28 total margin across all symbols: 9705.52
2025-07-23 02:53:37,789 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:53:44,128 - INFO - orders - Starting the users with orders cache updater task.
2025-07-23 02:53:44,229 - ERROR - orders - Error getting symbols with open orders: (pymysql.err.OperationalError) (1226, "User 'u436589492_testingserver' has exceeded the 'max_user_connections' resource (current value: 50)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-07-23 02:53:44,527 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:53:45,201 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:53:46,066 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:53:47,199 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:53:48,599 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:53:49,041 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:53:51,631 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:53:53,986 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:53:56,212 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:53:58,670 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:53:58,985 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:01,096 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:03,377 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:05,572 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:54:05,855 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:07,847 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:54:08,133 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:15,291 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:19,579 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:54:24,129 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:54:26,767 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:28,865 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:54:31,403 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:33,996 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:36,175 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:38,558 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:40,547 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:47,614 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:49,771 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:52,203 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:54:54,729 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:01,168 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:55:02,256 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:03,471 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:55:05,752 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:55:06,056 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:08,276 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:11,074 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:15,211 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:17,671 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:19,977 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:22,389 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:26,860 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:29,242 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:31,435 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:38,589 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:40,862 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 02:55:43,225 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 02:55:43,348 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:02,008 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-23 03:41:03,484 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-23 03:41:03,484 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-23 03:41:03,485 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-23 03:41:03,485 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-23 03:41:03,548 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-23 03:41:03,548 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-23 03:41:04,531 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 4, Symbol CADCHF
2025-07-23 03:41:04,531 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:41:04,531 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: AllMarginsPerLot=[Decimal('736.585427')], HighestMarginPerLot=736.585427
2025-07-23 03:41:04,531 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 4, Symbol CADCHF: CalculatedTotalMargin=7.37
2025-07-23 03:41:04,531 - INFO - orders - [TOTAL_USER_MARGIN] User 4 total margin across all symbols: 7.37
2025-07-23 03:41:05,064 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 10, Symbol AUDCAD
2025-07-23 03:41:05,065 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:41:05,065 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: AllMarginsPerLot=[Decimal('658.916726')], HighestMarginPerLot=658.916726
2025-07-23 03:41:05,065 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 10, Symbol AUDCAD: CalculatedTotalMargin=6.59
2025-07-23 03:41:05,065 - INFO - orders - [TOTAL_USER_MARGIN] User 10 total margin across all symbols: 6.59
2025-07-23 03:41:05,547 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 11, Symbol AUDJPY
2025-07-23 03:41:05,547 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:41:05,548 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: AllMarginsPerLot=[Decimal('96717')], HighestMarginPerLot=96717
2025-07-23 03:41:05,548 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 11, Symbol AUDJPY: CalculatedTotalMargin=967.17
2025-07-23 03:41:05,548 - INFO - orders - [TOTAL_USER_MARGIN] User 11 total margin across all symbols: 967.17
2025-07-23 03:41:05,744 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 13, Symbol XAGUSD
2025-07-23 03:41:05,745 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=False
2025-07-23 03:41:05,745 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-23 03:41:05,745 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 13, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-23 03:41:05,745 - INFO - orders - [TOTAL_USER_MARGIN] User 13 total margin across all symbols: 19.54
2025-07-23 03:41:06,676 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol AUDCAD
2025-07-23 03:41:06,676 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:41:06,676 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.55194')], HighestMarginPerLot=657.55194
2025-07-23 03:41:06,676 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol AUDCAD: CalculatedTotalMargin=6.58
2025-07-23 03:41:06,676 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol EURUSD
2025-07-23 03:41:06,676 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:41:06,677 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: AllMarginsPerLot=[Decimal('1180')], HighestMarginPerLot=1180
2025-07-23 03:41:06,677 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol EURUSD: CalculatedTotalMargin=11.80
2025-07-23 03:41:06,677 - INFO - orders - [TOTAL_USER_MARGIN] User 20 total margin across all symbols: 18.38
2025-07-23 03:41:06,847 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 22, Symbol AUDCHF
2025-07-23 03:41:06,847 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.101216')], HighestMarginPerLot=657.101216
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 4 positions for User 22, Symbol AUDJPY
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000, IsHedged=True
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: AllMarginsPerLot=[Decimal('657.431957'), Decimal('652.816419'), Decimal('652.829301'), Decimal('652.889785')], HighestMarginPerLot=657.431957
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDJPY: CalculatedTotalMargin=13.15
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 22, Symbol AUDCAD
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.598728'), Decimal('652.660595')], HighestMarginPerLot=652.660595
2025-07-23 03:41:06,848 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCAD: CalculatedTotalMargin=6.53
2025-07-23 03:41:06,848 - INFO - orders - [TOTAL_USER_MARGIN] User 22 total margin across all symbols: 26.25
2025-07-23 03:41:07,648 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 27, Symbol AUDJPY
2025-07-23 03:41:07,648 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 03:41:07,648 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: AllMarginsPerLot=[Decimal('648.460213'), Decimal('651.498922')], HighestMarginPerLot=651.498922
2025-07-23 03:41:07,648 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDJPY: CalculatedTotalMargin=13.03
2025-07-23 03:41:07,648 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 27, Symbol AUDUSD
2025-07-23 03:41:07,648 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:41:07,648 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: AllMarginsPerLot=[Decimal('652')], HighestMarginPerLot=652
2025-07-23 03:41:07,648 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDUSD: CalculatedTotalMargin=6.52
2025-07-23 03:41:07,648 - INFO - orders - [TOTAL_USER_MARGIN] User 27 total margin across all symbols: 19.55
2025-07-23 03:41:07,990 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 28, Symbol EURPLN
2025-07-23 03:41:07,990 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 03:41:07,990 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: AllMarginsPerLot=[Decimal('4257'), Decimal('4257')], HighestMarginPerLot=4257
2025-07-23 03:41:07,990 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol EURPLN: CalculatedTotalMargin=85.14
2025-07-23 03:41:07,990 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 28, Symbol BTCUSD
2025-07-23 03:41:07,990 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 03:41:07,990 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24050.95')], HighestMarginPerLot=24050.95
2025-07-23 03:41:07,990 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol BTCUSD: CalculatedTotalMargin=9620.38
2025-07-23 03:41:07,990 - INFO - orders - [TOTAL_USER_MARGIN] User 28 total margin across all symbols: 9705.52
2025-07-23 03:41:08,473 - INFO - orders - Starting update_user_static_orders for user 4, user_type demo
2025-07-23 03:41:08,473 - INFO - orders - Using order model: DemoUserOrder
2025-07-23 03:41:08,483 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-23 03:41:08,507 - INFO - orders - Fetched 0 open orders for user 4
2025-07-23 03:41:08,542 - INFO - orders - Fetched 0 pending orders for user 4
2025-07-23 03:41:08,544 - INFO - orders - Updated static orders cache for user 4 with 0 open orders and 0 pending orders
2025-07-23 03:41:08,582 - INFO - orders - User 4: Updated balance/margin cache after static orders update - balance=100000.00000000, margin=0.0
2025-07-23 03:41:13,552 - INFO - orders - Starting the users with orders cache updater task.
2025-07-23 03:41:13,587 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:15,545 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:17,915 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:22,707 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:41:22,835 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:24,752 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:41:24,894 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:25,325 - INFO - orders - Fetching rejected orders for user: 4
2025-07-23 03:41:25,366 - INFO - orders - Found 2 rejected orders for user 4
2025-07-23 03:41:27,226 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:28,002 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 4, Symbol CADCHF
2025-07-23 03:41:28,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:41:28,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: AllMarginsPerLot=[Decimal('736.585427')], HighestMarginPerLot=736.585427
2025-07-23 03:41:28,003 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 4, Symbol CADCHF: CalculatedTotalMargin=7.37
2025-07-23 03:41:28,004 - INFO - orders - [TOTAL_USER_MARGIN] User 4 total margin across all symbols: 7.37
2025-07-23 03:41:29,638 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:32,182 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:33,996 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:41:36,297 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:41:36,557 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:39,197 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:41,763 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:44,002 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:46,344 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:41:46,595 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:51,216 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:41:55,188 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:41:55,421 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:02,512 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:04,539 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:06,687 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:42:06,913 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:20,522 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:42:25,546 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:27,794 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:42:29,942 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:32,493 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:34,792 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:36,881 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:42:39,193 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:42:41,540 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:42:41,934 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:44,382 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:48,613 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:42:48,899 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:42:51,091 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:00,255 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:03,139 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:05,093 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:43:07,679 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:09,698 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:12,290 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:14,289 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:23,563 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:25,902 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:28,082 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:30,757 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:35,378 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:37,514 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:49,547 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:51,754 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:43:56,314 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:00,783 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:07,637 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:12,363 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:19,380 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:21,574 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:24,180 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:26,106 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:28,579 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:29,480 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:30,734 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:30,877 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:33,104 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:35,264 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:37,545 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:37,881 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:39,765 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:39,948 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:42,497 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:44,390 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:44,680 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:46,689 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:46,949 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:51,409 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:44:56,302 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:44:58,584 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:00,927 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:02,940 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:05,264 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:05,368 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:10,094 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:12,441 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:14,716 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:16,766 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:19,060 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:19,274 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:21,397 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:21,505 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:23,677 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:25,962 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:28,427 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:30,824 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:32,999 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:33,099 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:35,269 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:35,416 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:37,721 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:39,870 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:39,968 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:42,164 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:45:42,353 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:44,968 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:51,529 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:53,849 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:56,143 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:45:58,436 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:00,843 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:03,062 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:07,635 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:09,584 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 10, Symbol AUDCAD
2025-07-23 03:46:09,585 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:46:09,585 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: AllMarginsPerLot=[Decimal('658.916726')], HighestMarginPerLot=658.916726
2025-07-23 03:46:09,585 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 10, Symbol AUDCAD: CalculatedTotalMargin=6.59
2025-07-23 03:46:09,585 - INFO - orders - [TOTAL_USER_MARGIN] User 10 total margin across all symbols: 6.59
2025-07-23 03:46:09,663 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 11, Symbol AUDJPY
2025-07-23 03:46:09,663 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:46:09,664 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: AllMarginsPerLot=[Decimal('96717')], HighestMarginPerLot=96717
2025-07-23 03:46:09,664 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 11, Symbol AUDJPY: CalculatedTotalMargin=967.17
2025-07-23 03:46:09,664 - INFO - orders - [TOTAL_USER_MARGIN] User 11 total margin across all symbols: 967.17
2025-07-23 03:46:09,823 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 13, Symbol XAGUSD
2025-07-23 03:46:09,823 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=False
2025-07-23 03:46:09,823 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-23 03:46:09,823 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 13, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-23 03:46:09,823 - INFO - orders - [TOTAL_USER_MARGIN] User 13 total margin across all symbols: 19.54
2025-07-23 03:46:09,936 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:10,265 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol AUDCAD
2025-07-23 03:46:10,265 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:46:10,265 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.55194')], HighestMarginPerLot=657.55194
2025-07-23 03:46:10,265 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol AUDCAD: CalculatedTotalMargin=6.58
2025-07-23 03:46:10,265 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol EURUSD
2025-07-23 03:46:10,266 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:46:10,266 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: AllMarginsPerLot=[Decimal('1180')], HighestMarginPerLot=1180
2025-07-23 03:46:10,266 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol EURUSD: CalculatedTotalMargin=11.80
2025-07-23 03:46:10,266 - INFO - orders - [TOTAL_USER_MARGIN] User 20 total margin across all symbols: 18.38
2025-07-23 03:46:10,441 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 22, Symbol AUDCHF
2025-07-23 03:46:10,441 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:46:10,441 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.101216')], HighestMarginPerLot=657.101216
2025-07-23 03:46:10,441 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-23 03:46:10,441 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 4 positions for User 22, Symbol AUDJPY
2025-07-23 03:46:10,441 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000, IsHedged=True
2025-07-23 03:46:10,441 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: AllMarginsPerLot=[Decimal('657.431957'), Decimal('652.816419'), Decimal('652.829301'), Decimal('652.889785')], HighestMarginPerLot=657.431957
2025-07-23 03:46:10,441 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDJPY: CalculatedTotalMargin=13.15
2025-07-23 03:46:10,441 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 22, Symbol AUDCAD
2025-07-23 03:46:10,442 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-23 03:46:10,442 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.598728'), Decimal('652.660595')], HighestMarginPerLot=652.660595
2025-07-23 03:46:10,442 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCAD: CalculatedTotalMargin=6.53
2025-07-23 03:46:10,442 - INFO - orders - [TOTAL_USER_MARGIN] User 22 total margin across all symbols: 26.25
2025-07-23 03:46:10,842 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 27, Symbol AUDJPY
2025-07-23 03:46:10,842 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 03:46:10,842 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDJPY: AllMarginsPerLot=[Decimal('648.460213'), Decimal('651.498922')], HighestMarginPerLot=651.498922
2025-07-23 03:46:10,842 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDJPY: CalculatedTotalMargin=13.03
2025-07-23 03:46:10,843 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 27, Symbol AUDUSD
2025-07-23 03:46:10,843 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:46:10,843 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 27, Symbol AUDUSD: AllMarginsPerLot=[Decimal('652')], HighestMarginPerLot=652
2025-07-23 03:46:10,843 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 27, Symbol AUDUSD: CalculatedTotalMargin=6.52
2025-07-23 03:46:10,843 - INFO - orders - [TOTAL_USER_MARGIN] User 27 total margin across all symbols: 19.55
2025-07-23 03:46:10,915 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 28, Symbol EURPLN
2025-07-23 03:46:10,916 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000, IsHedged=False
2025-07-23 03:46:10,916 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol EURPLN: AllMarginsPerLot=[Decimal('4257'), Decimal('4257')], HighestMarginPerLot=4257
2025-07-23 03:46:10,916 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol EURPLN: CalculatedTotalMargin=85.14
2025-07-23 03:46:10,916 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 28, Symbol BTCUSD
2025-07-23 03:46:10,916 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: TotalBuyQty=0.40000000, TotalSellQty=0, NetQty=0.40000000, IsHedged=False
2025-07-23 03:46:10,916 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 28, Symbol BTCUSD: AllMarginsPerLot=[Decimal('24050.95')], HighestMarginPerLot=24050.95
2025-07-23 03:46:10,916 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 28, Symbol BTCUSD: CalculatedTotalMargin=9620.38
2025-07-23 03:46:10,916 - INFO - orders - [TOTAL_USER_MARGIN] User 28 total margin across all symbols: 9705.52
2025-07-23 03:46:12,336 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:14,905 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:19,304 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:21,925 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:24,475 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:26,224 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:28,410 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 4, Symbol CADCHF
2025-07-23 03:46:28,410 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:46:28,411 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: AllMarginsPerLot=[Decimal('736.843433')], HighestMarginPerLot=736.843433
2025-07-23 03:46:28,411 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 4, Symbol CADCHF: CalculatedTotalMargin=7.37
2025-07-23 03:46:28,411 - INFO - orders - [TOTAL_USER_MARGIN] User 4 total margin across all symbols: 7.37
2025-07-23 03:46:28,512 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:30,825 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:33,181 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:35,508 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:37,805 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:40,058 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:44,779 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:47,050 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:46:47,089 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:49,277 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:51,592 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:46:53,878 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:47:03,118 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:47:16,820 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:47:26,213 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:47:46,886 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:47:51,567 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:47:53,796 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:47:53,938 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:47:56,017 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:47:56,162 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:47:57,630 - INFO - orders - Order close request received - Order ID: 1001790-001, User ID: 4, Close Price: 0.583445
2025-07-23 03:47:57,630 - INFO - orders - Request to close order 1001790-001 for user 4 (user_type: live) with price 0.583445. Frontend provided type: BUY, company: CADCHF, status: CLOSED, frontend_status: CLOSED.
2025-07-23 03:47:57,933 - INFO - orders - User group: Group B, sending_orders setting: barclays
2025-07-23 03:47:57,934 - INFO - orders - Live user 4 from group 'Group B' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-23 03:47:58,031 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '1001790-001', 'close_price': '0.583445', 'user_id': 4, 'order_type': 'BUY', 'order_company_name': 'CADCHF', 'order_quantity': '0.01000000', 'contract_value': '1000.00000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '1001859-003'}
2025-07-23 03:47:58,499 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:48:02,918 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:05,217 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:07,611 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:48:10,194 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:48:12,217 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:14,627 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:14,750 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:48:21,411 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:23,911 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:48:26,064 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:30,629 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:32,919 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:35,220 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:37,542 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:37,774 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:48:39,864 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:48:40,119 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:48:42,438 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:48:53,543 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-23 03:48:54,741 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-23 03:48:54,741 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-23 03:48:54,741 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-23 03:48:54,742 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-23 03:48:54,777 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-23 03:48:54,777 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-23 03:48:59,804 - INFO - orders - Starting the simplified pending order checker background task.
2025-07-23 03:49:01,201 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:49:02,904 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 28 order 1000812-006 (handled by service provider)
2025-07-23 03:49:03,361 - INFO - orders - [SLTP_CHECK] Skipping SL/TP execution for Barclays live user 11 order 1000566-008 (handled by service provider)
2025-07-23 03:49:04,252 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 4, Symbol CADCHF
2025-07-23 03:49:04,252 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 03:49:04,252 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol CADCHF: AllMarginsPerLot=[Decimal('736.843433')], HighestMarginPerLot=736.843433
2025-07-23 03:49:04,253 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 4, Symbol CADCHF: CalculatedTotalMargin=7.37
2025-07-23 03:49:04,253 - INFO - orders - [TOTAL_USER_MARGIN] User 4 total margin across all symbols: 7.37
2025-07-23 04:53:32,026 - INFO - orders - [CLEANUP] Starting pending order stream cleanup
2025-07-23 04:53:32,955 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream
2025-07-23 04:53:32,955 - INFO - orders - [CLEANUP] Pending order stream cleanup completed
2025-07-23 04:53:32,956 - INFO - orders - [CLEANUP] Starting pending order stream cleanup with trigger price validation
2025-07-23 04:53:32,956 - INFO - orders - [PENDING_TRIGGER_WORKER] Starting pending order trigger worker
2025-07-23 04:53:32,991 - INFO - orders - [CLEANUP] Cleared pending_trigger_queue stream to remove old format entries
2025-07-23 04:53:32,991 - INFO - orders - [CLEANUP] Pending order stream cleanup with trigger price validation completed
2025-07-23 04:53:33,938 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 4, Symbol AUDJPY
2025-07-23 04:53:33,940 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 04:53:33,940 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol AUDJPY: AllMarginsPerLot=[Decimal('659.297807')], HighestMarginPerLot=659.297807
2025-07-23 04:53:33,940 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 4, Symbol AUDJPY: CalculatedTotalMargin=6.59
2025-07-23 04:53:33,940 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 4, Symbol AUDCAD
2025-07-23 04:53:33,940 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 04:53:33,940 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 4, Symbol AUDCAD: AllMarginsPerLot=[Decimal('659.531556')], HighestMarginPerLot=659.531556
2025-07-23 04:53:33,940 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 4, Symbol AUDCAD: CalculatedTotalMargin=6.60
2025-07-23 04:53:33,940 - INFO - orders - [TOTAL_USER_MARGIN] User 4 total margin across all symbols: 13.19
2025-07-23 04:53:34,254 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 10, Symbol AUDCAD
2025-07-23 04:53:34,254 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 04:53:34,254 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 10, Symbol AUDCAD: AllMarginsPerLot=[Decimal('658.916726')], HighestMarginPerLot=658.916726
2025-07-23 04:53:34,254 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 10, Symbol AUDCAD: CalculatedTotalMargin=6.59
2025-07-23 04:53:34,254 - INFO - orders - [TOTAL_USER_MARGIN] User 10 total margin across all symbols: 6.59
2025-07-23 04:53:34,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 11, Symbol AUDJPY
2025-07-23 04:53:34,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 04:53:34,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 11, Symbol AUDJPY: AllMarginsPerLot=[Decimal('96717')], HighestMarginPerLot=96717
2025-07-23 04:53:34,615 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 11, Symbol AUDJPY: CalculatedTotalMargin=967.17
2025-07-23 04:53:34,615 - INFO - orders - [TOTAL_USER_MARGIN] User 11 total margin across all symbols: 967.17
2025-07-23 04:53:34,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 13, Symbol XAGUSD
2025-07-23 04:53:34,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=False
2025-07-23 04:53:34,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 13, Symbol XAGUSD: AllMarginsPerLot=[Decimal('1954')], HighestMarginPerLot=1954
2025-07-23 04:53:34,767 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 13, Symbol XAGUSD: CalculatedTotalMargin=19.54
2025-07-23 04:53:34,767 - INFO - orders - [TOTAL_USER_MARGIN] User 13 total margin across all symbols: 19.54
2025-07-23 04:53:35,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol AUDCAD
2025-07-23 04:53:35,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 04:53:35,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol AUDCAD: AllMarginsPerLot=[Decimal('657.55194')], HighestMarginPerLot=657.55194
2025-07-23 04:53:35,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol AUDCAD: CalculatedTotalMargin=6.58
2025-07-23 04:53:35,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 20, Symbol EURUSD
2025-07-23 04:53:35,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 04:53:35,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 20, Symbol EURUSD: AllMarginsPerLot=[Decimal('1180')], HighestMarginPerLot=1180
2025-07-23 04:53:35,481 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 20, Symbol EURUSD: CalculatedTotalMargin=11.80
2025-07-23 04:53:35,481 - INFO - orders - [TOTAL_USER_MARGIN] User 20 total margin across all symbols: 18.38
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 1 positions for User 22, Symbol AUDCHF
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000, IsHedged=False
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCHF: AllMarginsPerLot=[Decimal('657.101216')], HighestMarginPerLot=657.101216
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCHF: CalculatedTotalMargin=6.57
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 4 positions for User 22, Symbol AUDJPY
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000, IsHedged=True
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDJPY: AllMarginsPerLot=[Decimal('657.431957'), Decimal('652.816419'), Decimal('652.829301'), Decimal('652.889785')], HighestMarginPerLot=657.431957
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDJPY: CalculatedTotalMargin=13.15
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB] Calculating margin for 2 positions for User 22, Symbol AUDCAD
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0.01000000, NetQty=0.01000000, IsHedged=True
2025-07-23 04:53:35,612 - INFO - orders - [MARGIN_TOTAL_CONTRIB_CALC] User 22, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.598728'), Decimal('652.660595')], HighestMarginPerLot=652.660595
2025-07-23 04:53:35,613 - INFO - orders - [MARGIN_TOTAL_CONTRIB_EXIT] User 22, Symbol AUDCAD: CalculatedTotalMargin=6.53
2025-07-23 04:53:35,613 - INFO - orders - [TOTAL_USER_MARGIN] User 22 total margin across all symbols: 26.25
